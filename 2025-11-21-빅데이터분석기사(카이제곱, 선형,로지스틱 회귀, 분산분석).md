# ğŸ“Œ 1. ì¹´ì´ì œê³± ê²€ì •
## 1-1. ì í•©ë„ ê²€ì •
- ì´ëŠ” ì‹¤ì œ ë‚˜íƒ€ë‚œ ê´€ì°°ëœ ë¹ˆë„ì˜ ë¶„í¬ì™€ í™•ë¥ ë¡œì„œ ê¸°ëŒ€ë˜ê³  ìˆëŠ” ë¹ˆë„ì˜ ë¶„í¬ê°€ ê°™ì€ì§€ ì¦‰ ì í•©í•œì§€ ë³´ëŠ” ê²€ì •ì´ë‹¤. 
- ì¤‘ìš”í•œê±´ ê¸°ëŒ€ë„ìˆ˜ëŠ” í™•ë¥ ì—ë‹¤ê°€ ì „ì²´ ìˆ˜ë¥¼ ê³±í•´ì„œ ì‹¤ì œ ê°’ìœ¼ë¡œ ë§Œë“¤ì–´ì£¼ì–´ì•¼í•œë‹¤.
- stats.chisquareì˜ ìŠ¤í ë§ì„ ìœ ì˜í•´ì•¼í•œë‹¤.
- ì´ë•Œ ê·€ë¬´ê°€ì„¤(H0)ì´ ë™ì¼í•¨ì´ë‹¤.
```py
#ê´€ì°°
ob = [150, 120, 30]
#ê¸°ëŒ€
ex = [0.5*300, 0.35*300, 0.15*300]

from scipy import stats 
print(stats.chisquare(ob, ex))
```

## 1-2. ë…ë¦½ì„± ê²€ì •
- pythonê³¼ rì´ ë¹…ë°ì´í„° ë¶„ì„ê¸°ì‚¬ í•©ê²©ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ì´ ì„œë¡œ ë…ë¦½ì ì¸ê°€?
- êµì°¨í‘œë¥¼ chi2_contingency ë‚´ë¶€ì— ë„£ì–´ì„œ íŒë‹¨í•  ìˆ˜ ìˆë‹¤.
- con-: í•¨ê»˜(together) tingere(ë¼í‹´ì–´ ì–´ì›): ë‹¿ë‹¤, ì ‘ì´‰í•˜ë‹¤
- contingency table(êµì°¨í‘œ)ì€ â€œë‘ ë³€ìˆ˜ê°€ ìƒí™©ì— ë”°ë¼ ì–´ë–»ê²Œ í•¨ê»˜ ë‚˜íƒ€ë‚˜ëŠ”ì§€ ë³´ì—¬ì£¼ëŠ” í‘œâ€ì´ë‹¤.
- êµì°¨í‘œë¥¼ chi2_contingencyì— ë„£ì–´ì„œ ë…ë¦½ì„±ì„ íŒë‹¨í•œë‹¤.
- ì´ë•Œ ê·€ë¬´ê°€ì„¤ì´ ë…ë¦½ì´ë‹¤.
```py
import pandas as pd
df = pd.DataFrame({
    'í•©ê²©':[80, 90],
    'ë¶ˆí•©ê²©':[20, 10]
    },index=['R', 'P']
)
df

from scipy import stats
stats.chi2_contingency(df)
```
- ë§Œì•½ ë¡œìš°ë°ì´í„°ë¡œ ì£¼ì–´ì§„ë‹¤ë©´ ê°ê° í–‰ë²¡í„°ë¥¼ ë¶„ë¦¬í•˜ì—¬ êµì°¨í‘œì¸ cross table ì¦‰ cross tabìœ¼ë¡œ ë§Œë“¤ ê²ƒì„ ì—¼ë‘í•´ë‘ì–´ì•¼í•œë‹¤.
- ì´í›„ stats.chi2_contingency(df)ë¥¼ ì ìš©í•œë‹¤.
```py
df=pd.crosstab(df['ì–¸ì–´'], df['í•©ê²©ì—¬ë¶€'])
```

# ğŸ“Œ 2. ë¡œì§€ìŠ¤í‹± íšŒê·€ë¶„ì„ í™œìš© íƒ€ì´íƒ€ë‹‰ ë¬¸ì œ
## 2-1. genderì™€ survivedê°€ ë…ë¦½ì¸ì§€ ì¢…ì†ì¸ì§€ êµ¬í•˜ê¸° 
- Genderì™€ Survived ì—´ë²¡í„°ë¥¼ êµì°¨í‘œë¡œ ë§Œë“¤ê³  ì´ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì¹´ì´ì œê³± ë…ë¦½ì„± ê²€ì‚¬ë¥¼ í•œë‹¤.
- ì´ë•Œ ê²€ì •í†µê³„ëŸ‰ì€ 260.717ì´ê³  pê°’ì´ 1.1973570627755645e-58ë¡œ ë§¤ìš° ì‘ìœ¼ë¯€ë¡œ ì´ê±´ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê° ì¦‰ ë…ë¦½ì´ ì•„ë‹ˆë‹¤. 
- ë‹¹ì—°íˆ ì„±ë³„ì€ ìƒì¡´ì—¬ë¶€ì— ì˜í–¥ì„ ì¤€ë‹¤.
```py
crosstab = pd.crosstab(df['Gender'], df['Survived'])
print(crosstab)

from scipy.stats import chi2_contingency
print(chi2_contingency(crosstab))
# 260.717
```

## 2-2. ë¡œì§€ìŠ¤í‹± íšŒê·€ë¶„ì„ ì‹œí–‰
- Gender, SibSp, Parch, Fare ë³€ìˆ˜ê°€ ê°ê° survivedì— ì–´ë–¤ ì˜í–¥ì„ ì£¼ëŠ”ì§€ ë¡œì§€ìŠ¤í‹± íšŒê·€ ë¶„ì„ì„ ì‹œí–‰í•˜ê¸°
- from statsmodels.formula.apiì˜ import logitì„ í™œìš©í•œë‹¤.
- rì—ì„œ ë´¤ë˜ í˜•íƒœì™€ ê±°ì˜ ì‹ì´ ë¹„ìŠ·í•˜ë‹¤.
- C()ëŠ” categoricalì˜ Cë¡œ í•´ë‹¹ ë³€ìˆ˜ê°€ ë²”ì£¼í˜• ë³€ìˆ˜ì„ì„ ì•Œë ¤ì£¼ê³  ëª¨ë¸ì´ ì´ë¥¼ ë°˜ì˜í•´ì„œ ê³„ì‚°ì„ í•´ì¤€ë‹¤.
- fit í•œ í›„ modelì˜ summaryí•¨ìˆ˜ë¥¼ í†µí•´ ì „ì²´ ê²°ê³¼ë¥¼ í•œë²ˆì— í™•ì¸í•  ìˆ˜ ìˆë‹¤.

```py
#2.
print(df[['Gender', 'SibSp', 'Parch', 'Fare']].head(3))

from statsmodels.formula.api import logit

model = logit("Survived ~ C(Gender) + SibSp + Parch + Fare", data=df).fit()
print(model.summary())
print(round(-0.2007,3))
# -0.201
```

## 2-3. í•œ ë³€ìˆ˜ê°€ í•œë‹¨ìœ„ ì¦ê°€í• ë•Œ ì˜¤ì¦ˆë¹„
- ë¡œê·¸ì˜¤ì¦ˆì™€ ì„ í˜•ê²°í•©ì‹ì´ ë¹„ë¡€í•˜ëŠ” ê´€ê³„ê°€ ìˆì–´ ì´ë¥¼ í† ëŒ€ë¡œ ë¡œì§€ìŠ¤í‹±íšŒê·€ë¥¼ ë¶„ì„í•œë‹¤.

$$
\log\frac{p}{1-p} = \beta_0 + \beta_1x_1 + \beta_2x_2 + \cdots + \beta_kx_k
$$

- ì¦‰ í•œ ë³€ìˆ˜ê°€ 1 ì¦ê°€í•˜ë©´ ê·¸ ê³„ìˆ˜ë§Œí¼ ë¡œê·¸ ì˜¤ì¦ˆê°€ ì¦ê°€í•˜ê³  ì˜¤ì¦ˆëŠ” eì˜ í•´ë‹¹ ê³„ìˆ˜ìŠ¹ìœ¼ë¡œ ì¦ê°€í•œë‹¤.
- ì´ëŠ” ë„˜íŒŒì´ë¥¼ í™œìš©í•´ eì˜ ì§€ìˆ˜ìŠ¹ì„ ê³„ì‚°í•  ìˆ˜ ìˆë‹¤.
- ë˜í•œ modelì—ì„œ paramsë¥¼ í™œìš©í•´ì—¬ íŠ¹ì • ë…ë¦½ë³€ìˆ˜ì˜ ê³„ìˆ˜ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤.
```py
import numpy as np
print(model.params['SibSp'])
print(np.exp(model.params['SibSp']))

print(np.exp(-0.3539))
```

# ğŸ“Œ 3. ì„ í˜• íšŒê·€ë¶„ì„
## 3-1. ìƒê´€ê´€ê³„
- ìƒê´€ê³„ìˆ˜ëŠ” df.corr() ì„ ì‚¬ìš©í•˜ì—¬ êµ¬í•  ìˆ˜ ìˆìœ¼ë©° ê¸°ë³¸ê°’ì€ method= í”¼ì–´ìŠ¨ì´ë‹¤.
- ë˜í•œ ì—´ë²¡í„°ë¼ë¦¬ì˜ corrë„ ì—­ì‹œ êµ¬í•  ìˆ˜ ìˆë‹¤.
```py
print(df['í‚¤'].corr(df['ëª¸ë¬´ê²Œ']))
print(df['ëª¸ë¬´ê²Œ'].corr(df['í‚¤']))

# í”¼ì–´ìŠ¨
print(df.corr())
# ìŠ¤í”¼ì–´ë§¨
print(df.corr(method='spearman'))
# ì¼„ë‹¬íƒ€ìš°
print(df.corr(method='kendall'))
```
- scipyì— ìˆëŠ” ê°’ìœ¼ë¡œ tê²€ì • ì—­ì‹œ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ”ë° ì´ë•Œì˜ ê·€ë¬´ê°€ì„¤ì€ ìƒê´€ì´ ì—†ë‹¤ ì´ë‹¤.
- pearson ë’¤ì— rì´ í•˜ë‚˜ ë” ë¶™ì–´ ìˆëŠ”ì§€ í™•ì¸í•´ë´ì•¼í•œë‹¤.
- ì´ë•Œ tê²€ì •ì€ ë‘ ë³€ìˆ˜ë§Œ ì •í™•íˆ ë¹„êµí•œë‹¤.
```py
# tê²€ì •
from scipy import stats
# í”¼ì–´ìŠ¨
print(stats.pearsonr(df['ëª¸ë¬´ê²Œ'], df['í‚¤']))

# ìŠ¤í”¼ì–´ë§¨
print(stats.spearmanr(df['ëª¸ë¬´ê²Œ'], df['í‚¤']))

# ì¼„ë‹¬íƒ€ìš°
print(stats.kendalltau(df['ëª¸ë¬´ê²Œ'], df['í‚¤']))
```

## 3-2. ë‹¨ìˆœ, ë‹¤ì¤‘ ì„ í˜• íšŒê·€ë¶„ì„
- ë³´í†µ modelì—ì„œ summaryë¥¼ í†µí•´ ê²°ì •ê³„ìˆ˜, íšŒê·€ê³„ìˆ˜, ì ˆí¸ ë“±ì„ ë‹¤ ì•Œ ìˆ˜ ìˆë‹¤.
```py
from statsmodels.formula.api import ols
model = ols('í‚¤ ~ ëª¸ë¬´ê²Œ', data=df).fit()
print(model.summary())

model.rsquared # ê²°ì •ê³„ìˆ˜
model.params['ëª¸ë¬´ê²Œ'] # íšŒê·€ê³„ìˆ˜ 
model.pvalues['ëª¸ë¬´ê²Œ'] # ëª¸ë¬´ê²Œì˜ íšŒê·€ê³„ìˆ˜ê°€ í†µê³„ì ìœ¼ë¡œ ìœ ì˜í•œì§€ pvalue
```
- ì´ë•Œ í•™ìŠµí•œ ëª¨í˜•ìœ¼ë¡œ íŠ¹ì • ë°ì´í„° ê°’ì„ ì œê³µí•˜ë©´ ì¢…ì†ë³€ìˆ˜ë¥¼ ì˜ˆì¸¡í•˜ì—¬ ë²¡í„°ë¥¼ ë°˜í™˜ë°›ì„ ìˆ˜ ìˆëŠ”ë° ê·¸ ë°©ë²•ì€ ì•„ë˜ì™€ ê°™ë‹¤.
- ì´ë•Œ formula ê¸°ë°˜ ëª¨ë¸(logit, ols, glm)ì„ ì¼ë‹¤ë©´ â†’ DataFrameë§Œ ì•ˆì •ì ìœ¼ë¡œ ë™ì‘í•œë‹¤. ì¦‰ seriesë„ ì•ˆì •ì ì´ì§€ ì•Šì•„ dataframeì„ ë„£ì–´ì£¼ì–´ì•¼ í•œë‹¤.
```py
newdata = pd.DataFrame({'ëª¸ë¬´ê²Œ':[50]})
model.predict(newdata)
```
- ì”ì°¨ì œê³±í•©ì„ êµ¬í•˜ëŠ” ê²ƒì€ ì•„ë˜ì™€ ê°™ì´ ì§ì ‘ df ì—´ë²¡í„°ë¥¼ ë¹¼ì£¼ë©´ ëœë‹¤.
- ë˜ mseëŠ” ì”ì°¨ ì œê³±ì— meaní•¨ìˆ˜ë¥¼ ì ìš©í•´ì£¼ê¸°ë§Œ í•˜ë©´ ëœë‹¤.
- ë¬¼ë¡  sklearnì—ì„œë„ ì‹¤ì œ, ì˜ˆì¸¡ê°’ì„ ë„£ì–´ì„œ mseë¥¼ êµ¬í•  ìˆ˜ëŠ” ìˆë‹¤.
```py
# ì”ì°¨ ì œê³±í•©
# ì”ì°¨ = ê´€ì¸¡(ì‹¤ì œ)ê°’ - ì˜ˆì¸¡ê°’
df['ì”ì°¨'] = df['í‚¤'] - model.predict(df['ëª¸ë¬´ê²Œ'])
sum(df['ì”ì°¨'] ** 2)

# MSE
(df['ì”ì°¨'] ** 2).mean()

# ì‚¬ì´í‚·ëŸ° MSE
from sklearn.metrics import mean_squared_error
pred = model.predict(df)
mean_squared_error(df['í‚¤'], pred)
```
- ë¨„ì•½ í”Œë«í¼ì´ë¼ëŠ” ë²”ì£¼í˜• ë³€ìˆ˜ê°€ ì„ì—¬ìˆì–´ë„ rì²˜ëŸ¼ ìˆ˜í•™ ê³µì‹ì— ê¸°ë°˜í•œë‹¤ë©´ ê·¸ëƒ¥ ë¡œì§€ìŠ¤í‹± íšŒê·€ì²˜ëŸ¼ c() ê°™ì€ í‘œê¸°ë„ í•„ìš”ì—†ê³  ê·¸ëƒ¥ ì ì–´ì£¼ë©´ ì›í•«ì¸ì½”ë”© í›„ drop_fistë¥¼ trueë¡œ ì„¤ì •í•˜ì—¬ ì˜ˆì¸¡í•œí›„ ê²°ê³¼ë¥¼ ì œê³µí•œë‹¤.
```py
from statsmodels.formula.api import ols
model = ols('ë§¤ì¶œì•¡ ~ ê´‘ê³ ë¹„ + í”Œë«í¼', data=df).fit()
print(model.summary())
```
- ì‹ ë¢°êµ¬ê°„ì„ êµ¬í•˜ëŠ” ê²ƒì€ get_prediction()ì„ ì‚¬ìš©í•˜ê³  ì´ë•Œ get_predictionì€ ê·¸ ì˜ˆì¸¡ê°’ì— ëŒ€í•œ ë¶ˆí™•ì‹¤ì„±ê¹Œì§€ ê³„ì‚°í•˜ì—¬ ì œê³µí•œë‹¤.
- ê·¸ë¦¬ê³  ì´ get_predictionì˜ ê²°ê³¼ë¥¼ í‘œë¡œ ë³€í™˜í•˜ë ¤ë©´ summary_frameì´ í•„ìš”í•˜ë‹¤.
- ì´ë•Œ ì‹ ë¢°êµ¬ê°„ê³¼ ì˜ˆì¸¡êµ¬ê°„ì„ ê°™ì´ ì œê³µí•˜ëŠ”ë° ì‹ ë¢°êµ¬ê°„(CI)ì€ íšŒê·€ì„  ìì²´ì˜ í”ë“¤ë¦¼ì„ ì˜ë¯¸í•˜ê³  ì˜ˆì¸¡êµ¬ê°„ì€ ìƒˆë¡œìš´ ì  í•˜ë‚˜ì˜ í”ë“¤ë¦¼ì„ ì˜ë¯¸í•œë‹¤. í•˜ì—¬ ì˜ˆì¸¡ êµ¬ê°„ì´ ì‹ ë¢°êµ¬ê°„ë³´ë‹¤ í”ë“¤ë¦¼ì´ í¬ë‹¤.
- ì•ŒíŒŒê°’ì´ ì œê³µí•˜ì—¬ ì‹ ë¢°êµ¬ê°„ ì¶”ì •ì— ëŒ€í•œ ê°’ì„ ë°›ëŠ”ë‹¤.
- ì´ë•Œ OLSì—ì„œ get_predictionì´ ë§Œë“œëŠ” ì‹ ë¢°êµ¬ê°„(CI)Â·ì˜ˆì¸¡êµ¬ê°„(PI)ì€ t-ë¶„í¬ë¡œ ì¶”ì •í•œë‹¤.
```py
# ëª¸ë¬´ê²Œê°€ 50ì¼ ë•Œ ì˜ˆì¸¡í‚¤ì— ëŒ€í•œ ì‹ ë¢°êµ¬ê°„, ì˜ˆì¸¡êµ¬ê°„
newdata = pd.DataFrame({'ëª¸ë¬´ê²Œ':[50]})
pred = model.get_prediction(newdata)
pred.summary_frame(alpha=0.05)
```

# ğŸ“Œ 4. ë¶„ì‚°ë¶„ì„
## 4-1. ì¼ì›ë¶„ì‚°ë¶„ì„
- ttest_indì™€ ë‹¬ë¦¬ 3ê°œ ì´ìƒì˜ ì§‘ë‹¨ì´ 1ê°œì˜ ì›ì¸ ì•„ë˜ ìƒê´€ì´ ìˆëŠ”ì§€ ì—†ëŠ”ì§€ ê²€ì‚¬í•œë‹¤.
- ì¼ì›ë¶„ì‚°ë¶„ì„ì˜ ê²½ìš°ëŠ” statsì—ë„ ìˆê³  statsmodelsì—ë„ ìˆë‹¤.
- ì•„ë˜ì²˜ëŸ¼ ì—¬ëŸ¬ ì—´ë²¡í„°ë¥¼ ë„˜ê²¨ì£¼ë©´ ëœë‹¤.
```py
from scipy import stats
stats.f_oneway(df['A'], df['B'], df['C'], df['D'])
```
- ì´ì—ë„ ì •ê·œì„± ê²€ì •ì€ shapiroë¡œ ë“±ë¶„ì‚° ê²€ì •ì€ leveneìœ¼ë¡œ í•œë‹¤.
```py
# ë°ì´í„°
df = pd.DataFrame({
    'A': [10.5, 11.3, 10.8, 10.6, 11.1, 10.2, 10.9, 11.4, 10.5, 10.3],
    'B': [10.9, 11.4, 11.1, 11.2, 11.5, 10.8, 11.2, 10.9, 11.4, 11.3],
    'C': [10.2, 10.7, 10.6, 10.9, 11.3, 11.1, 10.8, 10.5, 11.4, 11.0],
    'D': [13.8, 10.4, 10.1, 10.5, 10.6, 10.9, 10.2, 10.7, 10.3, 10.4]
})

# Shapiro-Wilk(ìƒ¤í”¼ë¡œ-ìœŒí¬) ì •ê·œì„± ê²€ì •
print(stats.shapiro(df['A']))
print(stats.shapiro(df['B']))
print(stats.shapiro(df['C']))
print(stats.shapiro(df['D']))

# Levene(ë ˆë¹ˆ) ë“±ë¶„ì‚° ê²€ì •
print(stats.levene(df['A'], df['B'], df['C'], df['D']))
```
- ë§Œì•½ ë¡œìš°ë°ì´í„°ê°€ ë°”ë¡œ ì£¼ì–´ì§„ë‹¤ë©´ í˜¹ì€ ìœ„ì²˜ëŸ¼ a,b,c,dê°€ ì¹¼ëŸ¼ìœ¼ë¡œ ìˆëŠ” í…Œì´ë¸”ì„ meltí•˜ì—¬ ë¡œìš°ë°ì´í„°ë¡œ ì¤€ë‹¤ë©´ statsmodels.fomula.apiì˜ olsë¥¼ ë§Œë“¤ê³  ì´ ì„ í˜•íšŒê·€ ëª¨í˜•ì„ ê¸°ì´ˆì‚¼ì•„ anova_lm ì¦‰ ì•„ë…¸ë°” í…Œì´ë¸”ì„ ë§Œë“¤ì–´ ì¼ì› ë¶„ì‚°ë¶„ì„ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤.
- anova_lmì€ statsmodels.stats.anovaì— ìœ„ì¹˜í•œë‹¤.
```py
# ë°ì´í„° ì¬êµ¬ì¡°í™” (ê¸´ í˜•íƒœ)
df_melt = df.melt()
df_melt.head()

# ANOVA í…Œì´ë¸”
from statsmodels.formula.api import ols
from statsmodels.stats.anova import anova_lm

model = ols('value ~ variable', data=df_melt).fit()
anova_lm(model)
```
- ë§Œì•½ì— ì´ ì—¬ëŸ¬ í´ë˜ìŠ¤ë“¤ ê°„ì— ì–´ëŠ í´ë˜ìŠ¤ê°€ êµ¬ì²´ì ìœ¼ë¡œ ì–´ë–¤ ì˜í–¥ì„ ë¯¸ì¹˜ëŠ”ì§€ ì¡°ì‚¬í•˜ê³  ì‹¶ë‹¤ë©´ ì‚¬í›„ê²€ì •ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤.
- ì‚¬í›„ê²€ì •ì€ íˆ¬í‚¤ê²€ì •ê³¼ ë³¸íŒ¨ë¡œë‹ˆ ê²€ì •ì´ ìˆë‹¤.
- statsmodels.statsì— multicompì— ì¡´ì¬í•˜ë©° pairwise_tukey hsd, MultiComparisonì´ë‹¤.
```py
from scipy import stats
from statsmodels.stats.multicomp import pairwise_tukeyhsd, MultiComparison

# Tukey HSD (íˆ¬í‚¤)
tukey_result = pairwise_tukeyhsd(df_melt['value'], df_melt['variable'], alpha=0.05)
print(tukey_result.summary())

# Bonferroni(ë³¸í˜ë¡œë‹ˆ)
mc = MultiComparison(df_melt['value'], df_melt['variable'])
bon_result = mc.allpairtest(stats.ttest_ind, method='bonf')
print(bon_result[0])
```
- ë§Œì•½ í•´ë‹¹ ì§‘ë‹¨ë“¤ì´ ì •ê·œì„±ì„ ë§Œì¡±í•˜ì§€ ëª»í•œë‹¤ë©´ ë¹„ëª¨ìˆ˜ ê²€ì •ìœ¼ë¡œ kruskal-wallisê²€ì •ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤.
- ì´ëŠ” scipy.statsì— ì¡´ì¬í•œë‹¤.
```py
# Kruskal-Wallis ê²€ì •
stats.kruskal(df['A'], df['B'], df['C'], df['D'])
```

## 4-2. ì´ì›ë¶„ì‚°ë¶„ì„
- ì´ì›ë¶„ì‚°ë¶„ì„ì€ 3ê°œì´ìƒì˜ ì§‘ë‹¨ì— ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” ì¸ìê°€ 2ê°œ ì´ìƒì¸ ë¶„ì„ì´ë‹¤.
- ì´ì›ë¶„ì‚°ë¶„ì„ì€ ë¬´ì¡°ê±´ olsì™€ anova_lmì„ ì´ìš©í•œë‹¤.
- êµí˜¸í•­ì€ ì¢…ì:ë¹„ë£Œì²˜ëŸ¼ í‘œê¸°í•œë‹¤.
```py
# anova í…Œì´ë¸”
from statsmodels.formula.api import ols
from statsmodels.stats.anova import anova_lm
model = ols('í† ë§ˆí† ìˆ˜ ~ ì¢…ì + ë¹„ë£Œ + ì¢…ì:ë¹„ë£Œ', data=df).fit()
anova_lm(model)
```
- ë§Œì•½ ì¤‘ê°„ì— ë²”ì£¼í˜• ë°ì´í„°ê°€ ìˆëŠ”ë° 11, 12, 13 ì´ëŸ°ì‹ìœ¼ë¡œ ìˆ«ìê°€ ë²”ì£¼í˜• ìì²´ë¼ë©´ ì—¬ê¸°ì— C ì¦‰ ë²”ì£¼í˜• í‘œì‹œë¥¼ í•´ì£¼ì–´ì•¼ í•œë‹¤.
- ë˜ ì´ì™€ ê°™ì€ í‘œê¸°ë¥¼ *ì„ ì´ìš©í•´ì„œ í•  ìˆ˜ë„ ìˆë‹¤.
```py
# ë²”ì£¼í˜• ë°ì´í„° ì²˜ë¦¬
from statsmodels.formula.api import ols
from statsmodels.stats.anova import anova_lm
model = ols('í† ë§ˆí† ìˆ˜ ~ C(ì¢…ì) + C(ë¹„ë£Œ) + C(ì¢…ì):C(ë¹„ë£Œ)', data=df).fit()
anova_lm(model)

# formula * í™œìš©
from statsmodels.formula.api import ols
from statsmodels.stats.anova import anova_lm
# model = ols('í† ë§ˆí† ìˆ˜ ~ C(ì¢…ì) + C(ë¹„ë£Œ) + C(ì¢…ì):C(ë¹„ë£Œ)', data=df).fit()
model = ols('í† ë§ˆí† ìˆ˜ ~ C(ì¢…ì) * C(ë¹„ë£Œ)', data=df).fit()
anova_lm(model)
```
- ê²°ê³¼ë¥¼ ì§€ìˆ˜ë¡œ í‘œê¸°í•˜ëŠ” ë²•ì€ ì•„ë˜ì™€ ê°™ë‹¤.
```py
# ì¼ë°˜í‘œê¸°ë²• format(ì§€ìˆ˜í‘œê¸°ë²•, '.10f')
print(format(7.254117e-10,'.10f'))
print(format(1.835039e-03,'.10f'))
print(format(2.146636e-01,'.10f'))
```
- ì´ë•Œ ë‹¨ìˆœíˆ ì˜í–¥ì„ ì¤€ë‹¤ ì•ˆì¤€ë‹¤ê°€ ì•„ë‹Œ ìì„¸í•œ ì„¤ëª…ì´ í•„ìš”í•˜ë‹¤ë©´ ì•ì„œ í•œê²ƒì²˜ëŸ¼ ì‹¬í™”ë¶„ì„ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤.
- ì•ì„  ì‚¬í›„ê²€ì •ê³¼ ë‹¬ë¦¬ í•œ ë³€ìˆ˜ ë‹¹ í•œë²ˆì”© ì´ ë‘ë²ˆ ìˆ˜í–‰í•´ì•¼í•œë‹¤.
```py
from statsmodels.stats.multicomp import pairwise_tukeyhsd

# Tukey HSD
tukey_summary1 = pairwise_tukeyhsd(df['í† ë§ˆí† ìˆ˜'], df['ì¢…ì'], alpha=0.05)
tukey_summary2 = pairwise_tukeyhsd(df['í† ë§ˆí† ìˆ˜'], df['ë¹„ë£Œ'].astype(str), alpha=0.05)
print(tukey_summary1)
print(tukey_summary2)

# Bonferroni
from scipy import stats
from statsmodels.stats.multicomp import MultiComparison

mc = MultiComparison(df['í† ë§ˆí† ìˆ˜'], df['ì¢…ì'])
bon_result = mc.allpairtest(stats.ttest_ind, method="bonf", alpha=0.05)
print(bon_result[0])

mc = MultiComparison(df['í† ë§ˆí† ìˆ˜'], df['ë¹„ë£Œ'])
bon_result = mc.allpairtest(stats.ttest_ind, method="bonf")
print(bon_result[0])
```
- ì •ê·œì„± ê²€ì •ê³¼ ë“±ë¶„ì‚° ê²€ì •ë„ ë‘ë²ˆì”© ìˆ˜í–‰í•´ì•¼í•œë‹¤.
```py
from scipy.stats import shapiro

cond_tree_A = df['ì¢…ì'] == 'A'
cond_tree_B = df['ì¢…ì'] == 'B'
cond_tree_C = df['ì¢…ì'] == 'C'
cond_tree_D = df['ì¢…ì'] == 'D'

cond_fert_1 = df['ë¹„ë£Œ'] == 11
cond_fert_2 = df['ë¹„ë£Œ'] == 12
cond_fert_3 = df['ë¹„ë£Œ'] == 13

print(shapiro(df[cond_tree_A & cond_fert_1]['í† ë§ˆí† ìˆ˜']))
print(shapiro(df[cond_tree_A & cond_fert_2]['í† ë§ˆí† ìˆ˜']))
print(shapiro(df[cond_tree_A & cond_fert_3]['í† ë§ˆí† ìˆ˜']))

print(shapiro(df[cond_tree_B & cond_fert_1]['í† ë§ˆí† ìˆ˜']))
print(shapiro(df[cond_tree_B & cond_fert_2]['í† ë§ˆí† ìˆ˜']))
print(shapiro(df[cond_tree_B & cond_fert_3]['í† ë§ˆí† ìˆ˜']))

print(shapiro(df[cond_tree_C & cond_fert_1]['í† ë§ˆí† ìˆ˜']))
print(shapiro(df[cond_tree_C & cond_fert_2]['í† ë§ˆí† ìˆ˜']))
print(shapiro(df[cond_tree_C & cond_fert_3]['í† ë§ˆí† ìˆ˜']))

print(shapiro(df[cond_tree_D & cond_fert_1]['í† ë§ˆí† ìˆ˜']))
print(shapiro(df[cond_tree_D & cond_fert_2]['í† ë§ˆí† ìˆ˜']))
print(shapiro(df[cond_tree_D & cond_fert_3]['í† ë§ˆí† ìˆ˜']))

from scipy.stats import levene
print(levene(df[cond_tree_A]['í† ë§ˆí† ìˆ˜'],
             df[cond_tree_B]['í† ë§ˆí† ìˆ˜'],
             df[cond_tree_C]['í† ë§ˆí† ìˆ˜'],
             df[cond_tree_D]['í† ë§ˆí† ìˆ˜']))
print(levene(df[cond_fert_1]['í† ë§ˆí† ìˆ˜'],
             df[cond_fert_2]['í† ë§ˆí† ìˆ˜'],
             df[cond_fert_3]['í† ë§ˆí† ìˆ˜']))
```