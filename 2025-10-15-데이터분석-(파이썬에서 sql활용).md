# ğŸ“Œ 1. íŒŒì´ì¬ì—ì„œ SQL í™œìš©
### 1-1. sql ì—°ê²°
- í•´ë‹¹ dbë¥¼ ì½”ë©ì— ë§Œë“¤ì–´ì„œ ë°”ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆê³  ì•„ë˜ connection ê°ì²´ë¥¼ í†µí•´ì„œ ì½”ë©ì— ë§Œë“¤ì–´ë‘” dbì— ì ‘ì†í•œë‹¤. í•´ë‹¹ dbê°€ ì—†ìœ¼ë©´ ìƒˆë¡œ ë§Œë“ ë‹¤.
- cursorëŠ” ì¿¼ë¦¬ë¥¼ sqlì— ì‹¤ì–´ë‚˜ë¥´ê³  ê°’ì„ ë°›ì•„ì„œ ê°€ì ¸ì˜¤ëŠ” ì—­í• ì„ í•˜ëŠ” ê°ì²´ì´ë‹¤.
```py
import sqlite3
# connection ê°ì²´ë¥¼ ìƒì„± # conn.close()ë¡œ ì±„ë„ ë‹«ê¸°
conn = sqlite3.connect('sqlite_test.db')
cursor = conn.cursor() # sqlì„ íƒœì›Œë³´ë‚¼ cursorë¥¼ ë§Œë“ ë‹¤.
```

### 1-2. execute ëª…ë ¹ì–´ë¡œ sql ì¿¼ë¦¬ ì…ë ¥í•˜ê¸°
```py
# í…Œì´ë¸” ìƒì„±
cursor.execute('CREATE TABLE contact(name text, age int, email text)')

# ë°ì´í„° ì‚½ì… 1
conn.execute("INSERT INTO contact VALUES('kim', 20, 'kim@megait.edu')")
conn.execute("INSERT INTO contact VALUES('lee', 40, 'lee@macademy.org')")
conn.execute("INSERT INTO contact VALUES('park', 60, 'park@daum.net')")

# ë°ì´í„° ì‚½ì… 2
input_data = (
    ('í™', 25, 'hong@naver.com'),
    ('ê°•', 34, 'kang@yes.kr'),
    ('ì§„', 56, 'jin@mail.com'),
)

sql = "INSERT INTO contact(name, age, email) values (?, ?, ?)"

cursor.executemany(sql, input_data)

# ëª¨ë“  ì‘ì—…ì´ ì™„ë£Œë˜ë©´ ì»¤ë°‹í•´ì•¼ dbì— ë°˜ì˜ëœë‹¤.
conn.commit()

# ì·¨ì†Œí•˜ë ¤ë©´ rollback ìˆ˜í–‰
conn.rollback()
# ë°ì´í„°ë² ì´ìŠ¤ ì¢…ë£Œ: connection ì—°ê²° ì¢…ë£Œ
conn.close()
```
- fetchoneëŠ” í˜„ì¬ ì»¤ì„œ ìœ„ì¹˜ì—ì„œ í•œí–‰ë§Œ ê°€ì ¸ì˜¤ê¸°ì´ê³ 
- fetchallëŠ” ëª¨ë“  í–‰ ê°€ì ¸ì˜¤ê¸° ì´ë‹¤.
```py
cursor.fetchone()
cursor.fetchall()
```

### 1-3. ì£¼ì‹ì •ë³´ ê°€ì ¸ì™€ì„œ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•˜ê¸°
- df_hynix = fdr.DataReader('000660', '20150901',"20151015")ì—ì„œ ì£¼ì‹ì½”ë“œì™€ ê¸°ê°„ì„ ì…ë ¥í•˜ì—¬ì„œ í•´ë‹¹ ì£¼ì‹ ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
```py
import sqlite3
import pandas as pd
import pandas_datareader as pdr
import FinanceDataReader as fdr

df_krx = fdr.StockListing('KRX')
df_hynix = fdr.DataReader('000660', '20150901',"20151015")

conn = sqlite3.connect('kosphi_hynix.db')
cur = conn.cursor()
```
- ì•„ë˜ ëª…ë ¹ì„ í†µí•´ ì—°ê²°ëœ connë¥¼ íƒ€ê³  í•´ë‹¹ ë°ì´í„° ë² ì´ìŠ¤ì— hynixë¼ëŠ” í…Œì´ë¸”ì„ ë§Œë“¤ê³  í•´ë‹¹ ë°ì´í„° í”„ë ˆì„ì˜ ë°ì´í„°ë¥¼ ë°€ì–´ë„£ëŠ”ë‹¤.
```py
df_hynix.to_sql('hynix', conn, if_exists='replace')
```
- ì½ì–´ë“¤ì¼ ë•ŒëŠ” pandasì˜ read_sqlì„ í™œìš©í•˜ì—¬ select êµ¬ë¬¸ì„ ë„£ì–´ì„œ í•´ë‹¹ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
- ì´ë•Œ connection ê°ì²´ë¥¼ ë„˜ê²¨ì•¼í•œë‹¤.
```py
pd.read_sql("select * from hynix", conn)
```

### 1-4. sql ì¶”ê°€ ì‹¤ìŠµ
- ëª¨ë“  í…Œì´ë¸”ì˜ ì •ë³´ë¥¼ ë‹´ê³  ìˆëŠ” meta tableì´ ëª¨ë“  dbì— ë‹¤ ìˆë‹¤
- ì—¬ê¸°ì—ì„  sqlite_masterì´ë‹¤.
- """ë¥¼ í™œìš©í•˜ì—¬ ì¿¼ë¦¬ì˜ ê°€ë…ì„±ì„ ë†’ì¼ ìˆ˜ ìˆë‹¤.
```py
import pandas as pd
conn = sqlite3.connect('pandas-transaction.db')
query = "select * from 'sqlite_master'"       # í•´ë‹¹ DBì—ì„œ ì „ì²´ Master ë˜ëŠ” Table ë“¤ ì¡°íšŒì‹œ ì‚¬ìš©
pd.read_sql(query, conn)

# ì•„ë˜ì²˜ëŸ¼ ì¿¼ë¦¬ë¥¼ ë°”ê¿”ê°€ë©´ì„œ ì›í•˜ëŠ” ê²ƒì„ ì¡°íšŒí•˜ë©´ ëœë‹¤.

query = 
"""select Name, Age, Sex, email, rank() over(order by Age) 
from 'user' 
order by Name asc"""       # í•´ë‹¹ DBì—ì„œ ì „ì²´ Master ë˜ëŠ” Table ë“¤ ì¡°íšŒì‹œ ì‚¬ìš©
pd.read_sql(query, conn)
```