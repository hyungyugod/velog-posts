# ğŸ“Œ 0. ë³´ìŠ¤ í´ë¡  ì½”ë”©
### ğŸ“Œ 0-1. ì •ë³´ìˆ˜ì • ì‹œìŠ¤í…œ HTML
- ìš°ì„  ì •ë³´ ìˆ˜ì • í•­ëª© êµ¬í˜„ì´ ì‰½ì§€ ì•Šì€ ì´ìœ ëŠ” í•´ë‹¹ í•­ëª©ì´ ëª¨ë‹¬ì´ê³  ì—´ê³  ë‹«ì„ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ìˆ˜ì • í•˜ê³  ëŒì•„ë‹¤ë‹ˆë‹¤ê°€ ë‹¤ì‹œ ì—´ì—ˆì„ ë•Œ ìµœì‹  ì •ë³´ê°€ ë°˜ì˜ì´ ë˜ì–´ìˆì–´ì•¼ í•œë‹¤.
-  ë¹„ë¡ íƒ€ì„ë¦¬í”„ë¡œ ë°›ì•„ì˜¤ëŠ”ê²Œ ì–´ì§œí”¼ ëœë”ë§í• ë•Œ ì°ì–´ë‘ë©´ ë˜ëŠ”ê±°ë¼ í¸í•˜ê¸´ í•˜ì§€ë§Œ í˜ì´ì§€ ì„¸ë¡œ ê³ ì¹¨ë§ˆë‹¤ ì •ë³´ê°€ ë¦¬ì…‹ë˜ëŠ” ê²ƒì´ë¯€ë¡œ ëª¨ë‹¬ì„ ì—´ê³  ë‹«ì•„ë„ ì´ˆê¸°ê°’ì´ ìœ ì§€ëœë‹¤ëŠ” ë‹¨ì ì´ ìˆì–´ ì• ì´ˆë¶€í„° jsë¡œ êµ¬í˜„í•˜ëŠ”ê²Œ ë§ˆìŒì´ í¸í•˜ê¸°ëŠ” í•˜ë‹¤.
-  í”„ë¡œí•„ ì´ë¯¸ì§€ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ê¸°ë³¸ ì´ë¯¸ì§€ë¥¼ ì„¸íŒ…í•´ë‘ê³  jsê°€ ë¡œë“œë˜ë©´ì„œ ajax í•´ë‹¹ íšŒì›ì˜ ì´ë¯¸ì§€ë¥¼ ë°›ì•„ì˜¤ë©´ ë°”ë¡œ ë””ìŠ¤í”Œë ˆì´ í•´ì£¼ëŠ”ê²Œ ì¢‹ë‹¤.
-  ê·¸ë¦¬ê³  input type="file"ì€ ë¸Œë¼ìš°ì €ë§ˆë‹¤ ì»¤ìŠ¤í„°ë§ˆì´ì§• í•˜ê¸°ê°€ ë§¤ìš° ì–´ë µê³  ë”°ë¼ì„œ ì´ë¥¼ ìˆ¨ê²¨ë†“ê³  ë‹¤ë¥¸ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ jsë¡œ ì´ ë²„íŠ¼ì„ ê°„ì ‘ì ìœ¼ë¡œ í´ë¦­í•˜ê²Œ í•˜ëŠ” ë°©ë²•ì„ ë§ì´ ì‚¬ìš©í•œë‹¤.
-  onclick="daumPostcode()"ëŠ” ë‹¤ìŒì—ì„œ ì œê³µí•˜ëŠ” ë„ë¡œëª… ì£¼ì†Œë¡œ ì£¼ì†Œë¥¼ ì°¾ì•„ì£¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•œ ê²ƒì¸ë° ì´ë¥¼ ì‚¬ìš©í•˜ë©´ ì–´ë ¤ìš´ ì§€ë„ ì‘ì—…ì„ ì¢€ ë” ì‰½ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤.
```html
<!-- ì •ë³´ìˆ˜ì • -->
<div id="modal-overlay-profile" class="modal-overlay" style="display:none;">
    <div class="modal-box">
        <div class="modal-title">
            <div class="modal-title-text">ì •ë³´ ìˆ˜ì •</div>
        </div>
        <button id="modal-close-profile" class="modal-close">Ã—</button>
        <div class="modal-body">
            <!-- í”„ë¡œí•„ ì˜ì—­ -->
            <div class="profile-edit-section">
                <div class="avatar-container">
                    <img id="profile-img" src="/assets/img/wishlist/default_profile.png" alt="í”„ë¡œí•„ ì´ë¯¸ì§€" class="profile-avatar" />
                    <button id="avatar-edit-btn" class="avatar-edit-btn" aria-label="í”„ë¡œí•„ ì´ë¯¸ì§€ ë³€ê²½" type="button">
                        <i class="fa fa-camera"></i>
                    </button>
                    <!-- ìˆ˜ì •, ì‚­ì œ ë©”ë‰´ -->
                    <div id="avatar-menu" class="avatar-menu" style="display:none;">
                        <button id="avatar-edit-option" type="button">
                            <i class="fa fa-pen"></i> ìˆ˜ì •
                        </button>
                        <button id="avatar-delete-option" type="button" class="delete" disabled>
                            <i class="fa fa-trash"></i> ì‚­ì œ
                        </button>
                    </div>
                    <!-- ì‹¤ì œ íŒŒì¼ input (ìˆ¨ê¹€) -->
                    <input type="file" id="profile-img-input" accept="image/*" style="display:none;" />
                </div>
                <div class="member-type">ì¼ë°˜ íšŒì›</div>
            </div>
            <!-- ì •ë³´ ì…ë ¥ í¼ -->
            <div class="profile-edit-form">
                <div class="input-group">
                    <input type="email" name="email" placeholder="ì´ë©”ì¼" value="" readonly />
                    <input type="password" name="currentPassword" placeholder="ê¸°ì¡´ ë¹„ë°€ë²ˆí˜¸" />
                    <input type="password" name="newPassword" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³€ê²½ í•˜ëŠ” ê²½ìš° ì…ë ¥í•˜ì„¸ìš”" />
                    <input type="password" name="confirmPassword" placeholder="ë¹„ë°€ë²ˆí˜¸ í™•ì¸" />
                </div>
                <label>
                    <div class="requiered-set">
                        <p>ì´ë¦„</p><span class="required-dot">â—</span>
                    </div>
                    <input type="text" name="name" value="" />
                </label>
                <label>
                    <div class="requiered-set">
                        <p>ì„±ë³„</p><span class="required-dot">â—</span>
                    </div>
                    <div class="form-column">
                        <label>
                            <input type="radio" name="gender" value="male" />
                            <p>ë‚¨ì</p>
                        </label>
                        <label>
                            <input type="radio" name="gender" value="female" />
                            <p>ì—¬ì</p>
                        </label>
                    </div>
                </label>
                <label>
                    <div class="requiered-set">
                        <p>ì—°ë½ì²˜</p><span class="required-dot">â—</span>        
                    </div>
                    <input type="text" name="phone" value="" />
                </label>
                <label class="address-label">
                    <div class="requiered-set">
                        <p>ì£¼ì†Œ</p>        
                    </div>
                    <div class="input-group">
                        <input type="hidden" id="postcode" name="postcode" placeholder="ìš°í¸ë²ˆí˜¸"/>
                        <input type="text" id="address" name="address" onclick="daumPostcode()" placeholder="ì£¼ì†Œ" value="" />
                        <input type="text" id="specific-address" name="addressDetail" placeholder="ìƒì„¸ì£¼ì†Œ" value="" />
                        <div id="wrap" style="display:none;border:1px solid;width:600px;height:auto;margin:5px 0;"></div>
                    </div>
                </label>
                <label>
                    <div class="requiered-set">
                        <p>ìƒë…„ì›”ì¼</p><span class="required-dot">â—</span>
                    </div> 
                    <div class="form-row">
                        <select name="birthYear"></select>
                        <select name="birthMonth"></select>
                        <select name="birthDay"></select>
                    </div>
                </label>
                <label>
                    <div class="requiered-set">
                        <p>ì´ë²¤íŠ¸/í˜œíƒ ì†Œì‹ ìˆ˜ì‹  ì—¬ë¶€</p>
                    </div>
                    <div class="form-column">
                        <label>
                            <input type="checkbox" name="agreeSms" /> 
                            <p>ë©”ì‹œì§€ ìˆ˜ì‹  ë™ì˜</p>
                        </label>
                        <label>
                            <input type="checkbox" name="agreeEmail" /> 
                            <p>E-Mail ìˆ˜ì‹  ë™ì˜</p>
                        </label>
                    </div>
                </label>
                <button type="submit" class="confirm-btn">í™•ì¸</button>
            </div>
        </div>
    </div>
</div>
```

### ğŸ“Œ 0-2. ì •ë³´ìˆ˜ì • ì‹œìŠ¤í…œ js
- ì—¬ëŸ¬ ê¸°ëŠ¥ì´ ìˆì–´ ê¸°ëŠ¥ë§ˆë‹¤ ëŠì–´ë³´ë„ë¡ í•˜ê² ë‹¤.

#### ìƒë…„ì›”ì¼ ì…€ë ‰íŠ¸ ë°•ìŠ¤ ì´ˆê¸°í™” ë¡œì§
- ì…€ë ‰íŠ¸ ë°•ìŠ¤ì•ˆì— ì§€ì •í•œ ë²”ìœ„ë¥¼ value ê°’ì— ì…ë ¥í•˜ì—¬ ì¼ì¼íˆ option íƒœê·¸ë¡œ ì°ì–´ì£¼ëŠ” ë°©ë²•ì´ë‹¤. ì´ëŠ” ì¼ì¼íˆ ì…ë ¥í•˜ê¸° ì–´ë ¤ìš´ ë“œë¡­ë‹¤ìš´ ì˜µì…˜ì„ ë™ì ìœ¼ë¡œ ìƒì„±í•´ì¤˜ì„œ í¸ë¦¬í•˜ë‹¤.
- ì´ë•Œ ë…„ë„ëŠ” í˜„ì¬ ì—°ë„ë¥¼ ë°˜ì˜í•˜ë¯€ë¡œ ìœ ì§€ë³´ìˆ˜ ì…ì¥ì—ì„œë„ ìš°ìˆ˜í•˜ë‹¤. select íƒœê·¸ ì•ˆì— innerHTMLì„ ì°ì–´ì„œ ì±„ì›Œë„£ëŠ” êµ¬ì¡°ì´ë‹¤.
```js
// ------------------------- ìƒë…„ì›”ì¼ ì…€ë ‰íŠ¸ ë°•ìŠ¤ ì´ˆê¸°í™” ----------------
window.addEventListener('DOMContentLoaded', function() {
    // ì—°ë„: 1900 ~ ì˜¬í•´
    const yearSelect = document.querySelector('select[name="birthYear"]');
    const currentYear = new Date().getFullYear();
    yearSelect.innerHTML = '<option value="">ì—°ë„</option>';
    for (let y = currentYear; y >= 1900; y--) {
        yearSelect.innerHTML += `<option value="${y}">${y}</option>`;
    }

    // ì›”: 1~12 (0 ì—†ì´)
    const monthSelect = document.querySelector('select[name="birthMonth"]');
    monthSelect.innerHTML = '<option value="">ì›”</option>';
    for (let m = 1; m <= 12; m++) {
        monthSelect.innerHTML += `<option value="${m}">${m}</option>`;
    }

    // ì¼: 1~31 (0 ì—†ì´)
    const daySelect = document.querySelector('select[name="birthDay"]');
    daySelect.innerHTML = '<option value="">ì¼</option>';
    for (let d = 1; d <= 31; d++) {
        daySelect.innerHTML += `<option value="${d}">${d}</option>`;
    }
});
```

#### ë°›ì•„ì˜¨ íšŒì› ì •ë³´ë¥¼ ìˆ˜ì • í˜ì´ì§€ì— ë¯¸ë¦¬ ì±„ì›Œë‘ê¸°
- ì•ì„œ ì„¤ëª…í•œ ê²ƒì²˜ëŸ¼ ëª¨ë‹¬ë¡œ êµ¬í˜„ë˜ì–´ìˆê¸° ë•Œë¬¸ì— ajaxë¡œ ëª¨ë‹¬ì„ ì—´ë•Œë§ˆë‹¤ ìµœì‹ ê°’ì„ ë°›ì•„ì™€ì•¼í•œë‹¤.
- fillProfileForm í•¨ìˆ˜ëŠ” í”„ë¡œí•„ì„ ì±„ìš°ëŠ” í•¨ìˆ˜ë¡œ ajaxë¡œ ë°›ì•„ì˜¨ íšŒì› ì •ë³´ jsonì„ í† ëŒ€ë¡œ ì§ì ‘ html value ê°’ì„ ë§¤í•‘í•œë‹¤.
- document.querySelector('input[name="email"]').value = member.userEmail || ""; ì—¬ê¸°ì„œ ||ëŠ” or ì´ì§€ë§Œ ì™¼ìª½ë¶€í„° ìš°ì„ ì ìœ¼ë¡œ ì½ì–´ì„œ ì°¸ì´ë©´ ì°¸ì´ë¼ëŠ” ëœ»ì´ê¸° ë•Œë¬¸ì— ì™¼ìª½ê°’ì´ ì¡´ì¬í•˜ë©´ ì™¼ìª½ê°’ì´ ë¦¬í„´ëœë‹¤.
- document.querySelector('input[name="gender"][value="male"]').checked = member.userGender === "male"; ì—ì„œ ì˜¤ë¥¸ìª½ ê°’ì´ ë‚¨ìë©´ trueê°€ ë˜ë¯€ë¡œ maleì´ valueì¸ ê°’ì˜ checkedê°€ trueê°€ ëœë‹¤.
- í¼ ë°ì´í„°ë¥¼ ì „ì†¡í• ë•ŒëŠ” input[name="email"]ë¥¼ ì“°ëŠ”ê²Œ í•´ë‹¹ íƒœê·¸ê°€ ì†Œí†µí•˜ëŠ” ê³ ìœ í•œ ê°’ì¸ nameê°’ì„ ë³¼ ìˆ˜ ìˆì–´ì„œ ì¢‹ë‹¤.
- document.querySelector('input[name="agreeSms"]').checked = !!member.smsTerm; ì—¬ê¸°ì„œ !!ë¥¼ ë‘ë²ˆì“´ ê²ƒì€ ì™„ë²½í•˜ê²Œ booleanìœ¼ë¡œ ë§Œë“¤ì–´ì£¼ê¸° ìœ„í•´ì„œì´ë‹¤. 
- ì¦‰ truthyì™€ falsyë¥¼ trueì™€ falseë¡œ ë§Œë“¤ì–´ì£¼ëŠ” ê²ƒì¸ë° truthyì™€ falsyëŠ” ê°ê° ì°¸ì´ë¼ê³  í‰ê°€ë˜ëŠ” ê°’, ê±°ì§“ì´ë¼ê³  í‰ê°€ë˜ëŠ” ê°’ì„ ì˜ë¯¸í•œë‹¤. ì´ë•Œ truthyëŠ” ëŒ€ë¶€ë¶„ì˜ ì¡´ì¬í•˜ëŠ” ê°’, falsyëŠ” false, 0, "", null, undefined, NaNì´ ìˆê³  ì´ë¥¼ ë¶€ì •í•˜ë©´ truthyê°€ ëœë‹¤. ê·¸ë˜ì„œ í•œë²ˆë” ë¶€ì •í–ˆì„ë•Œ falseë¡œ í™•ì‹¤íˆ í•  ìˆ˜ ìˆëŠ” ê²ƒì´ë‹¤.
- "0"(ë¬¸ìì—´)ì€ truthyì„ì—ë§Œ ì£¼ì˜í•˜ë©´ ì¢‹ì„ë“¯ ì‹¶ë‹¤.
- ê·¸ë¦¬ê³  ëª¨ë‹¬ì„ ë‹«ì„ ë•Œ ëª¨ë“  ê°’ì„ ë¹„ìš°ê³  inputì— ëŒ€ê¸°ì¤‘ì¸ ê°’ë„ ë¹„ìš°ëŠ”ê²Œ ì¤‘ìš”í•œë‹¤. ì´ëŸ° ëª¨ë‹¬ë¡œ ê°’ì„ ë¶ˆëŸ¬ë“¤ì´ëŠ” ê²ƒì˜ ê°€ì¥ í° ë¦¬ìŠ¤í¬ê°€ ì˜ˆì „ ê°’ì´ ê³„ì† ë‚¨ì•„ìˆëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì´ë‹¤.
- ëª¨ë‹¬ì„ ì—¬ëŠ” ê²ƒì€ ajaxë¡œ ê°’ì„ ë°›ì•„ì™€ fillProfileFormë¥¼ í˜¸ì¶œí•˜ê³  ë‹«ëŠ”ê±´ clearProfileFormë¥¼ í˜¸ì¶œí•œë‹¤.
```js
// ------------------------- í”„ë¡œí•„ í¸ì§‘ ëª¨ë‹¬ ê¸°ëŠ¥ + ë°›ì•„ì˜¨ ì´ë¯¸ì§€ ë„ìš°ê¸° ----------------
// ë°›ì•„ì˜¨ íšŒì› ì •ë³´ë¥¼ input/ì´ë¯¸ì§€ì— ì„¸íŒ… (ì—†ëŠ” ê°’ì€ ë¹„ì›€)
function fillProfileForm(member) {

    // í”„ë¡œí•„ ì´ë¯¸ì§€ -> í”„ë¡œí•„ì´ë¯¸ì§€ê°€ ìˆìœ¼ë©´ ê·¸ê±¸ë¡œ, ì—†ìœ¼ë©´ ê¸°ë³¸ ì´ë¯¸ì§€ë¡œ
    const profileImg = document.getElementById('profile-img');
    if (member.userProfileImg && member.userProfileImg.trim() !== "") {
        profileImg.src = member.userProfileImg;
    } else {
        profileImg.src = "/assets/img/wishlist/default_profile.png";
    }

    document.querySelector('input[name="email"]').value = member.userEmail || "";
    document.querySelector('input[name="name"]').value = member.userName || "";
    document.querySelector('input[name="phone"]').value = member.userPhone || "";
    document.querySelector('input[name="postcode"]').value = member.userPostcode || "";
    document.querySelector('input[name="address"]').value = member.userAddress || "";
    document.querySelector('input[name="addressDetail"]').value = member.userSpecificAddress || "";

    // ì„±ë³„ ë¼ë””ì˜¤ ë²„íŠ¼
    if (member.userGender === "male" || member.userGender === "female") {
        document.querySelector('input[name="gender"][value="male"]').checked = member.userGender === "male";
        document.querySelector('input[name="gender"][value="female"]').checked = member.userGender === "female";
    } else {
        document.querySelector('input[name="gender"][value="male"]').checked = false;
        document.querySelector('input[name="gender"][value="female"]').checked = false;
    }

    // ìƒë…„ì›”ì¼
    if (member.birthYear) document.querySelector('select[name="birthYear"]').value = member.birthYear;
    else document.querySelector('select[name="birthYear"]').value = "";

    if (member.birthMonth) document.querySelector('select[name="birthMonth"]').value = member.birthMonth;
    else document.querySelector('select[name="birthMonth"]').value = "";

    if (member.birthDay) document.querySelector('select[name="birthDay"]').value = member.birthDay;
    else document.querySelector('select[name="birthDay"]').value = "";

    // ì²´í¬ë°•ìŠ¤ // ê°’ì´ ìˆìœ¼ë©´ true, ì—†ìœ¼ë©´ false
    document.querySelector('input[name="agreeSms"]').checked = !!member.smsTerm; 
    document.querySelector('input[name="agreeEmail"]').checked = !!member.emailTerm;
}

// í¼/ì´ë¯¸ì§€ ì´ˆê¸°í™” (ëª¨ë‹¬ ë‹«ì„ ë•Œ) -> ë‹¤ì‹œ ì—´ì—ˆì„ë•Œ ì‚¬ìš©ìê°€ ì…ë ¥í•œ ê°’ì´ ì•„ë‹ˆë¼ ê¸°ë³¸ê°’ìœ¼ë¡œ ì´ˆê¸°í™”
function clearProfileForm() {
    document.querySelector('input[name="email"]').value = "";
    document.querySelector('input[name="name"]').value = "";
    document.querySelector('input[name="phone"]').value = "";
    document.querySelector('input[name="address"]').value = "";
    document.querySelector('input[name="addressDetail"]').value = "";
    document.querySelector('input[name="gender"][value="male"]').checked = false;
    document.querySelector('input[name="gender"][value="female"]').checked = false;
    document.querySelector('select[name="birthYear"]').value = "";
    document.querySelector('select[name="birthMonth"]').value = "";
    document.querySelector('select[name="birthDay"]').value = "";
    document.querySelector('input[name="agreeSms"]').checked = false;
    document.querySelector('input[name="agreeEmail"]').checked = false;
    document.getElementById('profile-img').src = "/assets/img/wishlist/default_profile.png";
    // íŒŒì¼ inputë„ ë¦¬ì…‹
    const imgInput = document.getElementById('profile-img-input');
    if (imgInput) imgInput.value = "";
}

// ëª¨ë‹¬ ì—´ê¸° (ì—¬ëŸ¬ ë²„íŠ¼ ëŒ€ì‘)
document.querySelectorAll('.open-profile-edit').forEach(btn => {
    btn.addEventListener('click', async () => {
        try {
            // ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ì •ë³´ ë°›ì•„ì˜¤ê¸°
            const response = await fetch('/api/profile');
            if (!response.ok) throw new Error('íšŒì›ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');

            const member = await response.json();

            // ì„±ê³µì‹œ ê°’ ì„¸íŒ…
            if (member.success) {
                fillProfileForm(member);
            } else {
                clearProfileForm(); // ì‹¤íŒ¨ì‹œ í¼ ì´ˆê¸°í™”
                alert(member.message || "íšŒì›ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.");
            }
        } catch (e) {
            clearProfileForm(); // ì—ëŸ¬ì‹œ í¼ ì´ˆê¸°í™”
            alert(e.message);
        }

        // ëª¨ë‹¬ ë„ìš°ê³  ìŠ¤í¬ë¡¤ ë§‰ê¸°
        document.getElementById('modal-overlay-profile').style.display = 'flex';
        document.body.classList.add('modal-open');
    });
});

// ëª¨ë‹¬ ë‹«ê¸° (X ë²„íŠ¼)
document.getElementById('modal-close-profile').addEventListener('click', () => {
    document.getElementById('modal-overlay-profile').style.display = 'none';
    document.body.classList.remove('modal-open');
    clearProfileForm();
});

// ì˜¤ë²„ë ˆì´ ì˜ì—­ í´ë¦­ ì‹œ ëª¨ë‹¬ ë‹«ê¸°
document.getElementById('modal-overlay-profile').addEventListener('click', e => {
    if (e.target === e.currentTarget) {
        document.getElementById('modal-overlay-profile').style.display = 'none';
        document.body.classList.remove('modal-open');
        clearProfileForm();
    }
});
```

#### í”„ë¡œí•„ ì´ë¯¸ì§€ ê·¸ë•Œê·¸ë•Œ í¸ì§‘ ê¸°ëŠ¥
- profileImg.src.includes(DEFAULT_IMG_SRC)ë¥¼ í†µí•´ í˜„ì¬ í”„ë¡œí•„ì´ë¯¸ì§€ì˜ ì£¼ì†Œê°’ì´ ê¸°ë³¸ ì´ë¯¸ì§€ë©´ ì‚­ì œë²„íŠ¼ì„ disabledë¡œ ë§Œë“ ë‹¤.
- imgInputì€ ìˆ¨ê²¨ë‘” íŒŒì¼ ì„ íƒ íƒœê·¸ì´ê³  íŒŒì¼ì„ ì„ íƒí•˜ë©´ ë°”ë¡œ ì´ íƒœê·¸ valueê°’ìœ¼ë¡œëŠ” íŒŒì¼ì˜ ê²½ë¡œê°€ ë“¤ì–´ê°€ê³  ì‹¤ì œ íŒŒì¼ì€ imgInput.filesë¼ëŠ” FileList ê°ì²´ì— ë“¤ì–´ê°„ë‹¤.
- imgInput.click(); ìœ„ì˜ ìƒí™©ì€ ì˜†ì˜ ë©”ì„œë“œë¥¼ í†µí•´ ìˆ˜ì • ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ë²Œì–´ì§„ë‹¤.
- input type="file"ëŠ” **ë¸Œë¼ìš°ì €ê°€ íŠ¹ë³„í•˜ê²Œ êµ¬í˜„í•œ "ê°ì²´(ì˜¤ë¸Œì íŠ¸, Object)"**ì´ë©° ì¢€ ë” ì •í™•í•˜ê²ŒëŠ” HTML DOM íŠ¸ë¦¬ ì•ˆì—ì„œ "HTMLInputElement"ë¼ëŠ” í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤(ê°ì²´)ë¡œ ì¡´ì¬í•˜ê³  ì´ ê°ì²´ì•ˆì—ëŠ” ì†ì„±ìœ¼ë¡œ .files ë©”ì„œë“œì™€ íŒŒì¼ë¦¬ìŠ¤íŠ¸ë¥¼ í¬í•¨í•˜ê³  ìˆëŠ” ê²ƒì´ë‹¤.
- domì€ Document Object Modelë¡œ ì›¹ ë¸Œë¼ìš°ì €(í¬ë¡¬, ì‚¬íŒŒë¦¬, ì—£ì§€ ë“±)ê°€ HTML ì›¹í˜ì´ì§€ë¥¼ ì½ì–´ì„œ, ëª¨ë“  ìš”ì†Œ(íƒœê·¸, í…ìŠ¤íŠ¸, ì†ì„± ë“±)ë¥¼ â€œíŠ¸ë¦¬ êµ¬ì¡°â€ì˜ â€œê°ì²´â€ë¡œ ë§Œë“  ê²ƒì„ ì˜ë¯¸í•œë‹¤.
- pendingProfileImgFileì—ëŠ” ì´ë ‡ê²Œ ë°›ì€ íŒŒì¼ì„ ëŒ€ê¸°ì‹œì¼œë‘ê³  pendingProfileImgDelete ì´ê±´ ë°±ì—”ë“œê°€ íŒŒì¼ì„ ì‚­ì œí• ì§€ ì•Œë ¤ì£¼ëŠ” í”Œë˜ê·¸ë¡œ ì—…ë¡œë“œí•œ íŒŒì¼ì´ ìˆìœ¼ë©´ ì—…ë°ì´íŠ¸í•˜ë©´ë˜ë¯€ë¡œ ì´ë¥¼ falseë¡œ ë‘”ë‹¤. ì´ëŠ” ì‚¬ìš©ìê°€ ì‚­ì œë¥¼ ì§ì ‘ ëˆŒë €ì„ë•Œë§Œ ì¼œì§„ë‹¤.
- setAvatarDeleteBtnì€ ë§Œì•½ í”„ë¡œí•„ì´ë¯¸ì§€ê°€ ê¸°ë³¸ì´ë©´ ì‚­ì œ ë©”ì„œë“œë¥¼ ë¹„í™œì„±í™”ë¡œ ì´ˆê¸°í™” ì‹œì¼œì£¼ëŠ” ë©”ì„œë“œì´ë‹¤.
- reader.onload = function(ev) { ... }; : ì´ëŠ” íŒŒì¼ì´ onloadë˜ë©´ ì¦‰ ë‹¤ ì½íˆë©´ ì‹¤í–‰í•  í•¨ìˆ˜ë¥¼ ì •ì˜í•œ ê²ƒì´ê³  ì•„ë˜ì—ì„œ ì´ëŠ” ev.target.result ì¦‰ ë‹¤ ì½ì€ ê²°ê³¼ë¬¼ì„ profileImg.srcë¡œ ë§Œë“¤ì–´ ë¯¸ë¦¬ë³´ê¸°ë¥¼ ë§Œë“¤ì–´ì¤€ë‹¤.
-  reader.readAsDataURL(file); : ì´ ì„ ì–¸ì„ í†µí•´ fileì„ ë°”ë¡œ Data URL" í˜•íƒœë¡œ ì½ê²Œ ë˜ê³  ë‹¤ ì½ìœ¼ë©´ ìœ„ì˜ í•¨ìˆ˜ê°€ ì‹¤í–‰ëœë‹¤.
-  ì‚­ì œë²„íŠ¼ì€ ë¯¸ë¦¬ë³´ê¸°ë¥¼ ê¸°ë³¸ì´ë¯¸ì§€ë¡œ ë°”ê¾¸ê³  ì‚­ì œëŒ€ê¸° í”Œë˜ê·¸ë¥¼ ë‚¨ê¸´ë‹¤.
```js
// ------------------- í”„ë¡œí•„ ì´ë¯¸ì§€ í¸ì§‘ ê¸°ëŠ¥ -------------------
// í”„ë¡œí•„ ì´ë¯¸ì§€ í¸ì§‘ ê¸°ëŠ¥
const avatarEditBtn = document.getElementById('avatar-edit-btn');
const avatarMenu = document.getElementById('avatar-menu');
const editOption = document.getElementById('avatar-edit-option');
const deleteOption = document.getElementById('avatar-delete-option');
const imgInput = document.getElementById('profile-img-input');
const profileImg = document.getElementById('profile-img');

// ê¸°ë³¸ ì´ë¯¸ì§€ ê²½ë¡œ ì •ì˜
const DEFAULT_IMG_SRC = "/assets/img/wishlist/default_profile.png";

//  ì¹´ë©”ë¼ ë²„íŠ¼ í´ë¦­ â†’ íŒì˜¤ë²„ ë©”ë‰´ í‘œì‹œ
avatarEditBtn.addEventListener('click', function(e) {
    e.stopPropagation();
    avatarMenu.style.display = 'block';

    // í˜„ì¬ ì´ë¯¸ì§€ê°€ ê¸°ë³¸ì´ë¯¸ì§€ë©´ ì‚­ì œë²„íŠ¼ ë¹„í™œì„±
    if (profileImg.src.includes(DEFAULT_IMG_SRC)) {
        deleteOption.disabled = true;
    } else {
        deleteOption.disabled = false;
    }
});

// ë©”ë‰´ ë°– í´ë¦­ì‹œ ë‹«ê¸°
document.addEventListener('click', function(e) {
    // ë©”ë‰´ì™€ ë²„íŠ¼ ì™¸ì˜ ì˜ì—­ í´ë¦­ ì‹œ
    if (!avatarMenu.contains(e.target) && e.target !== avatarEditBtn) {
        avatarMenu.style.display = 'none';
    }
});

let pendingProfileImgFile = null; // ìƒˆë¡œ ì„ íƒí•œ íŒŒì¼
let pendingProfileImgDelete = false; // ì‚­ì œ ëŒ€ê¸° í”Œë˜ê·¸

// ìˆ˜ì •(ì‚¬ì§„ ë³€ê²½) ë²„íŠ¼
editOption.addEventListener('click', function() {
    imgInput.value = ""; // ì´ì „ íŒŒì¼ ì„ íƒ ë¦¬ì…‹ (ë™ì¼ íŒŒì¼ ì¬ì„ íƒ ê°€ëŠ¥)
    imgInput.click();
    avatarMenu.style.display = 'none';
});

// íŒŒì¼ ì„ íƒí•˜ë©´: ë¯¸ë¦¬ë³´ê¸°ë§Œ, ì‹¤ì œ ì—…ë¡œë“œëŠ” X
imgInput.addEventListener('change', function(e) {
    const file = e.target.files[0];
    if (!file) return;

    pendingProfileImgFile = file;
    pendingProfileImgDelete = false; // ìƒˆ íŒŒì¼ ì„ íƒ ì‹œ ì‚­ì œ ëŒ€ê¸° í•´ì œ

    // ë¯¸ë¦¬ë³´ê¸°
    const reader = new FileReader();
    reader.onload = function(ev) {
        profileImg.src = ev.target.result;
    };
    reader.readAsDataURL(file);

    setAvatarDeleteBtn();
});

// ì‚­ì œ ë²„íŠ¼: ë¯¸ë¦¬ë³´ê¸°ë§Œ ê¸°ë³¸ì´ë¯¸ì§€ë¡œ ë°”ê¿”ì£¼ê³ , ì‚­ì œ ëŒ€ê¸°
deleteOption.addEventListener('click', function() {
    if (deleteOption.disabled) return;

    pendingProfileImgFile = null;       // ìƒˆë¡œ ì—…ë¡œë“œí•  íŒŒì¼ ì—†ìŒ
    pendingProfileImgDelete = true;     // ì‚­ì œ ëŒ€ê¸° ìƒíƒœë¡œ í‘œì‹œ

    profileImg.src = DEFAULT_IMG_SRC;   // ë¯¸ë¦¬ë³´ê¸°ë§Œ

    avatarMenu.style.display = 'none';

    setAvatarDeleteBtn();
});

// ëª¨ë‹¬ ì—´ë¦´ ë•Œë§ˆë‹¤(ì •ë³´ ë¶ˆëŸ¬ì˜¬ ë•Œë§ˆë‹¤) ì‚­ì œë²„íŠ¼ ìƒíƒœ ì¬ì„¤ì •
function setAvatarDeleteBtn() {
    if (profileImg.src.includes(DEFAULT_IMG_SRC)) {
        deleteOption.disabled = true;
    } else {
        deleteOption.disabled = false;
    }
}
```
#### í”„ë¡œí•„ ì •ë³´ ìˆ˜ì •ê¸°ëŠ¥
- submit ë²„íŠ¼ì„ ëˆŒë €ì„ë•Œ í•„ìˆ˜ ê°’ë“¤ì„ ëª¨ë‘ ë³€ìˆ˜ë¡œ ê°€ì ¸ì˜¤ê³  í•˜ë‚˜ë¼ë„ ì—†ìœ¼ë©´ ì•ŒëŒì„ ë„ìš°ê³  í•¨ìˆ˜ë¥¼ ì¢…ë£Œì‹œí‚¨ë‹¤.
- ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ê±°ë‚˜ ë¹„ë°€ë²ˆí˜¸ í™•ì¸ì„ ì…ë ¥í•˜ë©´ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ìš”ì²­ì„ í–ˆë‹¤ëŠ” ê²ƒìœ¼ë¡œ ì•Œê³  ê°™ì€ ì§€ ê²€ì‚¬í•˜ì—¬ í‹€ë¦¬ë©´ ê²½ê³  ì•ŒëŒì„ ë„ìš´ë‹¤.
- í”Œë˜ê·¸ë¡œ ì§€ê¸ˆ ì „ì†¡í•œ ì‚¬ì§„ì„ ì—…ë¡œë“œí•˜ê³  ì‚­ì œë¥¼ í•˜ì§€ ì•Šì„ì§€, ê¸°ì¡´ ë°ì´í„°ë¥¼ ì‚­ì œí• ì§€, ì•„ë¬´ ë³€í™” ì—†ì„ì§€ë¥¼ ê²°ì •í•œë‹¤.
- ì„±ê³µí•˜ë©´ ìˆ˜ì •ì— ì„±ê³µí–ˆë‹¤ëŠ” ì•ŒëŒì´ ëœ¨ê³  ëª¨ë‹¬ì„ ë‹«ëŠ”ë‹¤.
- ë§ˆì§€ë§‰ìœ¼ë¡œ finally êµ¬ë¬¸ì„ í™œìš©í•˜ì—¬ ë³€ìˆ˜ê°’ë“¤ì„ ì´ˆê¸°í™”í•œë‹¤.
```js
// ------------------- í”„ë¡œí•„ ì •ë³´ ìˆ˜ì • ê¸°ëŠ¥ -------------------

document.querySelector('.confirm-btn').addEventListener('click', async function(e) {
    e.preventDefault();

    // í¼ ìˆ˜ì§‘
    const form = document.querySelector('.profile-edit-form');

    // 1. í•„ìˆ˜ê°’ ê²€ì‚¬
    const name = form.querySelector('input[name="name"]').value.trim();
    const phone = form.querySelector('input[name="phone"]').value.trim();
    const genderMale = form.querySelector('input[name="gender"][value="male"]').checked;
    const genderFemale = form.querySelector('input[name="gender"][value="female"]').checked;
    const birthYear = form.querySelector('select[name="birthYear"]').value;
    const birthMonth = form.querySelector('select[name="birthMonth"]').value;
    const birthDay = form.querySelector('select[name="birthDay"]').value;

    if (!name || !phone || (!genderMale && !genderFemale) || !birthYear || !birthMonth || !birthDay) {
        alert("í•„ìˆ˜ í•­ëª©(ì´ë¦„, ì„±ë³„, ì—°ë½ì²˜, ìƒë…„ì›”ì¼)ì„ ëª¨ë‘ ì…ë ¥í•´ ì£¼ì„¸ìš”.");
        return;
    }

    // 2. ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ìš”ì²­ ì‹œ ê²€ì‚¬
    const newPassword = form.querySelector('input[name="newPassword"]').value;
    const confirmPassword = form.querySelector('input[name="confirmPassword"]').value;

    if (newPassword || confirmPassword) { // ë‘˜ ì¤‘ í•˜ë‚˜ë¼ë„ ì…ë ¥ ì‹œ ì²´í¬
        if (!newPassword || !confirmPassword) {
            alert("ìƒˆ ë¹„ë°€ë²ˆí˜¸ì™€ ë¹„ë°€ë²ˆí˜¸ í™•ì¸ì„ ëª¨ë‘ ì…ë ¥í•´ ì£¼ì„¸ìš”.");
            return;
        }
        if (newPassword !== confirmPassword) {
            alert("ë¹„ë°€ë²ˆí˜¸ì™€ ë¹„ë°€ë²ˆí˜¸ í™•ì¸ì´ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
            return;
        }
    }

    // í¼ë°ì´í„° ì¤€ë¹„
    const formData = new FormData(form);

    // í”„ë¡œí•„ ì´ë¯¸ì§€(ìˆ˜ì •/ì‚­ì œ) ìƒíƒœ ë°˜ì˜
    if (pendingProfileImgFile) { // ìƒˆë¡œ ì„ íƒí•œ ì´ë¯¸ì§€ê°€ ìˆìœ¼ë©´
        formData.append('profileImg', pendingProfileImgFile);
        formData.append('profileImgChange', true); // ì‚­ì œëŠ” ë¬´ì‹œ
    } else if (pendingProfileImgDelete) {
        formData.append('deleteProfileImg', true); // ì‚­ì œ ëŒ€ê¸° ì¤‘ì´ë©´
    } else {
        formData.append('profileImgChange', false); // ì•„ë¬´ ë³€í™” ì—†ìŒ(ì‚¬ì§„ ê·¸ëŒ€ë¡œ)
    }

    // ì„œë²„ë¡œ ì „ì†¡
    try {
        const response = await fetch('/api/profile/update', {
            method: 'POST',
            body: formData
        });
        const result = await response.json();

        if (result.success) {
            alert("í”„ë¡œí•„ì´ ì„±ê³µì ìœ¼ë¡œ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.");
            document.getElementById('modal-overlay-profile').style.display = 'none';
            document.body.classList.remove('modal-open');

        } else {
            alert(result.message || "í”„ë¡œí•„ ìˆ˜ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
        }
    } catch (err) {
        alert('ì„œë²„ ì˜¤ë¥˜: ' + err.message);
    } finally {
        pendingProfileImgFile = null;
        pendingProfileImgDelete = false;
    }
});
```

### ğŸ“Œ 0-3. ì •ë³´ìˆ˜ì • controller
- ì—¬ëŸ¬ ì»¨íŠ¸ë¡¤ëŸ¬ ë©”ì„œë“œë¥¼ ìˆœì„œëŒ€ë¡œ ì†Œê°œí•˜ë„ë¡ í•˜ê² ë‹¤.
- ì»¨íŠ¸ë¡¤ëŸ¬ ì‘ë‹µì— result.put("timestamp", LocalDateTime.now().toString()); ë¥¼ ìºì‹±ë°©ì§€ë¥¼ ìœ„í•´ ì¶”ê°€í–ˆëŠ”ë° ì—¬ê¸°ì—ëŠ” ì•„ì§ ë°˜ì˜í•´ë‘ì§€ ì•Šì•˜ë‹¤.

#### getProfile, ì´ˆê¸° í”„ë¡œí•„ ì •ë³´ë¥¼ ìš”ì²­í• ë•Œ í”„ë¡œí•„ ì •ë³´ë¥¼ ë°˜í™˜í•´ì£¼ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬
- HttpSession sessionì„ ì„ ì–¸í•˜ë©´ ê·¸ ìˆœê°„ requestì— ì €ì¥í•´ë’€ë˜ ì„¸ì…˜ idë¥¼ í†µí•´ í•´ë‹¹ ì‚¬ìš©ìì˜ ì„¸ì…˜ê°ì²´ë¥¼ ìŠ¤í”„ë§ì´ ì£¼ì…í•´ì¤€ë‹¤.
- User userInfo = (User) session.getAttribute("memberInfo"); í•­ìƒ ì„¸ì…˜ì—ì„œ êº¼ë‚¼ë•ŒëŠ” í•´ë‹¹ ê°ì²´ê°€ object íƒ€ì…ìœ¼ë¡œ ë“±ë¡ë˜ì–´ìˆë‹¤ëŠ” ê²ƒì„ ì¸ì§€í•´ì•¼í•œë‹¤.
- ê°’ì„ ì‘ë‹µí• ë•Œ ë“±ë¡ë˜ì–´ ìˆì§€ ì•Šì€ ì •ë³´ëŠ” jsì—ì„œ í‘œì‹œí•´ì£¼ë©´ ì•ˆë˜ë¯€ë¡œ ì—†ëŠ” ì •ë³´ëŠ” í¬í•¨í•˜ì§€ ì•ŠëŠ”ë‹¤.
- ìƒë…„ì›”ì¼ì€ í•œ ë¬¸ìì—´ë¡œ -ë¡œ ë‚˜ëˆ ì ¸ì„œ dbì— ë„£ê¸°ë¡œ íŒ€ì›ë“¤ê³¼ í•©ì˜ë¥¼ ë´¤ìœ¼ë¯€ë¡œ (ì´ê²ƒë„ ë¯¸ë¦¬ ì´ì•¼ê¸° í•´ë‘ëŠ”ê²Œ ì¢‹ë‹¤.) ì´ë¥¼ ë¶„í• í•´ì„œ jsë¡œ ë³´ë‚´ì¤€ë‹¤.
- ë™ì˜ ê°’ì€ booleanìœ¼ë¡œ ì œê³µí•œë‹¤.
```java
/**
     * ì •ë³´ ìˆ˜ì • ì¹¸ì„ ì±„ìš°ê¸° ìœ„í•´ íšŒì› í”„ë¡œí•„ ì •ë³´ë¥¼ ì¡°íšŒí•˜ëŠ” API
     * @param session  í˜„ì¬ ìš”ì²­í•œ íšŒì›ì˜ ì„¸ì…˜
     * @return  íšŒì› í”„ë¡œí•„ ì •ë³´ê°€ ë‹´ê¸´ Map ê°ì²´ -> responseBodyë¡œ ë°˜í™˜
     */
    @GetMapping("/api/profile")
    @ResponseBody
    public Map<String, Object> getProfile(HttpSession session) { //ì„ ì–¸ê³¼ ë™ì‹œì— ìŠ¤í”„ë§ì´ í˜„ì¬ ì„¸ì…˜ì„ ì£¼ì…í•´ì¤Œ.
        Map<String, Object> result = new LinkedHashMap<>();

        // ì„¸ì…˜ì—ì„œ ë¡œê·¸ì¸ íšŒì› ì •ë³´ êº¼ë‚´ê¸°
        User userInfo = (User) session.getAttribute("memberInfo"); // ì„¸ì…˜ì—ì„œ memberInfo ê°ì²´ë¥¼ ê°€ì ¸ì˜´ -> íƒ€ì… ë°”ê¿”ì£¼ëŠ”ê±° ìœ ì˜
        
        if (userInfo == null) {
            result.put("success", false);
            result.put("message", "ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.");
            return result;
        }

        // DBì—ì„œ íšŒì› ìµœì‹  ì •ë³´ ì¡°íšŒ
        User userProfile = null;
        try {   
            userProfile = editService.getUserProfile(userInfo);
        } catch (Exception e) {
            result.put("success", false);
            result.put("message", "íšŒì› ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
            return result;
        }

        // ì„±ê³µì‹œ ì‘ë‹µí•  map êµ¬ì„± -> ì—†ëŠ” ì •ë³´ëŠ” ì•„ì˜ˆ ë„£ì§€ ì•ŠìŒ.
        result.put("success", true);

        // userProfileImg (í”„ë¡œí•„ ì´ë¯¸ì§€)
        if (userProfile.getUserProfileImg() != null && !userProfile.getUserProfileImg().isEmpty()) 
            // DBì— ì €ì¥ëœ ê°’ ìì²´ê°€ "/files/2024/07/01/abcd1234.jpg" -> ì›¹ì—ì„œ ë°”ë¡œ ì ‘ê·¼ ê°€ëŠ¥í•œ ê²½ë¡œ
            result.put("userProfileImg", userProfile.getUserProfileImg());
        

        // userEmail (ì´ë©”ì¼)
        if (userProfile.getUserEmail() != null && !userProfile.getUserEmail().isEmpty())
            result.put("userEmail", userProfile.getUserEmail());

        // userName (ì´ë¦„)
        if (userProfile.getUserName() != null && !userProfile.getUserName().isEmpty())
            result.put("userName", userProfile.getUserName());

        // userGender (ì„±ë³„)
        if (userProfile.getUserGender() != null && !userProfile.getUserGender().isEmpty())
            result.put("userGender", userProfile.getUserGender());

        // userPhone (ì—°ë½ì²˜)
        if (userProfile.getUserPhone() != null && !userProfile.getUserPhone().isEmpty())
            result.put("userPhone", userProfile.getUserPhone());

        // postCode (ìš°í¸ë²ˆí˜¸)
        if (userProfile.getUserPostCode() != null && !userProfile.getUserPostCode().isEmpty())
            result.put("userPostcode", userProfile.getUserPostCode());

        // userAddress (ì£¼ì†Œ)
        if (userProfile.getUserAddress() != null && !userProfile.getUserAddress().isEmpty())
            result.put("userAddress", userProfile.getUserAddress());
        
        // userSpecificAddress (ìƒì„¸ ì£¼ì†Œ)
        if (userProfile.getUserSpecificAddress() != null && !userProfile.getUserSpecificAddress().isEmpty())
            result.put("userSpecificAddress", userProfile.getUserSpecificAddress());

        // userBirthdate (ìƒë…„ì›”ì¼)
        String birthdate = userProfile.getUserBirthdate(); // ì˜ˆ: 2002-01-29
        String birthYear = "", birthMonth = "", birthDay = "";

        if (birthdate != null && !birthdate.isEmpty()) {

            String[] parts = birthdate.split("-");

            if (parts.length == 3) {
                birthYear = parts[0];
                birthMonth = parts[1];
                birthDay = parts[2];
            }
        }
        result.put("birthYear", birthYear);
        result.put("birthMonth", birthMonth);
        result.put("birthDay", birthDay);

        // smsTerm (SMS ìˆ˜ì‹  ë™ì˜, Boolean: null í—ˆìš©)
        if (userProfile.getSmsTerm() != null)
            result.put("smsTerm", userProfile.getSmsTerm());

        // emailTerm (ì´ë©”ì¼ ìˆ˜ì‹  ë™ì˜, Boolean: null í—ˆìš©)
        if (userProfile.getEmailTerm() != null)
            result.put("emailTerm", userProfile.getEmailTerm());

        return result;
    }
```

#### í”„ë¡œí•„ì„ ì—…ë°ì´íŠ¸í•˜ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬
- í”„ë¡œí•„ì„ jsì„œ ë³´ë‚¸ ì •ë³´ë¥¼ ê°€ì§€ê³  ì…ë ¥í•œë‹¤. ì´ë•Œ ìœ íš¨ì„± ê²€ì‚¬ëŠ” ë°±ì—”ë“œ ìª½ì—ì„œë„ ê°™ì´ ì´ë£¨ì–´ì ¸ì•¼ í•œë‹¤.
- í•„ìˆ˜í•­ëª©ê³¼ ê¸°ë³¸ê°’ ê²€ì‚¬ë¥¼ ì§„í–‰í•œë‹¤. ì´í›„ ì—ëŸ¬ë©”ì„¸ì§€ë¥¼ ë‹´ì•„ jsë¡œ ë¦¬í„´í•´ì¤€ë‹¤.
- ë§Œì•½ ì´ë¯¸ì§€ íŒŒì¼ì´ ë‹´ê²¨ìˆê³  ì´ë¯¸ì§€ ë°”ê¾¸ëŠ” í”Œë˜ê·¸ê°€ trueë¼ë©´ í˜„ì¬ ê°ì²´ì— ì €ì¥ëœ í”„ë¡œí•„ì´ë¯¸ì§€ ê°’ì„ ê°€ì ¸ì™€ì„œ ê·¸ê³³ìœ¼ë¡œ ê²½ë¡œë¥¼ ëš«ì–´ í•´ë‹¹ íŒŒì¼ì´ ì¡´ì¬í•˜ë©´ ìš°ì„  ì‚­ì œí•˜ê³  ì‹œì‘í•œë‹¤.
- files/ë¥¼ ë•Œë©´ ìƒëŒ€ê²½ë¡œê°€ ë˜ëŠ”ë° ì—¬ê¸°ì— ë¯¸ë¦¬ ì €ì¥í•´ë‘” ì ˆëŒ€ê²½ë¡œì¸ uploadDirì„ ë¶™ì´ë©´ ì‹¤ì œ ì»´í“¨í„°ì— í•´ë‹¹ íŒŒì¼ì´ ì €ì¥ëœ ê³³ì„ ë°”ë¡œ ì°¾ì„ ìˆ˜ ìˆë‹¤.
- ì‚­ì œê°€ ì™„ë£Œë˜ë©´ editService.saveProfileImage ë©”ì„œë“œë¥¼ ì´ìš©í•˜ì—¬ í˜„ì¬ íŒŒì¼ì„ ì €ì¥ì†Œì— ì €ì¥í•˜ê³  dbì£¼ì†Œê°’ë„ ë³€ê²½í•œë‹¤.
- ë§Œì•½ ì‚­ì œë§Œ í•´ì•¼í•œë‹¤ë©´ ìš°ì„  ê¸°ì¡´ ì •ë³´ë¥¼ ê°€ì§€ê³  íŒŒì¼ì„ ì‚­ì œí•˜ê³  ì´í›„ ê¸°ì¡´ ì •ë³´ë¥¼ ì‚­ì œí•œë‹¤.
- ì›ë˜ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ì€ ìƒë‹¹íˆ ì¤‘ìš”í•˜ë¯€ë¡œ ì‹¤íŒ¨í–ˆì„ë•Œ ë°”ë¡œ ë¡¤ë°±í•˜ê¸° ìœ„í•´ì„œ ë‹¤ë¥¸ ì •ë³´ ì²˜ë¦¬ë³´ë‹¤ ë¨¼ì € ì‹œí–‰í•œë‹¤. ë˜í•œ ë¹„ë°€ë²ˆí˜¸ëŠ” ì•”í˜¸í™”ë¡œì§ì„ ë”°ë¡œ ì ìš©í•´ì•¼í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ë¹¡ì„¸ë‹¤.
- í•˜ì—¬ ë”°ë¡œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë°”ê¾¸ê³  ë‚˜ë¨¸ì§€ë¥¼ ì•„ë˜ì—ì„œ ë”°ë¡œ ì²˜ë¦¬í•œë‹¤.
```java
    @Value("${upload.dir}")
    private String uploadDir; // íŒŒì¼ì´ ì—…ë¡œë“œ ë˜ì–´ìˆëŠ” ê²½ë¡œ


    /**
     * íšŒì› í”„ë¡œí•„ ì •ë³´ë¥¼ ìˆ˜ì •
     * @param session  í˜„ì¬ ìš”ì²­í•œ íšŒì›ì˜ ì„¸ì…˜
     * @param profileImg  í”„ë¡œí•„ ì´ë¯¸ì§€ íŒŒì¼ (ì—…ë¡œë“œ)
     * @param deleteProfileImg  í”„ë¡œí•„ ì´ë¯¸ì§€ ì‚­ì œ ì—¬ë¶€ (ì²´í¬ë°•ìŠ¤)
     * @param profileImgChange  í”„ë¡œí•„ ì´ë¯¸ì§€ ë³€ê²½ ì—¬ë¶€ (ì²´í¬ë°•ìŠ¤)
     * @param paramMap  ë‚˜ë¨¸ì§€ í”„ë¡œí•„ ì…ë ¥ ì •ë³´ (ì´ë¦„, ì—°ë½ì²˜, ì£¼ì†Œ ë“±)
     * @return  ì„±ê³µ ì—¬ë¶€ì™€ ë©”ì‹œì§€ë¥¼ ë‹´ì€ Map ê°ì²´ -> responseBodyë¡œ ë°˜í™˜
     */
    @PostMapping("/api/profile/update")
    @ResponseBody
    public Map<String, Object> updateProfile(
            HttpSession session,
            @RequestParam(value = "profileImg", required = false) MultipartFile profileImg,
            @RequestParam(value = "deleteProfileImg", required = false) Boolean deleteProfileImg,
            @RequestParam(value = "profileImgChange", required = false) Boolean profileImgChange,
            @RequestParam Map<String, String> editedMap // ëª¨ë“  ìˆ˜ì •ëœ input/select/checkbox ê°’ì´ ëª¨ì—¬ìˆìŒ.
    ) {
        Map<String, Object> result = new LinkedHashMap<>();

        // ì„¸ì…˜ ì¸ì¦
        User userInfo = (User) session.getAttribute("memberInfo");
        if (userInfo == null) {
            result.put("success", false);
            result.put("message", "ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.");
            return result;
        }

        // í•„ìˆ˜ í•­ëª© ìœ íš¨ì„± ê²€ì‚¬
        String name = editedMap.get("name");
        String phone = editedMap.get("phone");
        String gender = editedMap.get("gender");
        String birthYear = editedMap.get("birthYear");
        String birthMonth = editedMap.get("birthMonth");
        String birthDay = editedMap.get("birthDay");

        if (name == null || name.trim().isEmpty()
                || phone == null || phone.trim().isEmpty()
                || gender == null || gender.trim().isEmpty()
                || birthYear == null || birthYear.trim().isEmpty()
                || birthMonth == null || birthMonth.trim().isEmpty()
                || birthDay == null || birthDay.trim().isEmpty()) {
            result.put("success", false);
            result.put("message", "í•„ìˆ˜ í•­ëª©(ì´ë¦„, ì„±ë³„, ì—°ë½ì²˜, ìƒë…„ì›”ì¼)ì„ ëª¨ë‘ ì…ë ¥í•´ ì£¼ì„¸ìš”.");
            return result;
        }

        // ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì‹œ ì¼ì¹˜ ì—¬ë¶€ í™•ì¸
        String newPassword = editedMap.get("newPassword");
        String confirmPassword = editedMap.get("confirmPassword");

        if ((newPassword != null && !newPassword.isEmpty()) || (confirmPassword != null && !confirmPassword.isEmpty())) { // ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ì´ ìš”ì²­ëœ ê²½ìš° - ë‘˜ ì¤‘ í•˜ë‚˜ë¼ë„ ì…ë ¥ë˜ì–´ ìˆìœ¼ë©´ ìš”ì²­í•œ ê²ƒìœ¼ë¡œ ë³¸ë‹¤.
            if (newPassword == null || newPassword.isEmpty() || confirmPassword == null || confirmPassword.isEmpty()) { // ë‘˜ ì¤‘ í•˜ë‚˜ ë¹¼ë¨¹ì€ ê²½ìš°
                result.put("success", false);
                result.put("message", "ìƒˆ ë¹„ë°€ë²ˆí˜¸ì™€ ë¹„ë°€ë²ˆí˜¸ í™•ì¸ì„ ëª¨ë‘ ì…ë ¥í•´ ì£¼ì„¸ìš”.");
                return result;
            }
            if (!newPassword.equals(confirmPassword)) { // ë‘ ê°’ì´ ë‹¤ë¥¸ ê²½ìš°
                result.put("success", false);
                result.put("message", "ë¹„ë°€ë²ˆí˜¸ì™€ ë¹„ë°€ë²ˆí˜¸ í™•ì¸ì´ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
                return result;
            }
        }

        // ê¸°ì¡´ íšŒì› ì •ë³´ ì¡°íšŒ
        User userProfile;
        try {
            userProfile = editService.getUserProfile(userInfo);
        } catch (Exception e) {
            result.put("success", false);
            result.put("message", "íšŒì› ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
            return result;
        }

        // í”„ë¡œí•„ ì´ë¯¸ì§€ ì²˜ë¦¬ (ì—…ë¡œë“œ > ì‚­ì œ > ë³€ê²½ ì—†ìŒ ìˆœ)
        try {
            if (profileImg != null && !profileImg.isEmpty()) { // í”„ë¡œí•„ ì´ë¯¸ì§€ê°€ ì—…ë¡œë“œë˜ì–´ìˆë‹¤ë©´
                // ê¸°ì¡´ ì´ë¯¸ì§€ ì‚­ì œ (ìˆìœ¼ë©´)
                String orginalImgUrl = userProfile.getUserProfileImg();

                if (orginalImgUrl != null && !orginalImgUrl.isEmpty()) {

                    String relativePath = orginalImgUrl.replace("/files", "");
                    String realFilePath = uploadDir + relativePath;
                    File file = new File(realFilePath); // ê¸°ì¡´ ì´ë¯¸ì§€ê¹Œì§€ì˜ ê²½ë¡œ ëš«ì–´ë‘ 

                    if (file.exists()) 
                        file.delete();
                }

                // ìƒˆ íŒŒì¼ ì €ì¥ + DB ì—…ë°ì´íŠ¸
                String newImgUrl = editService.saveProfileImage(userInfo, profileImg); // ìƒˆ ì´ë¯¸ì§€ ì €ì¥ ë° DB update
                result.put("userProfileImg", newImgUrl);

            } else if (Boolean.TRUE.equals(deleteProfileImg)) { // deleteProfileImgì´ trueë¼ë©´ <- ë¬¸ìì—´ë¡œ ì˜¤ì§€ë§Œ ìœ„ì—ì„œ bolleanìœ¼ë¡œ ìë™ë³€í™˜ë¨.
                // ê¸°ì¡´ ì´ë¯¸ì§€ ì‚­ì œ (ìˆìœ¼ë©´)
                String orginalImgUrl = userProfile.getUserProfileImg();

                if (orginalImgUrl != null && !orginalImgUrl.isEmpty()) {

                    String relativePath = orginalImgUrl.replace("/files", "");
                    String realFilePath = uploadDir + relativePath;
                    File file = new File(realFilePath);

                    if (file.exists()) 
                        file.delete();
                }

                // DBì—ì„œ URL null ì²˜ë¦¬ = ì‚­ì œì²˜ë¦¬
                editService.deleteProfileImage(userInfo);
            }
            // else profileImgChange === falseë©´ ì•„ë¬´ ë³€í™” ì—†ìŒ

        } catch (Exception e) {
            result.put("success", false);
            result.put("message", "í”„ë¡œí•„ ì´ë¯¸ì§€ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
            return result;
        }

        // ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì²˜ë¦¬
        if (newPassword != null && !newPassword.isEmpty()) {
            // ì•”í˜¸í™” ? 
            try {
                editService.changeUserPassword(userInfo, newPassword);

            } catch (Exception e) {
                result.put("success", false);
                result.put("message", "ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
                return result;
            }
        }

        // ë‚˜ë¨¸ì§€ í”„ë¡œí•„ ì •ë³´ ì—…ë°ì´íŠ¸
        try {

            editService.updateUserProfile(userInfo, editedMap);

        } catch (Exception e) {
            result.put("success", false);
            result.put("message", "íšŒì› ì •ë³´ ìˆ˜ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
            return result;
        }

        result.put("success", true);
        result.put("message", "í”„ë¡œí•„ì´ ì„±ê³µì ìœ¼ë¡œ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.");
        return result;
    }
```

#### ì •ë³´ìˆ˜ì • impl
- ë‚˜ë¨¸ì§€ implì€ ì¼ë°˜ì ì¸ get, post, put, deleteì´ë¯€ë¡œ ì—¬ê¸°ì„œëŠ” ë¡œì§ì´ ë§ì€ ë©”ì„œë“œë§Œ ë‹¤ë£¬ë‹¤.

#### ìœ ì € í”„ë¡œí•„ ì—…ë°ì´íŠ¸ ì„œë¹„ìŠ¤
- í•´ë‹¹ ë¬¸ìì—´ì´ ë¹„ì–´ìˆëŠ”ì§€ë¥¼ ê²€ì‚¬í•˜ëŠ” ë©”ì„œë“œë¥¼ ë”°ë¡œ ì •ì˜í•˜ì—¬ ì´ì¤‘ ì ê²€í•´ì£¼ë©´ ì¢‹ë‹¤.
- ìš°ì„  dbì—ë„ ê°’ì´ ìˆì„ë•Œë§Œ ê°’ì„ ì „ë‹¬í•´ì£¼ëŠ”ê²Œ ë§ê¸° ë•Œë¬¸ì— ì´ë¥¼ ìœ ì € ê°ì²´ì— ê±¸ëŸ¬ì„œ ë„£ì–´ì£¼ëŠ” ì‘ì—…ì„ í•œë‹¤.
- ì•„ì´ë””ëŠ” ì„¸ì…˜ê°ì²´ì—ì„œ ê°€ì ¸ì˜¨ë‹¤.
- ìƒë…„ì›”ì¼ì€ ì•½ì†ëœëŒ€ë¡œ -ë¡œ ì´ì–´ì„œ ë¶™ì—¬ ì „ë‹¬í•´ì¤€ë‹¤.
```java
// isEmpty ë©”ì„œë“œ: ë¬¸ìì—´ì´ ë¹„ì–´ìˆëŠ”ì§€ í™•ì¸
    private boolean isEmpty(String s) {
        return s == null || s.trim().isEmpty();
    }
/**
     * íšŒì› í”„ë¡œí•„ì„ ìˆ˜ì •í•˜ëŠ” ë©”ì„œë“œ êµ¬í˜„ì²´
     * @param user ì„¸ì…˜ì—ì„œ ê°€ì ¸ì˜¨ User ê°ì²´
     * @param editedMap ìˆ˜ì •í•  íšŒì› ì •ë³´ê°€ ë‹´ê¸´ Map ê°ì²´
     * @throws Exception íšŒì› ì •ë³´ ìˆ˜ì • ì‹¤íŒ¨ ì‹œ ì˜ˆì™¸ ë°œìƒ
     */
    @Transactional
    @Override
    public void updateUserProfile(User user, Map<String, String> editedMap) throws Exception {
        // ê¸°ì¡´ User ê°ì²´ idë¥¼ ì´ìš©í•˜ì—¬ ì—…ë°ì´íŠ¸í•  User ê°ì²´ ìƒì„±
        User updatedUser = new User();
        updatedUser.setUserId(user.getUserId()); // PK

        // ê°’ì´ ìˆì„ ë•Œë§Œ ì„¸íŒ…
        // ì´ë¦„
        if (editedMap.containsKey("name") && !isEmpty(editedMap.get("name")))
            updatedUser.setUserName(editedMap.get("name"));

        // íœ´ëŒ€í°
        if (editedMap.containsKey("phone") && !isEmpty(editedMap.get("phone")))
            updatedUser.setUserPhone(editedMap.get("phone"));

        // ì„±ë³„
        if (editedMap.containsKey("gender") && !isEmpty(editedMap.get("gender")))
            updatedUser.setUserGender(editedMap.get("gender"));

        // ìš°í¸ë²ˆí˜¸
        if (editedMap.containsKey("postcode") && !isEmpty(editedMap.get("postcode")))
            updatedUser.setUserPostCode(editedMap.get("postcode"));

        // ì£¼ì†Œ
        if (editedMap.containsKey("address") && !isEmpty(editedMap.get("address")))
            updatedUser.setUserAddress(editedMap.get("address"));

        // ìƒì„¸ì£¼ì†Œ
        if (editedMap.containsKey("addressDetail") && !isEmpty(editedMap.get("addressDetail")))
            updatedUser.setUserSpecificAddress(editedMap.get("addressDetail"));

        // ìƒë…„ì›”ì¼
        String year = editedMap.get("birthYear");
        String month = editedMap.get("birthMonth");
        String day = editedMap.get("birthDay");
        if (!isEmpty(year) && !isEmpty(month) && !isEmpty(day)) {
            String birthdate = String.format("%s-%s-%s", year, month, day);
            updatedUser.setUserBirthdate(birthdate);
        }

        // SMS ë™ì˜ ì—¬ë¶€
        if (editedMap.containsKey("agreeSms"))
            updatedUser.setSmsTerm("true".equals(editedMap.get("agreeSms")) || "on".equals(editedMap.get("agreeSms")));

        // ì´ë©”ì¼ ë™ì˜ ì—¬ë¶€
        if (editedMap.containsKey("agreeEmail"))
            updatedUser.setEmailTerm("true".equals(editedMap.get("agreeEmail")) || "on".equals(editedMap.get("agreeEmail")));

        try {
            int updatedCount = userMapper.updateUserProfile(updatedUser);
            if (updatedCount == 0) {
                throw new Exception("íšŒì› ì •ë³´ ìˆ˜ì • ëŒ€ìƒì´ ì—†ìŠµë‹ˆë‹¤.");
            }
        } catch (Exception e) {
            log.error("íšŒì› ì •ë³´ ìˆ˜ì • ì‹¤íŒ¨: {}", e.getMessage());
            throw e;
        }
    }
```

#### ì´ë¯¸ì§€ íŒŒì¼ì„ dbì™€ ì‹¤ì œ íŒŒì¼ì— ì—…ë¡œë“œí•˜ëŠ” ë©”ì„œë“œ
- ìš°ì„  @Valueë¡œ ë‚´ ì‘ì—… ê³µê°„ì— ì¡´ì¬í•˜ëŠ” ì´ë¯¸ì§€ íŒŒì¼ì˜ ê²½ë¡œë¥¼ ê°€ì ¸ì˜¨ë‹¤.
- ì‚­ì œê°€ ìˆëŠ” ì‘ì—…ë“¤ì€ ìœ„í—˜í•˜ë¯€ë¡œ @Transactionalì„ ê±¸ì–´ì¤€ë‹¤.
- jsì—ì„œ ì „ë‹¬ëœ íŒŒì¼ê°ì²´ì˜ ì›ë³¸ íŒŒì¼ëª…ì„ ê°€ì ¸ì™€ì„œ í™•ì¥ìë¥¼ ë–¼ì—ˆë‹¤ê°€ UUID.randomUUID().toString()ìœ¼ë¡œ ìœ ë‹ˆí¬í•œ ì´ë¦„ì„ ìƒˆë¡œ ë§Œë“¤ì–´ì„œ ë‹¤ì‹œ í™•ì¥ìë¥¼ ë¶™ì—¬ë‘”ë‹¤.
- ë˜ í•´ë‹¹ íŒŒì¼ì„ ìƒì„±ëœ ë‚ ì§œë³„ í´ë”ë“¤ë¡œ êµ¬ì¡°í™”í•˜ì—¬ ê·¸ê³³ì— mkdirsë¡œ íŒŒì¼ ê²½ë¡œë¥¼ ëš«ì–´ë‘ê³  String savedFilePath = saveDir + "/" + uniqueName; ì´ ê²½ë¡œë¡œ profileImg.transferTo(new File(savedFilePath));ë¥¼ í†µí•´ íŒŒì¼ ê°ì²´ì˜ ì •ë³´ë¥¼ ë“¤ì´ë¶“ëŠ”ë‹¤.
- ì´í›„ ì›¹ì—ì„œ ì ‘ê·¼í•  urlì¸ String fileUrl = uploadUrl + folderPath + "/" + uniqueName;ì„ ë§Œë“¤ì–´ì„œ (uploadUrlì´ëŠ” ì›¹ì—ì„œ ë¯¸ë¦¬ ì°¾ì„ ìˆ˜ ìˆë„ë¡ í•´ë‘” ê°’) dbì— ì €ì¥í•´ë‘”ë‹¤.
```java
    @Value("${upload.dir}")
    private String uploadDir; // íŒŒì¼ ì—…ë¡œë“œë˜ëŠ” ê²½ë¡œ

    @Value("${upload.url}")
    private String uploadUrl; // ë¸Œë¼ìš°ì €ì˜ íŒŒì¼ ì ‘ê·¼ URL

    /**
     * í”„ë¡œí•„ ì´ë¯¸ì§€ íŒŒì¼ì„ ì €ì¥í•˜ê³ , DBì— urlì„ ì—…ë°ì´íŠ¸í•œë‹¤.
     * @return ì €ì¥ëœ ì´ë¯¸ì§€ì˜ ì›¹ ì ‘ê·¼ url
     */
    @Transactional
    @Override
    public String saveProfileImage(User user, MultipartFile profileImg) throws Exception {
        // íŒŒì¼ëª…/í™•ì¥ì ì¶”ì¶œ ë° ì—…ë¡œë“œ ê²½ë¡œ ìƒì„±
        String originalName = profileImg.getOriginalFilename(); // ì›ë³¸ íŒŒì¼ëª…
        if (originalName == null || originalName.isEmpty()) throw new Exception("íŒŒì¼ì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.");

        String ext = originalName.substring(originalName.lastIndexOf("."));
        String uniqueName = UUID.randomUUID().toString().replace("-", "") + ext;

        // ë‚ ì§œë³„ í´ë”ë¡œ êµ¬ì¡°í™”
        Calendar c = Calendar.getInstance();
        String folderPath = String.format("/%04d/%02d/%02d", c.get(Calendar.YEAR), c.get(Calendar.MONTH) + 1, c.get(Calendar.DAY_OF_MONTH));
        String saveDir = uploadDir + folderPath;

        File dir = new File(saveDir);
        if (!dir.exists()) 
            dir.mkdirs(); // ë””ë ‰í† ë¦¬ê°€ ì—†ìœ¼ë©´ ìƒì„±

        String savedFilePath = saveDir + "/" + uniqueName;
        // ì‹¤ì œ íŒŒì¼ ì €ì¥
        profileImg.transferTo(new File(savedFilePath));

        // ì›¹ì—ì„œ ì ‘ê·¼í•  url
        String fileUrl = uploadUrl + folderPath + "/" + uniqueName;

        User userInfo = new User();
        userInfo.setUserId(user.getUserId());
        userInfo.setUserProfileImg(fileUrl); // í”„ë¡œí•„ ì´ë¯¸ì§€ URL ì„¤ì •

        // DBì— í”„ë¡œí•„ ì´ë¯¸ì§€ URL ì—…ë°ì´íŠ¸
        try {
            int updated = userMapper.updateProfileImgUrl(userInfo);

            // DB ì—…ë°ì´íŠ¸ ê²°ê³¼ í™•ì¸
            if (updated == 0) {
                throw new Exception("DBì— í”„ë¡œí•„ ì´ë¯¸ì§€ URL ì €ì¥ ì‹¤íŒ¨");
            }
        } catch (Exception e) {
            log.error("í”„ë¡œí•„ ì´ë¯¸ì§€ URL ì—…ë°ì´íŠ¸ ì‹¤íŒ¨: {}", e.getMessage());
            throw e;
        }

        return fileUrl;
    }
```

### ğŸ“Œ 0-4. ì •ë³´ìˆ˜ì • mapper
- mapperëŠ” ë»”í•´ì„œ í•˜ë‚˜ë§Œ ë³´ë„ë¡ í•˜ê² ë‹¤. í”„ë¡œí•„ì„ ì—…ë°ì´íŠ¸í• ë•Œ ì¡°ê±´ë¶€ë¡œ ê°’ì´ ì¡´ì¬í•˜ëŠ” ê²½ìš°ì—ë§Œ ê°’ì„ ì—…ë°ì´íŠ¸í•œë‹¤.
- ê·¸ë¦¬ê³  ë§ˆì§€ë§‰ìœ¼ë¡œ ìˆ˜ì •ì¼ìë¥¼ í˜„ì¬ ì‹œê°„ìœ¼ë¡œ ì±„ì›Œì£¼ì–´ì•¼í•œë‹¤.
```java
@Update("<script>"
        + "UPDATE users "
        + "<set>"
        + "<if test='userName != null'>user_name = #{userName},</if>"
        + "<if test='userPhone != null'>user_phone = #{userPhone},</if>"
        + "<if test='userGender != null'>user_gender = #{userGender},</if>"
        + "<if test='userPostCode != null'>user_post_code = #{userPostCode},</if>"
        + "<if test='userAddress != null'>user_address = #{userAddress},</if>"
        + "<if test='userSpecificAddress != null'>user_specific_address = #{userSpecificAddress},</if>"
        + "<if test='userBirthdate != null'>user_birthdate = #{userBirthdate},</if>"
        + "<if test='smsTerm != null'>sms_term = #{smsTerm},</if>"
        + "<if test='emailTerm != null'>email_term = #{emailTerm},</if>"
        + "edit_date = NOW()"
        + "</set>"
        + "WHERE user_id = #{userId}"
        + "</script>")
    int updateUserProfile(User userInfo) throws Exception;
```

# ğŸ“Œ 1. rest ful - department
### ğŸ“Œ 1-1. ë¸Œë¼ìš°ì € ìºì‹œ ë°©ì§€ë¥¼ ìœ„í•´ íƒ€ì„ìŠ¤íƒ¬í”„ ì‘ë‹µì— íƒ€ì„ ìŠ¤íƒ¬í”„ ì¶”ê°€
- ë¸Œë¼ìš°ì €ëŠ” ì›¹ì‚¬ì´íŠ¸ì— í•œ ë²ˆ ìš”ì²­í•´ì„œ ë°›ì€ ë°ì´í„°(HTML, JS, CSS, ì´ë¯¸ì§€, API ì‘ë‹µ ë“±)ë¥¼ ì„ì‹œë¡œ ì €ì¥(ìºì‹±) í•´ë‘”ë‹¤.
- ì™œëƒë©´, ê°™ì€ ìš”ì²­ì„ ë˜ ë³´ë‚¼ ë•Œ ì„œë²„ë¡œë¶€í„° ë§¤ë²ˆ ìƒˆë¡œ ë°›ì•„ì˜¤ë©´ ëŠë¦¬ê¸° ë•Œë¬¸ì— ì´ì „ì— ë°›ì€ ê²°ê³¼ë¥¼ ì¬ì‚¬ìš©í•´ì„œ ì†ë„ë¥¼ ë†’ì´ê³  íŠ¸ë˜í”½ì„ ì¤„ì¸ë‹¤.
- ì´ëŸ° ì¼ì€ apiìš”ì²­ì—ì„œë„ ì ìš©ë˜ëŠ”ë° ë¸Œë¼ìš°ì €ê°€ ë©‹ëŒ€ë¡œ ì´ì „ê³¼ ê°™ì€ ì‘ë‹µì´ë¼ê³  íŒë‹¨í•˜ë©´ ì´ì „ì— ë°›ì€ ê²°ê³¼ë¥¼ ê·¸ëƒ¥ ì¬ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
- ì´ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ ë§¤ë²ˆ ì•„ë˜ì²˜ëŸ¼ íƒ€ì„ìŠ¤íƒ¬í”„ë¥¼ ì¶”ê°€í•´ì„œ ë§¤ë²ˆì˜ ìš”ì²­ì„ ë‹¤ë¥¸ ìš”ì²­ì´ë¼ê³  ë¸Œë¼ìš°ì €ê°€ ì¸ì‹í•˜ë„ë¡ í•  í•„ìš”ê°€ ìˆë‹¤.
- ë˜ ë¡œê·¸ë¥¼ í™•ì¸í• ë•Œ ìœ ìš©í•œ ì´ì ì´ ìˆë‹¤.
```java
result.put("timestamp", LocalDateTime.now().toString());
```

### ğŸ“Œ 1-2.  HTTP ìƒíƒœì½”ë“œëŠ” í•­ìƒ HTTP ì‘ë‹µì˜ "í—¤ë”"ì— í¬í•¨ë˜ì–´ ì „ì†¡ëœë‹¤
- HTTP í†µì‹  êµ¬ì¡°ì—ì„œ ì„œë²„ê°€ ì‘ë‹µì„ ë³´ë‚¼ ë•Œ, í•­ìƒ HTTP ìƒíƒœ ì½”ë“œ (ì˜ˆ: 200, 404, 500 ë“±), í—¤ë”(header), ë³¸ë¬¸(body, ì˜ˆ: HTML, JSON) ì´ ìˆœì„œë¡œ ë¸Œë¼ìš°ì €(í´ë¼ì´ì–¸íŠ¸)ì—ê²Œ ì‘ë‹µì„ ë³´ë‚¸ë‹¤.
- ë˜ ìŠ¤í”„ë§ì€ ê¸°ë³¸ì ìœ¼ë¡œ 200 OKë¥¼ ìƒíƒœ ì½”ë“œë¡œ ì‘ë‹µí•˜ë©° ì˜ˆì™¸ ë°œìƒ ì‹œ 500, ë¦¬ì†ŒìŠ¤ ì—†ìœ¼ë©´ 404 ë“± í”„ë ˆì„ì›Œí¬ê°€ ìë™ìœ¼ë¡œ ì ì ˆíˆ ì‘ë‹µí•œë‹¤.
- ë°›ëŠ” ìª½ì—ì„œëŠ” ì•„ë˜ì²˜ëŸ¼ ìƒíƒœì½”ë“œë¡œ í•  ìˆ˜ ìˆë‹¤.
```java
fetch('/api').then(res => {
  console.log(res.status); // 200, 404, 500 ë“±
});
```

### ğŸ“Œ 1-3. printStackTrace()ë¥¼ ë¬¸ìë¡œ ë³´ë‚´ê¸°
- ì•„ë˜ì™€ ê°™ì€ ì½”ë“œëŠ” ë°±ì—”ë“œì—ì„œ ì—ëŸ¬ê°€ ë°œìƒí–ˆì„ë•Œ printStackTrace() ì¦‰ ì—ëŸ¬ê°€ ë°œìƒí•œ êµ¬ì²´ì  ê²½ë¡œë¥¼ í”„ë¡ íŠ¸ì—”ë“œì—ë„ ê³µìœ í•´ì£¼ê¸° ìœ„í•œ ì˜ë„ì´ë‹¤.
- error í‚¤ì— ì—ëŸ¬ì˜ ì´ë¦„ì„ ë¬¸ìì—´ë¡œ ì €ì¥í•˜ê³  message í‚¤ì— error ë©”ì„¸ì§€ë¥¼ ì¶”ê°€í•œë‹¤.
- ì´ë•Œ new ByteArrayOutputStream()ëŠ” ë©”ëª¨ë¦¬ ìƒì— ë°”ì´íŠ¸ ë°°ì—´ ì¦‰ ê·¸ë¦‡ì„ ë§Œë“¤ì–´ë†“ëŠ” ì—­í• ì„ í•˜ê³  
- PrintStream ps = new PrintStream(bos);ì€ ë°ì´í„° ìŠ¤íŠ¸ë¦¼ì˜ íë¦„ì„ ì½˜ì†”ì´ ì•„ë‹Œ ê·¸ë¦‡ìœ¼ë¡œ ì´ì–´ì£¼ëŠ” íŒŒì´í”„ì—­í• ì„ í•œë‹¤.
- ê·¸ë¦¬ê³  printStackTraceì— psë¡œ ê²½ë¡œë¥¼ ì§€ì •í•´ì£¼ë©´ ì½˜ì†”ì´ ì•„ë‹Œ ê·¸ë¦‡ìœ¼ë¡œ stackTraceê°€ printë˜ê²Œ ëœë‹¤.
- ì´ë ‡ê²Œ ë‹´ì•„ì§„ ê·¸ë¦‡ì„ stringìœ¼ë¡œ ë°”ê¾¸ì–´ ê²½ë¡œì— ì¶”ê°€í•˜ì—¬ ì „ë‹¬í•˜ëŠ” ê²ƒì´ë‹¤.
```java
// errorê°€ ì „ë‹¬ë˜ì—ˆë‹¤ë©´ resultì— í¬í•¨í•œë‹¤.
        if (error != null) {
            result.put("error", error.getClass().getName());
            result.put("message", error.getMessage());

            // printStackTrace()ì˜ í˜¸ì¶œ ë‚´ìš©ì„ ë¬¸ìë¡œë„ ë°˜í™˜í•œë‹¤.
            ByteArrayOutputStream bos = new ByteArrayOutputStream();
            PrintStream ps = new PrintStream(bos);
            error.printStackTrace(ps);

            String trace = bos.toString();
            result.put("trace", trace);
        }
```

