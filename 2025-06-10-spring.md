# ğŸ“Œ 0. ëŒ€í™”
### ğŸ“Œ 0-1. DBêµ¬ì¡°ì—ì„œ ON DELETE SET NULLì— ëŒ€í•˜ì—¬
- ì•„ë˜ì™€ ê°™ì´ ì™¸ë˜í‚¤ë¥¼ ì„¤ì •í• ë•Œ ì™¸ë˜í‚¤ë¡œ ê°€ì ¸ì˜¨ ë¶€ëª¨ ì¦‰ product_colorì—ì„œ í•´ë‹¹ ì•„ì´ë””ê°€ ì‚­ì œë˜ë„ ì´ë¥¼ nullë¡œ ë°”ê¿€ ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ON DELETE SET NULL ì˜µì…˜ì„ ê±¸ ìˆ˜ ìˆë‹¤.
- ìš°ì„  ì´ì „ì— ì´ ì™¸ë˜í‚¤ë¥¼ notnullë¡œ ì§€ì •í•˜ë©´ ì•ˆëœë‹¤.
- ì´ ì˜µì…˜ì´ ë‹¤ë¥¸ dbì—ì„œ ì‘ë™í•˜ì§€ ì•Šì•„ í™•ì¥ì„±ì— ìš°ë ¤ê°€ ìˆë‹¤ëŠ” ë§ì´ ë§ì•˜ëŠ”ë° ì‚¬ì‹¤ â€œON DELETE SET NULLâ€ ì˜µì…˜ì€ í‘œì¤€ SQLë¡œ ê±°ì˜ ëª¨ë“  ë©”ì´ì € RDBMSì—ì„œ ì§€ì›í•˜ê¸° ë•Œë¬¸ì— ì´ëŸ° ê±±ì •ì€ ì—†ëŠ” ì‹¤ì •ì¸ ê²ƒ ê°™ë‹¤.
- ë‹¤ë§Œ, **ì™¸ë˜í‚¤ë¡œ ì§€ì •ëœ ì»¬ëŸ¼ì´ NULL í—ˆìš©(Nullable)**ì´ì–´ì•¼ë§Œ ì •ìƒ ë™ì‘í•œë‹¤ëŠ” ì ì„ ì‹¤ë¬´ì—ì„œ ë” ë§ì´ ë†“ì¹˜ê¸° ë•Œë¬¸ì— ì´ë¥¼ ì£¼ì˜í•˜ëŠ” ê²ƒì´ ë” ì¢‹ì„ ê²ƒ ê°™ë‹¤.
- ë˜ ì´ì‹ì„±ì— ë¬¸ì œê°€ ìƒê¸¸ ìˆ˜ ìˆëŠ” ê²½ìš°ëŠ” ì•„ì˜ˆ íšŒì‚¬ê°€ ì´ fkë¥¼ ì“°ì§€ ì•Šê¸°ë¡œ í•˜ëŠ” ê²½ìš°ê°€ ë  ìˆ˜ ìˆë‹¤.
```sql
ALTER TABLE product_image
ADD CONSTRAINT fk_color
FOREIGN KEY (color_id)
REFERENCES product_color(color_id)
ON DELETE SET NULL;
```

# ğŸ“Œ 1. ì™¸ë˜í‚¤ ì‚­ì œ ì—…ë°ì´íŠ¸ë¡œ ë°”ê¾¸ê¸°
- ê¸°ì¡´ì— ì‚­ì œí• ë•ŒëŠ” ì—°ì‡„ì ìœ¼ë¡œ ì „ë¶€ ì‚­ì œí•´ì•¼ í–ˆì§€ë§Œ ì´ì œ ê·¸ëƒ¥ ì§ì ‘ ê´€ë ¨ëœ ê²ƒë§Œ nullë¡œ ë°”ê¾¸ë©´ ë˜ë¯€ë¡œ ê·¸ë ‡ê²Œ ì§„í–‰í•˜ì˜€ë‹¤.
- ìœ„ì™€ ê°™ì´ í•´ë„ ë˜ëŠ” ì´ìœ ëŠ” ì§€ë„êµìˆ˜ê°€ ìˆ˜ê°•í•˜ëŠ” ê³¼ëª©ì—ì„œ ì§€ë„êµìˆ˜ ì´ë¦„ì´ nullì´ ë˜ì–´ë„ ê³¼ëª©ì´ ì—†ì–´ì§€ì§€ëŠ” ì•Šê¸° ë•Œë¬¸ì— ìˆ˜ê°•ì‹ ì²­ì— ìˆëŠ” ê³¼ëª©ì„ ì‚­ì œí•  í•„ìš”ê°€ ì—†ëŠ” ê²ƒì´ë‹¤.
- ì¿¼ë¦¬ ì‚¬ì´ì— ë„ì–´ì“°ê¸° ë„£ëŠ” ê²ƒì„ ìœ ì˜í•´ì•¼ í•œë‹¤. 
- nullì€ ëŒ€ë¬¸ì NULLë¡œ í‘œê¸°í•œë‹¤.
- ì•„ë˜ëŠ” ê¸°ì¡´ì˜ ì½”ë“œì´ë‹¤.
```java
@Override
    public int deleteItem(Professor params) throws ServiceNoResultException, Exception {
        int professorskey = params.getId();

        Student student1 = new Student();
        student1.setProfessorId(professorskey);

        Subject subject1 = new Subject();
        subject1.setProfessorId(professorskey);
        
        
        
        // êµìˆ˜ê°€ ë‹´ë‹¹í•˜ëŠ” ê³¼ëª©ì˜ ìˆ˜ê°•ì‹ ì²­ ë‚´ì—­ ì‚­ì œ , êµìˆ˜ì˜ ì§€ë„í•™ìƒì´ ë“£ëŠ” ìˆ˜ê°•ì‹ ì²­ ë‚´ì—­ ì‚­ì œ
        enrollmentMapper.deleteByStudentIdForProfessor(student1);
        // êµìˆ˜ê°€ ë‹´ë‹¹í•˜ëŠ” ê³¼ëª©ì„ ìˆ˜ê°•í•˜ëŠ” í•™ìƒì´ê±°ë‚˜ êµìˆ˜ì˜ ì§€ë„í•™ìƒ ì‚­ì œ
        studentMapper.deleteByProfessorId(student1);
        // êµìˆ˜ê°€ ë‹´ë‹¹í•˜ëŠ” ê³¼ëª© ì‚­ì œ
        subjectMapper.deleteByProfessorIdForProfessor(subject1);
        // êµìˆ˜ ì‚­ì œ
        int output = professorMapper.delete(params);

        if (output == 0){
            throw new ServiceNoResultException("ì •ìƒì ìœ¼ë¡œ ì²˜ë¦¬ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");
        }

        return output;
    }
```
- ì•„ë˜ëŠ” ìˆ˜ì •ëœ ì½”ë“œì´ë‹¤.
```java
@Override
    public int deleteItem(Professor params) throws ServiceNoResultException, Exception {
        int professorskey = params.getId();

        Student student1 = new Student();
        student1.setProfessorId(professorskey);

        Subject subject1 = new Subject();
        subject1.setProfessorId(professorskey);
        
        
        // êµìˆ˜ì˜ ì§€ë„í•™ìƒì˜ ì§€ë„êµìˆ˜ ëª…ë‹¨ì„ nullë¡œ ë°”ê¿ˆ
        studentMapper.updateByprofessorId(student1);
        // êµìˆ˜ê°€ ë‹´ë‹¹í•˜ëŠ” ê³¼ëª©ì˜ êµìˆ˜ëª…ì„ nullë¡œ ë³€ê²½
        subjectMapper.updateByprofessor(subject1);
        // êµìˆ˜ ì‚­ì œ
        int output = professorMapper.delete(params);

        if (output == 0){
            throw new ServiceNoResultException("ì •ìƒì ìœ¼ë¡œ ì²˜ë¦¬ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");
        }

        return output;
    }
```
- ì•„ë˜ëŠ” subjectmapperì™€ studentmapperë¥¼ ìˆ˜ì •í•œ ê²ƒì´ë‹¤.
```java
// íŠ¹ì • êµìˆ˜ê°€ ê°€ë¥´ì¹˜ëŠ” ê³¼ëª© ì¼ê´„ nullì²˜ë¦¬
    @Update ("update subjects set " +
            "professor_id = NULL " +
            "where professor_id = #{professorId}")
    public int updateByprofessor(Subject subject);
```
```java
// íŠ¹ì • êµìˆ˜ê°€ ì§€ë„êµìˆ˜ì¸ í•™ìƒì˜ ì§€ë„êµìˆ˜ë¥¼ nullë¡œ ë°”ê¾¸ê¸°
    @Update("update students set "+
            "professor_id = NULL " + 
            "where professor_id = #{professorId}")
    public int updateByprofessorId(Student student);
```

# ğŸ“Œ 2. mappers í…ŒìŠ¤íŠ¸
- ìƒˆë¡œ ë§Œë“  studentMapperê°€ ì˜ ì‘ë™í•˜ëŠ”ì§€ ì„œë¹„ìŠ¤ë¥¼ êµ¬í˜„í•˜ê¸° ì „ ë¨¼ì € ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•œë‹¤.
- Mapperì— ì •ì˜ëœ ë©”ì„œë“œ ë³„ë¡œ ì˜ˆì‹œë¥¼ ë§Œë“¤ì–´ì„œ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ êµ¬í˜„í•œë‹¤.
- junit í…ŒìŠ¤íŠ¸ ë„êµ¬ì˜ Assertionsë¥¼ ì´ìš©í•˜ë©´ ì •í™•íˆ ë‚´ê°€ ì›í•˜ëŠ” ê°’ì´ ë§ëŠ”ì§€ í…ŒìŠ¤íŠ¸ í•´ë³¼ ìˆ˜ ìˆë‹¤.
- ì•„ë˜ì™€ ê°™ì€ ì¢…ë¥˜ë“¤ë„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
- Assertions.assertEquals(1, output, "í•™ìƒ ìˆ˜ì •ì€ 1ê±´ì´ì–´ì•¼ í•œë‹¤");
- Assertions.assertNotNull(output, "í•™ìƒì´ ì¡´ì¬í•´ì•¼ í•œë‹¤");
- Assertions.assertTrue(output >= 0, "í•™ìƒ ì¹´ìš´íŠ¸ëŠ” 0 ì´ìƒì´ì–´ì•¼ í•œë‹¤");
- ì‚­ì œí•˜ë¼ê³  í–ˆëŠ”ë° ì‚­ì œí• ê²Œ ì—†ìœ¼ë©´ êµ³ì´ ì—ëŸ¬ê°€ ë‚˜ì§€ ì•ŠëŠ”ë‹¤.
```java
@Slf4j
@SpringBootTest
public class StudentMapperTest {

    @Autowired
    private StudentMapper studentMapper;

    @Test
    @DisplayName("í•™ìƒ ì¶”ê°€ í…ŒìŠ¤íŠ¸")
    @Transactional
    void insertStudent() {
        Student input = new Student();
        input.setName("í™ê¸¸ë™");
        input.setUserId("hong123");
        input.setGrade(1);
        input.setIdnum("990101-1234567");
        input.setBirthdate("1999-01-01");
        input.setPhone("010-1234-5678");
        input.setHeight(175);
        input.setWeight(70);
        input.setEmail("hong@myschool.ac.kr");
        input.setGender("ë‚¨");
        input.setStatus("ì¬í•™");
        input.setPhotoUrl("https://photo.myschool.ac.kr/hong.jpg");
        input.setAdmissionDate("2018-03-01");
        input.setGraduationDate(null);
        input.setDepartmentId(101);
        input.setProfessorId(9931);

        int output = studentMapper.insert(input);

        // Assertion ì¶”ê°€
        Assertions.assertEquals(1, output, "í•™ìƒ ì¶”ê°€ëŠ” 1ê±´ì´ì–´ì•¼ í•œë‹¤");
        Assertions.assertNotNull(input.getId(), "í•™ìƒì˜ PK(id)ëŠ” nullì´ ì•„ë‹ˆì–´ì•¼ í•œë‹¤");

        log.debug("ì €ì¥ëœ ë°ì´í„°ì˜ ìˆ˜ : " + output);
        log.debug("ìƒì„±ëœ Primary Key : " + input.getId());
    }

    @Test
    @DisplayName("í•™ìƒ ìˆ˜ì • í…ŒìŠ¤íŠ¸")
    @Transactional
    void updateStudent() {
        Student input = new Student();
        input.setId(10121); 
        input.setName("í™ê¸¸ë™(ìˆ˜ì •)");
        input.setUserId("hong1234");
        input.setGrade(2);
        input.setIdnum("990101-1234567");
        input.setBirthdate("1999-01-01");
        input.setPhone("010-1234-5678");
        input.setHeight(176);
        input.setWeight(71);
        input.setEmail("hong2@myschool.ac.kr");
        input.setGender("ë‚¨");
        input.setStatus("íœ´í•™");
        input.setPhotoUrl("https://photo.myschool.ac.kr/hong2.jpg");
        input.setAdmissionDate("2018-03-01");
        input.setGraduationDate(null);
        input.setDepartmentId(101);
        input.setProfessorId(9931);

        int output = studentMapper.update(input);

        // Assertion ì¶”ê°€
        Assertions.assertEquals(1, output, "í•™ìƒ ìˆ˜ì •ì€ 1ê±´ì´ì–´ì•¼ í•œë‹¤");

        log.debug("ìˆ˜ì •ëœ ë°ì´í„°ì˜ ìˆ˜ : " + output);
    }

    @Test
    @DisplayName("í•™ìƒ ì‚­ì œ í…ŒìŠ¤íŠ¸")
    @Transactional
    void deleteStudent() {
        Student input = new Student();
        input.setId(101260); 
        int output = studentMapper.delete(input);

        // Assertion ì¶”ê°€
        Assertions.assertEquals(0, output, "í•™ìƒ ì‚­ì œëŠ” 0ê±´ì´ì–´ì•¼ í•œë‹¤ -> ì°¸ì¡°í‚¤ ì œì•½ì¡°ê±´ ë•Œë¬¸");

        log.debug("ì‚­ì œëœ ë°ì´í„°ì˜ ìˆ˜ : " + output);
    }

    @Test
    @DisplayName("í•˜ë‚˜ì˜ í•™ìƒ ì¡°íšŒ í…ŒìŠ¤íŠ¸")
    @Transactional
    void selectOneStudent() {
        Student input = new Student();
        input.setId(10101); 
        Student output = studentMapper.selectOne(input);

        // Assertion ì¶”ê°€
        Assertions.assertNotNull(output, "í•™ìƒì´ ì¡´ì¬í•´ì•¼ í•œë‹¤");

        log.debug("ì¡°íšŒê²°ê³¼ : " + (output != null ? output.toString() : "null"));
    }

    @Test
    @DisplayName("í•™ìƒ ëª©ë¡ ì¡°íšŒ í…ŒìŠ¤íŠ¸")
    @Transactional
    void selectListStudent() {
        Student input = new Student();
        List<Student> output = studentMapper.selectList(input);

        // Assertion ì¶”ê°€
        Assertions.assertNotNull(output, "í•™ìƒ ëª©ë¡ì€ nullì´ ì•„ë‹ˆì–´ì•¼ í•œë‹¤");
        Assertions.assertTrue(output.size() >= 0, "í•™ìƒ ëª©ë¡ í¬ê¸°ëŠ” 0 ì´ìƒì´ì–´ì•¼ í•œë‹¤");

        log.debug("ì¡°íšŒëœ ë°ì´í„°ì˜ ìˆ˜ : " + output.size());
        for (Student item : output) {
            log.debug(item.toString());
        }
    }

    @Test
    @DisplayName("í•™ìƒ ëª©ë¡ ì¹´ìš´íŠ¸ í…ŒìŠ¤íŠ¸")
    @Transactional
    void selectCountStudent() {
        Student input = new Student();
        int output = studentMapper.selectCount(input);

        // Assertion ì¶”ê°€
        Assertions.assertTrue(output >= 0, "í•™ìƒ ì¹´ìš´íŠ¸ëŠ” 0 ì´ìƒì´ì–´ì•¼ í•œë‹¤");

        log.debug("ì¡°íšŒëœ ë°ì´í„°ì˜ ìˆ˜ : " + output);
    }

    @Test
    @DisplayName("íŠ¹ì • í•™ê³¼ í•™ìƒ ì¼ê´„ ì‚­ì œ í…ŒìŠ¤íŠ¸")
    @Transactional
    void deleteByDepartmentId() {
        // ì°¸ì¡°í‚¤ ì œì•½ì¡°ê±´ ë•Œë¬¸ì— êµìˆ˜ ë°ì´í„° ì‚­ì œ ì—†ì´ í•™ìƒ ì‚­ì œëŠ” ë¶ˆê°€
        Student input = new Student();
        input.setDepartmentId(405); 
        int output = studentMapper.deleteByDepartmentId(input);

        // Assertion ì¶”ê°€
        Assertions.assertTrue(output >= 0, "ì‚­ì œëœ í•™ìƒ ìˆ˜ëŠ” 0 ì´ìƒì´ì–´ì•¼ í•œë‹¤");

        log.debug("ì‚­ì œëœ ë°ì´í„°ì˜ ìˆ˜ : " + output);
    }

    @Test
    @DisplayName("íŠ¹ì • êµìˆ˜ ë‹´ë‹¹ í•™ìƒì˜ êµìˆ˜ë²ˆí˜¸ NULL ì²˜ë¦¬ í…ŒìŠ¤íŠ¸")
    @Transactional
    void updateProfessorIdToNull() {
        Student input = new Student();
        input.setProfessorId(9931); // ì‹¤ì œ ì¡´ì¬í•˜ëŠ” êµìˆ˜ PKë¡œ ë³€ê²½ í•„ìš”
        int output = studentMapper.updateByprofessorId(input);

        // Assertion ì¶”ê°€
        Assertions.assertTrue(output >= 0, "NULL ì²˜ë¦¬ëœ í•™ìƒ ìˆ˜ëŠ” 0 ì´ìƒì´ì–´ì•¼ í•œë‹¤");

        log.debug("ë³€ê²½ëœ ë°ì´í„°ì˜ ìˆ˜ : " + output);
    }
}
```
- ìœ„ì—ì„œ ì‚­ì œí•  ë°ì´í„°ê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²½ìš°ë¥¼ ì—ëŸ¬ë¡œ ë³´ì§€ ì•Šìœ¼ë¯€ë¡œ ì„œë¹„ìŠ¤ êµ¬í˜„í• ë•Œ ì•„ë˜ì²˜ëŸ¼ try-catchë¡œ 0ì¸ ê²½ìš°ë¥¼ ì»¤ë²„í•´ì¤€ë‹¤.
```java
@Test
    @DisplayName("í•™ìƒ ì‚­ì œ ì„œë¹„ìŠ¤ í…ŒìŠ¤íŠ¸")
    @Transactional
    void removeStudent() {
        Student input = new Student();
        input.setId(10179); // ì‹¤ì œ ì¡´ì¬í•˜ëŠ” PKë¡œ ë³€ê²½ í•„ìš”

        int output = 0;

        try {
            output = studentService.deleteItem(input);
        } catch (ServiceNoResultException e) {
            log.error("ì²˜ë¦¬ëœ ë°ì´í„° ì—†ìŒ >> WHEREì ˆì„ í™•ì¸í•˜ì„¸ìš”", e);
        } catch (Exception e) {
            log.error("ë°ì´í„° ì²˜ë¦¬ ì‹¤íŒ¨ >> SQLë¬¸ì„ í™•ì¸í•˜ì„¸ìš”", e);
        }

        log.debug("ì‚­ì œëœ ë°ì´í„° ìˆ˜ ---> " + output);
    }
```

# ğŸ“Œ 3. ì‚­ì œ í…ŒìŠ¤íŠ¸ ì˜¤ë¥˜ë°œê²¬
- ì˜ˆì œì—ì„œ í…ŒìŠ¤íŠ¸ ì‹œì— ì‚­ì œëœ ë°ì´í„°ë¥¼ ì˜¤ë¥˜ë¡œ ì²˜ë¦¬í•˜ì§€ ì•Šì•„ì„œ ì§ì ‘ ifë¬¸ì„ ë„£ì–´ì„œ ì²˜ë¦¬ëœ ë°ì´í„°ê°€ ì—†ì„ ë•Œì˜ ì˜ˆì™¸ë¥¼ ì¶”ê°€í•´ ì£¼ì—ˆë‹¤.
- ê·¸ëŸ¬ë©´  catch (ServiceNoResultException e) {log.error("ì²˜ë¦¬ëœ ë°ì´í„° ì—†ìŒ >> WHEREì ˆì„ í™•ì¸í•˜ì„¸ìš”", e);} ê°€ í•„ìš”ì—†ëŠ” êµ¬ë¬¸ì´ë¯€ë¡œ ì‚­ì œí•˜ì˜€ë‹¤.
- ê·¸ëŸ°ë° implì— í•´ë‹¹ ë‚´ìš©ì´ êµ¬í˜„ë˜ì–´ ìˆì—ˆê¸´ í•´ì„œ ê·¸ëƒ¥ ì´ëŸ° ê²ƒì„ ìœ ì˜í•´ì•¼í•œë‹¤ëŠ” ì •ë„ë¡œ ì§‘ê³  ë„˜ì–´ê°€ì
```java
@Test
    @DisplayName("í•™ìƒ ì‚­ì œ ì„œë¹„ìŠ¤ í…ŒìŠ¤íŠ¸")
    @Transactional
    void removeStudent()  {
        Student input = new Student();
        input.setId(10179); // ì‹¤ì œ ì¡´ì¬í•˜ëŠ” PKë¡œ ë³€ê²½ í•„ìš”

        int output = 0;

        try {
            output = studentService.deleteItem(input);

            if (output == 0) {
            throw new ServiceNoResultException("ì²˜ë¦¬ëœ ë°ì´í„° ì—†ìŒ >> WHEREì ˆì„ í™•ì¸í•˜ì„¸ìš”");
        }

        } catch (Exception e) {
            log.error("ë°ì´í„° ì²˜ë¦¬ ì‹¤íŒ¨ >> SQLë¬¸ì„ í™•ì¸í•˜ì„¸ìš”", e);
        }
        log.debug("ì‚­ì œëœ ë°ì´í„° ìˆ˜ ---> " + output);
    }
```

# ğŸ“Œ 4. my school ì»¨íŠ¸ë¡¤ëŸ¬ ì‘ì—…

### ğŸ“Œ 4-1. department controller
- Department ê°ì²´ì˜ ë©¤ë²„ë³€ìˆ˜ì™€ dbì˜ ì†ì„±ê°’ì„ mapperê°€ ë§¤ì¹˜í•˜ì—¬ ë¦¬ìŠ¤íŠ¸ë¡œ ë°˜í™˜í•´ì¤€ë‹¤. ì´ë•Œ ìŠ¤ë„¤ì´í¬ - ì¹´ë©œ ê´€ê³„ë¼ë©´ ìë™ ë§¤í•‘í•´ì£¼ì§€ë§Œ mapper ë‹¨ì—ì„œ ì¼ì¼íˆ ê°ì²´ ë©¤ë²„ë³€ìˆ˜ì™€ í…Œì´ë¸” ì†ì„±ì„ ë§¤ì¹­í•´ì£¼ì–´ë„ ëœë‹¤.
- ë‚˜ëŠ” mapperì—ì„œ @ResultMap("resultMap")ë¥¼ ì‚¬ìš©í•˜ì˜€ë‹¤.
- ê²°ê³¼ë¥¼ outputìœ¼ë¡œ ë°›ê³  ì´ë¥¼ modelê°ì²´ì— "departments"ë€ ì´ë¦„ìœ¼ë¡œ ë‹´ì•„ "department/index" íŒŒì¼ê³¼ í•©ì¹˜ë„ë¡ í•œë‹¤.
- ë§Œì•½ ë¦¬ìŠ¤íŠ¸ ê°€ì ¸ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆì„ ê²½ìš° 500ì—ëŸ¬ë¥¼ ë„ìš°ê³  ì´ì „ í˜ì´ì§€(history.back)ë¡œ ëŒì•„ê°„ë‹¤. (webHelper.serverError(e))
```java
public class DepartmentController {
    
    @Autowired
    private DepartmentService departmentService;

    @Autowired
    private WebHelper webHelper;

    
    public String index(Model model) {

        List<Department> output = null;

        try {
            output = departmentService.getList(new Department());
        } catch (Exception e) {
            webHelper.serverError(e);
        }

        model.addAttribute("departments", output);

        return "department/index";
    }
}
```

### ğŸ“Œ 4-2. professor controller
- ì²˜ë¦¬ëŠ” ìœ„ì™€ ê°™ë‹¤. ëª¨ë¸ê°ì²´ì— ë¦¬ìŠ¤íŠ¸ë¥¼ ë„˜ê¸´ë‹¤.
- List<Professor>: ë©¤ë²„ë³€ìˆ˜ì— mapperì—ì„œ ë„˜ê²¨ë°›ì€ í•œí–‰ì´ í•œ Professor ê°ì²´ì— ì €ì¥ë˜ê³  ì´ Professorê°ì²´ê°€ ëª¨ì¸ ë¦¬ìŠ¤íŠ¸ì´ë‹¤.
```java
@Controller
public class ProfessorController {
    
    @Autowired
    private ProfessorService professorService;

    @Autowired
    private WebHelper wepHelper;

    public String index(Model model) {
        List<Professor> output = null;

        try {
            output = professorService.getList(new Professor());
        } catch (Exception e) {
            wepHelper.serverError(e);
        }

        model.addAttribute("professors", output);
        
        return "professor/index";
    }
}
```

### ğŸ“Œ 4-3. professor/index
- <tr th:each="professor : ${professors}"> : ëª¨ë¸ ê°ì²´ì—ì„œ í‚¤ê°’ì´ professorsì¸ output ì¦‰ List<Professor>ì„ êº¼ë‚´ì„œ í•˜ë‚˜ì”© ìˆœíšŒí•˜ë¯€ë¡œ professor í•˜ë‚˜ëŠ” ê°’ì´ ì €ì¥ëœ Professor ê°ì²´ì´ë‹¤. 
- ì•„ë˜ì˜ ê³¼ì •ì€ ì´ professorê°ì²´ì— ì €ì¥ë˜ì–´ ìˆëŠ” ë©¤ë²„ë³€ìˆ˜ì˜ ê°’ì„ êº¼ë‚´ì„œ tdì— ë„£ëŠ” ê³¼ì •ë“¤ì´ë‹¤.
-<td th:text="${#strings.substring(professor.hidrate, 0, 10)}"></td> : ê³ ìš©ëœ ë‚ ì§œë¥¼ ì—°ì›”ì¼ë§Œ ë³´ì´ë„ë¡ ì˜ë¼ì„œ í…ìŠ¤íŠ¸ë¡œ ì‚½ì…í•œë‹¤.
- scriptë¶€ë¶„ì€ ì•„ì§ ì´ë¯¸ì§€ê°€ ë”ë¯¸ ì´ë¯¸ì§€ì´ë¯€ë¡œ ì—ëŸ¬ê°€ ë‚¬ì„ë•Œ ì„ì˜ì˜ ì´ë¯¸ì§€ë¡œ ëŒ€ì²´í•˜ëŠ” ì½”ë“œì´ë‹¤.
- <a th:href="@{/professor/view/{id}(id=${professor.id})}" th:text="${professor.name}"></a> : êµìˆ˜ ìƒì„¸ë³´ê¸° í˜ì´ì§€ë¡œ ì´ë™í•˜ëŠ” ë§í¬ë¥¼ ë§Œë“ ë‹¤.
- document.querySelectorAll("img").forEach((v, i) => {v.addEventListener("error", e => e.currentTarget.src = "/assets/img/noimage.jpg");}); : ì—¬ê¸°ì„œ ì´ë¯¸ì§€ê°€ ì—†ì–´ì„œ assetsë¡œ ì´ë¯¸ì§€ë¥¼ ì°¾ìœ¼ëŸ¬ ê°”ëŠ”ë° ì´ë¯¸ì§€ê°€ ì—†ìœ¼ë©´ ë‹¤ì‹œ ë¡œë”©ì„ í•˜ë ¤ê³  ê³„ì† íŠ•ê¸¸ ìˆ˜ ìˆë‹¤. ë§Œì•½ íŠ•ê¸´ë‹¤ë©´ ì´ë¯¸ì§€ë¥¼ ì˜¬ë°”ë¥¸ ìœ„ì¹˜ì— ë„£ì—ˆëŠ”ì§€ ê±°ë“­í™•ì¸í•´ì•¼í•œë‹¤.
- <a th:href="@{/professor/delete/{id}(id=$professor.id)}">ì‚­ì œ</a> ì´ê²Œ ì•„ë‹ˆë¼ <a th:href="@{/professor/delete/{id}(id=${professor.id})}">ì‚­ì œ</a>
ì´ë ‡ê²Œ $ì•ˆì„ ì¤‘ê´„í˜¸ë¡œ ê°ì‹¸ì£¼ì–´ì•¼ í•œë‹¤.
```html
<body>
    <header th:replace="fragments/header :: my-header"></header>

    <h1>êµìˆ˜ëª©ë¡</h1>

    <table class="my-table">
        <thead>
            <tr>
                <th></th>
                <th>ë²ˆí˜¸</th>
                <th>ì´ë¦„</th>
                <th>ì•„ì´ë””</th>
                <th>ì§ê¸‰</th>
                <th>ì…ì‚¬ì¼</th>
                <th>ê¸‰ì—¬(ë§Œì›)</th>
                <th>ì´ë©”ì¼</th>
                <th>ì—°ë½ì²˜</th>
                <th>ìƒíƒœ</th>
                <th>ì†Œì†í•™ê³¼ë²ˆí˜¸</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="professor : ${professors}">
                <td>
                    <img th:src="${professor.photoUrl}" alt="êµìˆ˜ ì´ë¯¸ì§€" class="photo" >
                </td>
                <td th:src="${professor.id}"></td>
                <td>
                    <a th:href="@{/professor/view/{id}(id=${professor.id})}" th:text="${professor.name}"></a>
                </td>
                <td th:text="${professor.userId}"></td>
                <td th:text="${professor.position}"></td>
                <td th:text="{#strings.substring(professor.hiredate, 0, 10)}"></td>
                <td th:text="${professor.sal}"></td>
                <td th:text="${professor.comm}"></td>
                <td>
                    <a th:href="'mailto:' + ${professor.email}" th:text="${professor.email}"></a>
                </td>
                <td>
                    <a th:href="'tel:' + ${professor.phone}" th:text="${professor.phone}"></a>
                </td>
                <td th:text="${professor.status}"></td>
                <td th:text="${professor.departmentId}"></td>
                <td>
                    <a th:href="@{/professor/edit/{id}(id=${professor.id})}">ìˆ˜ì •</a>
                    <a th:href="@{/professor/delete/{id}(id=${professor.id})}">ì‚­ì œ</a>
                </td>
            </tr>
        </tbody>
    </table>

    <script>
        document.querySelectorAll("img").forEach(v => {
            v.addEventListener("error", e => e.currentTarget.src = "/assets/img/noimage.jpg");
        });
    </script>
</body>
</html>
```

### ğŸ“Œ 4-4. department index
```html
    <h1>í•™ê³¼ëª©ë¡</h1>

    <table class="my-table">
        <thead>
            <tr>
                <th>í•™ê³¼ë²ˆí˜¸</th>
                <th>í•™ê³¼ëª…</th>
                <th>ìœ„ì¹˜</th>
                <th>ì´ë©”ì¼</th>
                <th>ì „í™”ë²ˆí˜¸</th>
                <th>ì„¤ë¦½ë…„ë„</th>
                <th>í™ˆí˜ì´ì§€</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            <!--
            th:each êµ¬ë¬¸ì€ modelì— ì €ì¥ëœ ë¦¬ìŠ¤íŠ¸ ê°ì²´ë¥¼ ìˆœíšŒí•˜ë©°
            ê°ì²´ë¥¼ í•˜ë‚˜ì”© êº¼ë‚´ì„œ ê°ì²´ëª…ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
            th:each="ê°ì²´ëª… : ${modelì— ì €ì¥ëœ ë¦¬ìŠ¤íŠ¸ ê°ì²´}"

            QueryString íŒŒë¼ë¯¸í„° ì„¤ì •
            @{/hello/(param1=${ë³€ìˆ˜1}, param2=${ë³€ìˆ˜2})}
            => /hello/?param1=ë³€ìˆ˜1&param2=ë³€ìˆ˜2

            path íŒŒë¼ë¯¸í„° ì„¤ì •
            @{/hello/{param1}/{param2}(param1=${ë³€ìˆ˜1}, param2=${ë³€ìˆ˜2})}
            => /hello/ë³€ìˆ˜1/ë³€ìˆ˜2

            path íŒŒë¼ë¯¸í„° + ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ê°€ í¬í•¨ëœ URL
            @{/hello/{param1}(param1=${ë³€ìˆ˜1}, param2=${ë³€ìˆ˜2})}
            => /hello/ë³€ìˆ˜1?param2=ë³€ìˆ˜2
            -->
            <tr th:each="department : ${departments}">
                <td th:text="${department.id}"></td>
                <td>
                    <a th:href="${/department/view/{id}(id=${department.id})}" th:text="${department.dname}"></a>
                </td>
                <td th:text="${department.loc}"></td>
                <td>
                    <a th:href="'tel:' + ${department.phone}" th:text="${department.phone}"></a>
                </td>
                <td>
                    <a th:href="'mailto:' + ${department.email}" th:text="${department.email}"></a>
                </td>
                <td th:text="${department.established}"></td>
                <td>
                    <a th:href="${department.homepage}" th:text="${department.homepage}" target="_blank"></a>
                </td>
                <td>
                    <a th:href="@{/department/edit/{id}(id=${department.id})}">ìˆ˜ì •</a>
                    <a th:href="@{/department/delete/{id}(id=${department.id})}">ì‚­ì œ</a>
                </td>
            </tr>
        </tbody>
    </table>
</body>
</html>
```