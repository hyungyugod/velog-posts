# 📌 1. 데이터 전처리
### 1-1. 결측치 채우기 - pandas 활용
- fillna로 실제 값 자체나 다른 칼럼의 값, 그리고 계산된 값을 인자로 전달하여 해당 값으로 결측값을 채워줄 수 있다.
- ffill은 결측치를 앞의 값으로 (이전 행) 대체한다.
- 마찬가지로 bfill은 결측치를 뒤의 값으로 (다음 행) 대체한다.
```py
df1['수학'] = df1['수학'].fillna(df1['수학'].mean())
df1['영어'] = df1['영어'].fillna(df1['영어'].median())
df1['과학'] = df1['과학'].ffill()
```
- 평균으로 대치할 수 있는 것은 숫자로된 데이터 뿐이므로 이들 컬럼을 골라서 한번에 apply와 lambda함수를 이용해 결측값을 채우고 다시 number 데이터 타입에 해당하는 열만 대치한다.
- 이는 한방에 여러열의 결측값을 같은 방식으로 채우는 방법이다.
```py
df4 = df.copy()
df4_num = df4.select_dtypes('number')
df4_num = df4_num.apply(lambda col: col.fillna(col.mean()))
df4[df4_num.columns] = df4_num
df4.head()
```

### 1-2. 범주형 변수 인코딩 - LabelEncoding
- cat이라는 네이밍은 category변수를 의미한다.
- OrdinalEncoder는 dataframe을 변환하며 주로 독립형 변수에 사용하고
- LabelEncoder는 Series를 반환하며 주로 종속형 변수에 사용한다.
- 훈련데이터와 테스트 데이터가 만약 다른 경우가 있다면 handle_unknown='use_encorded_value', unkown_value를 지정하므로서 학습되어있지 않은데 테스트 데이터에 있는 카테고리를 지정한 값으로 반환할 수 있다.
```py
from sklearn.preprocessing import LabelEncoder
from sklearn.preprocessing import OrdinalEncoder

train_x6 = train_x.copy()
test_x6 = test_x.copy()

train_x6_cat = train_x6.select_dtypes('object')
test_x6_cat = test_x6.select_dtypes('object')

ordinalencoder = OrdinalEncoder().set_output(transform = 'pandas')
train_x6_cat = ordinalencoder.fit_transform(train_x6_cat)
test_x6_cat = ordinalencoder.transform(test_x6_cat)

train_x6_cat
train_x6[train_x6_cat.columns]
pd.concat([train_x6_cat, train_x6[train_x6_cat.columns]], axis = 1)
```

### 1-3. 범주형 변수 인코딩 - one hot encoding
- one hot encoding을 실행하면 school_GP	school_MS	sex_F	sex_M	paid_no	paid_yes 이런식으로 school, sex, paid 칼럼이 분리된다. 해당 되는 칼럼에 1을 주고 나머지는 0으로 하면서 각 데이터들을 분류하게 된다.
- sparse_output은 Sparse Matrix(희소행렬)로 출력할지 여부를 선택하는 것으로 희소 행렬은 
값이 0인 부분은 저장하지 않고, 0이 아닌 값의 위치만 (행, 열, 값)으로 저장하는 방식이다. 이는 scipy.sparse모듈에서 제공하는 구조이다.
- set_output(transform='pandas')을 사용하려면 0인데이터까지 전부 표기해주어야하므로 sparse_output = False를 걸어주어야한다.
- 여기서 만약 OneHotEncoder생성자에 변수로 drop=first를 주면 dummy encoding이 되고 이는 각 칼럼 중 첫번째 컬럼을 제거하여 요약된 정보를 제공하게 된다.
```py
from sklearn.preprocessing import OneHotEncoder
train_x7 = train_x.copy()
test_x7 = test_x.copy()

train_x7_cat = train_x7.select_dtypes('object')
test_x7_cat = test_x7.select_dtypes('object')

ohe = OneHotEncoder(sparse_output = False, handle_unknown = 'ignore').set_output(transform='pandas')

train_x7_cat = ohe.fit_transform(train_x7_cat)
test_x7_cat = ohe.transform(test_x7_cat)
```