# ğŸ“Œ 1. ë°ì´í„° ì „ì²˜ë¦¬
### 1-1. ê²°ì¸¡ì¹˜ ì±„ìš°ê¸° - pandas í™œìš©
- fillnaë¡œ ì‹¤ì œ ê°’ ìì²´ë‚˜ ë‹¤ë¥¸ ì¹¼ëŸ¼ì˜ ê°’, ê·¸ë¦¬ê³  ê³„ì‚°ëœ ê°’ì„ ì¸ìë¡œ ì „ë‹¬í•˜ì—¬ í•´ë‹¹ ê°’ìœ¼ë¡œ ê²°ì¸¡ê°’ì„ ì±„ì›Œì¤„ ìˆ˜ ìˆë‹¤.
- ffillì€ ê²°ì¸¡ì¹˜ë¥¼ ì•ì˜ ê°’ìœ¼ë¡œ (ì´ì „ í–‰) ëŒ€ì²´í•œë‹¤.
- ë§ˆì°¬ê°€ì§€ë¡œ bfillì€ ê²°ì¸¡ì¹˜ë¥¼ ë’¤ì˜ ê°’ìœ¼ë¡œ (ë‹¤ìŒ í–‰) ëŒ€ì²´í•œë‹¤.
```py
df1['ìˆ˜í•™'] = df1['ìˆ˜í•™'].fillna(df1['ìˆ˜í•™'].mean())
df1['ì˜ì–´'] = df1['ì˜ì–´'].fillna(df1['ì˜ì–´'].median())
df1['ê³¼í•™'] = df1['ê³¼í•™'].ffill()
```
- í‰ê· ìœ¼ë¡œ ëŒ€ì¹˜í•  ìˆ˜ ìˆëŠ” ê²ƒì€ ìˆ«ìë¡œëœ ë°ì´í„° ë¿ì´ë¯€ë¡œ ì´ë“¤ ì»¬ëŸ¼ì„ ê³¨ë¼ì„œ í•œë²ˆì— applyì™€ lambdaí•¨ìˆ˜ë¥¼ ì´ìš©í•´ ê²°ì¸¡ê°’ì„ ì±„ìš°ê³  ë‹¤ì‹œ number ë°ì´í„° íƒ€ì…ì— í•´ë‹¹í•˜ëŠ” ì—´ë§Œ ëŒ€ì¹˜í•œë‹¤.
- ì´ëŠ” í•œë°©ì— ì—¬ëŸ¬ì—´ì˜ ê²°ì¸¡ê°’ì„ ê°™ì€ ë°©ì‹ìœ¼ë¡œ ì±„ìš°ëŠ” ë°©ë²•ì´ë‹¤.
```py
df4 = df.copy()
df4_num = df4.select_dtypes('number')
df4_num = df4_num.apply(lambda col: col.fillna(col.mean()))
df4[df4_num.columns] = df4_num
df4.head()
```

### 1-2. ë²”ì£¼í˜• ë³€ìˆ˜ ì¸ì½”ë”© - LabelEncoding
- catì´ë¼ëŠ” ë„¤ì´ë°ì€ categoryë³€ìˆ˜ë¥¼ ì˜ë¯¸í•œë‹¤.
- OrdinalEncoderëŠ” dataframeì„ ë³€í™˜í•˜ë©° ì£¼ë¡œ ë…ë¦½í˜• ë³€ìˆ˜ì— ì‚¬ìš©í•˜ê³ 
- LabelEncoderëŠ” Seriesë¥¼ ë°˜í™˜í•˜ë©° ì£¼ë¡œ ì¢…ì†í˜• ë³€ìˆ˜ì— ì‚¬ìš©í•œë‹¤.
- í›ˆë ¨ë°ì´í„°ì™€ í…ŒìŠ¤íŠ¸ ë°ì´í„°ê°€ ë§Œì•½ ë‹¤ë¥¸ ê²½ìš°ê°€ ìˆë‹¤ë©´ handle_unknown='use_encorded_value', unkown_valueë¥¼ ì§€ì •í•˜ë¯€ë¡œì„œ í•™ìŠµë˜ì–´ìˆì§€ ì•Šì€ë° í…ŒìŠ¤íŠ¸ ë°ì´í„°ì— ìˆëŠ” ì¹´í…Œê³ ë¦¬ë¥¼ ì§€ì •í•œ ê°’ìœ¼ë¡œ ë°˜í™˜í•  ìˆ˜ ìˆë‹¤.
```py
from sklearn.preprocessing import LabelEncoder
from sklearn.preprocessing import OrdinalEncoder

train_x6 = train_x.copy()
test_x6 = test_x.copy()

train_x6_cat = train_x6.select_dtypes('object')
test_x6_cat = test_x6.select_dtypes('object')

ordinalencoder = OrdinalEncoder().set_output(transform = 'pandas')
train_x6_cat = ordinalencoder.fit_transform(train_x6_cat)
test_x6_cat = ordinalencoder.transform(test_x6_cat)

train_x6_cat
train_x6[train_x6_cat.columns]
pd.concat([train_x6_cat, train_x6[train_x6_cat.columns]], axis = 1)
```

### 1-3. ë²”ì£¼í˜• ë³€ìˆ˜ ì¸ì½”ë”© - one hot encoding
- one hot encodingì„ ì‹¤í–‰í•˜ë©´ school_GP	school_MS	sex_F	sex_M	paid_no	paid_yes ì´ëŸ°ì‹ìœ¼ë¡œ school, sex, paid ì¹¼ëŸ¼ì´ ë¶„ë¦¬ëœë‹¤. í•´ë‹¹ ë˜ëŠ” ì¹¼ëŸ¼ì— 1ì„ ì£¼ê³  ë‚˜ë¨¸ì§€ëŠ” 0ìœ¼ë¡œ í•˜ë©´ì„œ ê° ë°ì´í„°ë“¤ì„ ë¶„ë¥˜í•˜ê²Œ ëœë‹¤.
- sparse_outputì€ Sparse Matrix(í¬ì†Œí–‰ë ¬)ë¡œ ì¶œë ¥í• ì§€ ì—¬ë¶€ë¥¼ ì„ íƒí•˜ëŠ” ê²ƒìœ¼ë¡œ í¬ì†Œ í–‰ë ¬ì€ 
ê°’ì´ 0ì¸ ë¶€ë¶„ì€ ì €ì¥í•˜ì§€ ì•Šê³ , 0ì´ ì•„ë‹Œ ê°’ì˜ ìœ„ì¹˜ë§Œ (í–‰, ì—´, ê°’)ìœ¼ë¡œ ì €ì¥í•˜ëŠ” ë°©ì‹ì´ë‹¤. ì´ëŠ” scipy.sparseëª¨ë“ˆì—ì„œ ì œê³µí•˜ëŠ” êµ¬ì¡°ì´ë‹¤.
- set_output(transform='pandas')ì„ ì‚¬ìš©í•˜ë ¤ë©´ 0ì¸ë°ì´í„°ê¹Œì§€ ì „ë¶€ í‘œê¸°í•´ì£¼ì–´ì•¼í•˜ë¯€ë¡œ sparse_output = Falseë¥¼ ê±¸ì–´ì£¼ì–´ì•¼í•œë‹¤.
- ì—¬ê¸°ì„œ ë§Œì•½ OneHotEncoderìƒì„±ìì— ë³€ìˆ˜ë¡œ drop=firstë¥¼ ì£¼ë©´ dummy encodingì´ ë˜ê³  ì´ëŠ” ê° ì¹¼ëŸ¼ ì¤‘ ì²«ë²ˆì§¸ ì»¬ëŸ¼ì„ ì œê±°í•˜ì—¬ ìš”ì•½ëœ ì •ë³´ë¥¼ ì œê³µí•˜ê²Œ ëœë‹¤.
```py
from sklearn.preprocessing import OneHotEncoder
train_x7 = train_x.copy()
test_x7 = test_x.copy()

train_x7_cat = train_x7.select_dtypes('object')
test_x7_cat = test_x7.select_dtypes('object')

ohe = OneHotEncoder(sparse_output = False, handle_unknown = 'ignore').set_output(transform='pandas')

train_x7_cat = ohe.fit_transform(train_x7_cat)
test_x7_cat = ohe.transform(test_x7_cat)
```