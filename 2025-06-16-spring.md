# ğŸ“Œ 1. ë³´ìŠ¤ í”„ë¡œì íŠ¸
### ğŸ“Œ 1-1. ë¡œê·¸ì¸ 1ì°¨ êµ¬í˜„
```java
@Controller
public class LoginController {

    @Autowired
    private LoginService loginService;

    @Autowired
    private WebHelper webHelper;
    
    @GetMapping("login/index")
    public String home(Model model,
                        @CookieValue(value = "rememberId", required = false) String rememberIdCookie) {
        model.addAttribute("rememberId", rememberIdCookie);
        return "login/index"; // login/index.htmlë¡œ ì´ë™
    }

    // ì•„ì´ë”” ë¹„ë²ˆ ì…ë ¥í•´ì„œ ìš”ì²­í•˜ë©´ ì—¬ê¸°ë¡œ ì˜¨ë‹¤.
    @PostMapping("/login/login_ok")
    public String loginOk(HttpServletRequest request, 
                            HttpServletResponse response,
                            @RequestParam("user_email") String userEmail, // ì‚¬ìš©ìê°€ ì…ë ¥í•œ ì´ë©”ì¼
                            @RequestParam("user_password") String userPassword, // ì‚¬ìš©ìê°€ ì…ë ¥í•œ ë¹„ë°€ë²ˆí˜¸
                            @RequestParam(value = "remember_id", defaultValue = "N") String rememberId) { // ì•„ì´ë”” ê¸°ì–µ ì²´í¬ì—¬ë¶€

        // ì´ë©”ì¼ì„ ì…ë ¥í•˜ì§€ ì•Šì€ ê²½ìš°
        if (userEmail == null || userEmail.isEmpty()) {
            response.setStatus(400); // ì˜ëª»ëœ ìš”ì²­ ìƒíƒœ ì½”ë“œ
            // ì‘ë‹µ í—¤ë” ì„¤ì •
            response.setContentType("text/html; charset=UTF-8");

            try {
                PrintWriter out = response.getWriter();
                out.println("<script>");
                out.println("alert('ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');");
                out.println("history.back();");
                out.println("</script>");
                out.flush();
            } catch (IOException e) {
                e.printStackTrace();
            }
            return null; // ì—ëŸ¬ ë°œìƒ ì‹œ null ë°˜í™˜
        }

        // ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì§€ ì•Šì€ ê²½ìš°

        if (userPassword == null || userPassword.isEmpty()) {
            response.setStatus(400); // ì˜ëª»ëœ ìš”ì²­ ìƒíƒœ ì½”ë“œ
            // ì‘ë‹µ í—¤ë” ì„¤ì •
            response.setContentType("text/html; charset=UTF-8");

            try {
                PrintWriter out = response.getWriter();
                out.println("<script>");
                out.println("alert('ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');");
                out.println("history.back();");
                out.println("</script>");
                out.flush();
            } catch (IOException e) {
                e.printStackTrace();
            }
            return null; // ì—ëŸ¬ ë°œìƒ ì‹œ null ë°˜í™˜
        }

        // ìœ ì € ì •ë³´ ê°ì²´ ìƒì„±
        Users users = new Users();
        users.setUserEmail(userEmail);
        users.setUserPassword(userPassword);

        try {
            // ë¡œê·¸ì¸ ì„œë¹„ìŠ¤ í˜¸ì¶œ
            Users user = loginService.oneUserSelect(users);

            // ë¡œê·¸ì¸ ì‹¤íŒ¨ ì²˜ë¦¬
            if (user == null) {
                try {
                PrintWriter out = response.getWriter();
                out.println("<script>");
                out.println("alert('ì•„ì´ë”” í˜¹ì€ ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');");
                out.println("history.back();");
                out.println("</script>");
                out.flush();
            } catch (IOException e) {
                e.printStackTrace();
            }
            return null; // ë¡œê·¸ì¸ ì‹¤íŒ¨ ì‹œ null ë°˜í™˜
        }

        // ì„¸ì…˜ì— ì‚¬ìš©ì ì •ë³´ ì €ì¥
        HttpSession session = request.getSession();
        session.setAttribute("userInfo", user);

        // ì•„ì´ë”” ê¸°ì–µí•˜ê¸° ì²´í¬ ì—¬ë¶€ ì²˜ë¦¬
        if ("Y".equals(rememberId)) {
            webHelper.writeCookie("rememberId", userEmail, 60 * 60 * 24 * 7);
        } else {
            webHelper.deleteCookie("rememberId");
        }

            return "redirect:/main/index"; // ë¡œê·¸ì¸ ì„±ê³µ í›„ ì´ë™

        } catch (Exception e) {
            response.setStatus(403); // ê¶Œí•œ ê±°ì ˆ ìƒíƒœ ì½”ë“œ
            response.setContentType("text/html; charset=UTF-8");

            PrintWriter out = null;
            try {
                out = response.getWriter();
                out.println("<script>");
                out.println("alert('ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');");
                out.println("history.back();");
                out.println("</script>");
                out.flush();
            } 
            
            catch (IOException ioException) {
                ioException.printStackTrace();
            }
            return null; // ì—ëŸ¬ ë°œìƒ ì‹œ null ë°˜í™˜
        }
    }

    // ë¡œê·¸ì•„ì›ƒ êµ¬í˜„
    @GetMapping("/login/logout")
    public String logout(HttpServletRequest request, HttpServletResponse response) {
        // ì„¸ì…˜ ë¬´íš¨í™”
        HttpSession session = request.getSession();
        session.invalidate();

        // ì¿ í‚¤ ì‚­ì œ
        try {
            webHelper.deleteCookie("rememberId");
        } catch (Exception e) {
            e.printStackTrace();
            // í•„ìš”í•˜ë‹¤ë©´ ì—ëŸ¬ ì²˜ë¦¬ ë¡œì§ ì¶”ê°€
        }

        return "redirect:/main/index"; // ë¡œê·¸ì•„ì›ƒ í›„ ì´ë™í•  í˜ì´ì§€
    }
}
```

### ğŸ“Œ 1-2. ë¡œê·¸ì¸ í˜ì´ì§€ html
```html
<!DOCTYPE html>
<html lang="ko" translate="no" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="google" content="nottranslate" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¡œê·¸ì¸ í˜ì´ì§€</title>
    <link rel="stylesheet" th:href="@{/assets/css/login_style.css}" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100..900&display=swap" rel="stylesheet">
</head>
<body>
    <div class="login-container">
        <!-- í—¤ë” ì˜ì—­ -->
        <div class="header">
            <div class="top-buttons">
                <!-- ë’¤ë¡œê°€ê¸° -->
                <a type="button" onclick="history.back()">
                    <img src="@{/images/back_icon.png}" alt="ë’¤ë¡œê°€ê¸° ì•„ì´ì½˜" class="back-icon">
                </a>

                <!-- í™ˆìœ¼ë¡œ ê°€ê¸° -->
                <a th:href="@{/main}" class="home-button">
                    <img src="@{/images/home_icon.png}" alt="í™ˆ ì•„ì´ì½˜" class="home-icon">
                </a>
            </div>

            <div class="logo-container">
                <a th:href="@{/main}" class="logo-link">
                    <img class="logo" src="@{/images/logo.png}" alt="ë¡œê³ ">
                </a>
            </div>
        </div>

        <div class="login-head">
            <h2>ë¡œê·¸ì¸</h2>
        </div>

        <!-- ë¡œê·¸ì¸ í¼ ì˜ì—­ -->
        <div class="login-form">
            <!-- ë¡œê·¸ì¸ ì•ˆ ëœ ìƒíƒœ -->
            <form method="post" th:action="@{/login/login_ok}">
                <input type="text" name="user_email" placeholder="ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”." th:value="${rememberId}"> <!-- ì•„ì´ë”” ìë™ì €ì¥í–ˆìœ¼ë©´ ê°’ì„ ë¯¸ë¦¬ ì±„ì›Œë‘  -->
                <input type="password" name="user_password" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.">
                <label>
                    <input type="checkbox" name="remember_id" value="Y">
                    <span>ì•„ì´ë”” ì €ì¥</span>
                </label>
                <button type="submit">ê¸°ì¡´ íšŒì› ë¡œê·¸ì¸</button>
            </form>
        </div>

        <!-- ì•„ì´ë”” ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°, íšŒì›ê°€ì… -->
        <div class="finder">
            <a th:href="@{/login/find}">ì•„ì´ë””/ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°</a>
            <a th:href="@{/login/join}">ê°€ì…í•˜ê¸°</a>
        </div>
</body>
</html>
```

### ğŸ“Œ 1-3. ë¡œê·¸ì¸ db í†µí•˜ì—¬ êµ¬í˜„
- ìœ„ì˜ ì½”ë“œê°€ í˜„ì¬ê¹Œì§€ ì§„ë„ë¡œëŠ” ì˜ ì§  ì½”ë“œë¼ê³  ë“¤ì—ˆì§€ë§Œ ìš´ì˜í•˜ëŠ” ì‚¬ì´íŠ¸ì˜ ê·œëª¨ê°€ ì»¤ì ¸ì„œ ì„œë²„ë¥¼ ë¶„ë¦¬í–ˆì„ë•Œ ê°™ì€ í´ë¼ì´ì–¸íŠ¸ê°€ ì ‘ì†í•´ë„ íŠ¸ë˜í”½ì´ ë§ìœ¼ë©´ ë‹¤ë¥¸ ì„œë²„ë¥¼ í†µí•´ ì‚¬ì´íŠ¸ì— ì ‘ì†í•  ìˆ˜ ìˆëŠ”ë° ì´ë•Œ ê¸°ì¡´ì— ë§Œë“¤ì–´ë‘ì—ˆë˜ ì„¸ì…˜ì„ ì‚¬ìš©í•˜ì§€ ëª»í•˜ê³  ë¡œê·¸ì•„ì›ƒì„ ì•ˆí–ˆëŠ”ë° ë¡œê·¸ì¸ì´ í’€ë ¤ë²„ë¦´ ìˆ˜ë„ ìˆë‹¤. ì´ì— dbë¥¼ ìƒˆë¡œ ë§Œë“¤ì–´ì„œ ì„¸ì…˜ì„ ê±°ê¸°ì— ì €ì¥í•´ë‘ë©´ ì–´ëŠ ì„œë²„ì—ì„œ ì ‘ì†í•´ë„ dbì—ì„œ ì„¸ì…˜ì„ êº¼ë‚´ì¤„ ìˆ˜ ìˆë‹¤.
- ê¸°ì¡´ì—ëŠ” ì„¸ì…˜ì„ **ë©”ëª¨ë¦¬(ì„œë²„ ë¨)**ì— ì €ì¥í•´ë‘”ë‹¤. ì¦‰ ì„œë²„ë§ˆë‹¤ ìˆëŠ” ë¨ì— ì €ì¥í•˜ëŠ” ê²ƒì´ë‹¤. ì´ë¥¼ ë¶„ëª…íˆ ê°œì„ í•  í•„ìš”ê°€ ìˆì–´ ë³´ì¸ë‹¤.
- ì•„ë˜ëŠ” session dbì˜ í…Œì´ë¸” êµ¬ì¡°ì´ë‹¤. 
- SPRING_SESSIONìœ¼ë¡œ ì„¸ì…˜ì´ ì €ì¥ë  í…Œì´ë¸”, SPRING_SESSION_ATTRIBUTESìœ¼ë¡œ SPRING_SESSIONí…Œì´ë¸”ì˜ PRIMARY_IDë¥¼ ì°¸ì¡°í•œ í…Œì´ë¸” ì´ë ‡ê²Œ ë‘ í…Œì´ë¸”ì„ ë§Œë“¤ì–´ì„œ ì„¸ì…˜ìì²´ì— ê´€í•œ ì •ë³´ì™€ ì„¸ì…˜ ì„¸ë¶€ì‚¬í•­ì— ëŒ€í•œ ì •ë³´ë¥¼ ëª¨ë‘ ë‹´ì„ ìˆ˜ ìˆë‹¤.
- ì„¸ì…˜ ì •ë³´, ì„¸ì…˜ ë“±ë¡ ì‹œê°„, ì„¸ì…˜ ì‚¬ìš©ì ì´ë¦„ ë“±ì€ ë¹¨ë¦¬ íƒìƒ‰í•´ì•¼ í•˜ë¯€ë¡œ ì¸ë±ìŠ¤ë¥¼ ê±¸ì–´ë‘”ë‹¤.
- build-gradleì— implementation 'org.springframework.session:spring-session-jdbc' ë¥¼ ë„£ìœ¼ë©´ í˜„ì¬ ì‚¬ìš©í•˜ëŠ” seesionì„ dbì™€ ì—°ë™í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ”ë° ì´ë•Œ ì•„ë˜ì™€ ê°™ì€ í…Œì´ë¸” êµ¬ì¡°ë¥¼ ì§€ì¼œë†“ì•„ì•¼ í•˜ëŠ” ê²ƒì´ë‹¤.
- ì¶”ê°€ì ìœ¼ë¡œ ì„¸ì…˜ ì†Œë©¸ ì‹œê°„ì„ application-propirties spring.session.timeout=1hì„ í†µí•´ 1ì‹œê°„ìœ¼ë¡œ ì„¤ì •í•´ë‘”ë‹¤.
```sql
CREATE TABLE SPRING_SESSION (
	PRIMARY_ID CHAR(36) NOT NULL,
	SESSION_ID CHAR(36) NOT NULL,
	CREATION_TIME BIGINT NOT NULL,
	LAST_ACCESS_TIME BIGINT NOT NULL,
	MAX_INACTIVE_INTERVAL INT NOT NULL,
	EXPIRY_TIME BIGINT NOT NULL,
	PRINCIPAL_NAME VARCHAR(100),
	CONSTRAINT SPRING_SESSION_PK PRIMARY KEY (PRIMARY_ID)
);

CREATE UNIQUE INDEX SPRING_SESSION_IX1 ON SPRING_SESSION (SESSION_ID);
CREATE INDEX SPRING_SESSION_IX2 ON SPRING_SESSION (EXPIRY_TIME);
CREATE INDEX SPRING_SESSION_IX3 ON SPRING_SESSION (PRINCIPAL_NAME);

CREATE TABLE SPRING_SESSION_ATTRIBUTES (
	SESSION_PRIMARY_ID CHAR(36) NOT NULL,
	ATTRIBUTE_NAME VARCHAR(200) NOT NULL,
    ATTRIBUTE_BYTES BLOB NOT NULL,
	CONSTRAINT SPRING_SESSION_ATTRIBUTES_PK PRIMARY KEY (SESSION_PRIMARY_ID, ATTRIBUTE_NAME),
	CONSTRAINT SPRING_SESSION_ATTRIBUTES_FK FOREIGN KEY (SESSION_PRIMARY_ID) REFERENCES SPRING_SESSION(PRIMARY_ID) ON DELETE CASCADE
);
```

# ğŸ“Œ 2. í•™ê³¼ ì¡°íšŒ êµ¬í˜„
### ğŸ“Œ 2-1. controller
- @PathVariable(value="id", required = true)ì€ ì¿¼ë¦¬ìŠ¤íŠ¸ë§ì´ ì•„ë‹Œ path íŒŒë¼ë¯¸í„°ì— ìˆëŠ” ê°’ì„ ë°›ëŠ”ë‹¤. 
- ë§µí•‘í•  ë•Œ ì •ì˜í•œ @GetMapping("/department/view/{id}")ì˜ id ì— value idê°€ ë§¤ì¹­ëœë‹¤.
- ê°’ì„ ë°›ì•„ì„œ í•´ë‹¹ idì˜ í•™ê³¼ë¥¼ ì‚­ì œí•œë‹¤.
```java
@GetMapping("/department/view/{id}")
        public void view(Model model, @PathVariable(value="id", required = true) int id) {
            Department input = new Department();
            input.setId(id);

            try {
                departmentService.deleteItem(input);
            } catch (Exception e) {
                webHelper.serverError(e);
                return ;
            }
            webHelper.redirect("/department", "ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.");
        }   
```

### ğŸ“Œ 2-2. viwe.html
- "@{'/department/delete/' + ${department.id}}" : ì´ëŸ° ì‹ìœ¼ë¡œ path ë§í¬ì— ì•„ì´ë“œë¥¼ ë¶™ì—¬ì„œ ìš”ì²­ì„ ë³´ë‚¸ë‹¤.
- attrì€ attributeì˜ ì•½ìë¡œ ì—¬ëŸ¬ HTML ì†ì„±ì„ í•œ ë²ˆì— ë™ì ìœ¼ë¡œ ë„£ì–´ì£¼ëŠ” íƒ€ì„ë¦¬í”„ ë¬¸ë²•ì´ë‹¤.
- ìœ„ì˜ ì†ì„±ì„ ì‚¬ìš©í•´ ìë°” ìŠ¤í¬ë¦½íŠ¸ ì»¨íŠ¸ë¡¤ì„ ë” ì‰½ê²Œ í•  ìˆ˜ ìˆë‹¤.
```html
<div class="buttons">
    <a th:href="@{/department}" class="mybutton green">ëª©ë¡ë³´ê¸°</a>
    <a th:href="@{/department/add}" class="mybutton blue">ì‹ ê·œë“±ë¡</a>
    <a th:href="@{'/department/edit/' + ${department.id}}" class="mybutton red">ìˆ˜ì •í•˜ê¸°</a>
    <a th:href="@{'/department/delete/' + ${department.id}}"
       class="mybutton black" id="btn-delete"
       th:attr="data-dname=${department.dname},data-id=${department.id}">ì‚­ì œí•˜ê¸°</a>
</div>
```

### ğŸ“Œ 2-3. ìë°”ìŠ¤í¬ë¦½íŠ¸ë¡œ ì‚­ì œë²„íŠ¼ êµ¬í˜„í•˜ê¸°
- ì‚­ì œ ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ ì•„ë˜ì˜ í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•œë‹¤.
- ì´ë•Œ ì‚­ì œ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ìˆ¨ê²¨ì§„ html í¼ì„ ë™ì ìœ¼ë¡œ ìƒì„±í•˜ì—¬ í¼ì„ ì œì¶œí•œë‹¤.
- ìš°ì„  ê¸°ë³¸ html ì—ì„œëŠ” method="DELETE", method="PUT"ê°€ ì§€ì›ì„ í•˜ì§€ ì•Šì•„ì„œ delete ëª…ë ¹ì„ ë°”ë¡œ ë³´ë‚¼ ìˆ˜ ì—†ê³  _method ì´ë ‡ê²Œ ê°ì¶°ì§„ method ì†ì„±ìœ¼ë¡œ deleteë¥¼ ë³´ë‚´ëŠ” ê²ƒì´ë‹¤.
- ê·¸ëŸ¬ë©´ restfull ê·œì•½ì— ë§ê²Œ ì‚­ì œ ìš”ì²­ì„ postë°©ì‹ìœ¼ë¡œ ë³´ë‚¼ ìˆ˜ ìˆê²Œëœë‹¤.
- 
```js
function deleteDepartment(e) {
    e.preventDefault();

    if (!confirm(`${e.currentTarget.dataset.dname} í•™ê³¼ë¥¼ ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
        return;
    }

    // í´ë¦­ëœ ë§í¬ì˜ href ì†ì„±ê³¼ data-id ì†ì„±ì„ ê°€ì ¸ì˜´
    const url = e.currentTarget.getAttribute('href');
    const id = e.currentTarget.dataset.id;

    // formì„ ë™ì ìœ¼ë¡œ ìƒì„±í•˜ì—¬ POST ìš”ì²­ìœ¼ë¡œ DELETE ìš”ì²­ì„ ë³´ëƒ„
    const form = document.createElement('form');
    form.style.display = 'none';
    form.method = 'POST';
    form.action = url;

    // DELETE ìš”ì²­ì„ ìœ„í•´ _method í•„ë“œë¥¼ ì¶”ê°€
    // (ì´ ë¶€ë¶„ì€ ì„œë²„ì—ì„œ DELETE ë©”ì„œë“œë¥¼ ì§€ì›í•˜ëŠ” ê²½ìš°ì— í•„ìš”)
    // --> application.propertiesì— spring.mvc.hiddenmethod.filter.enabled=true ì„¤ì • í•„ìš”
    // --> Spring Bootì—ì„œ @GetMappingìœ¼ë¡œ ì—°ê²°í•  ìˆ˜ ìˆê²Œ ëœë‹¤.
    const input = document.createElement('input');![](https://velog.velcdn.com/images/hyungyugod/post/be59cc66-a051-46e7-8960-b5e61a20d055/image.png)

    input.type = 'hidden';
    input.name = '_method';
    input.value = 'DELETE';
    form.appendChild(input);

    // í•™ê³¼ IDìš© hidden í•„ë“œë„ ì¶”ê°€
    const idInput = document.createElement('input');
    idInput.type = 'hidden';
    idInput.name = 'id';
    idInput.value = id;
    form.appendChild(idInput);

    // <form> íƒœê·¸ë¥¼ bodyì— ì¶”ê°€í•˜ê³  ì „ì†¡
    document.body.appendChild(form);
    form.submit();
}
```