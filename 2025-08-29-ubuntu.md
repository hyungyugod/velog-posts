# 📌 0. vi
### 📌 0-1. vi에 대해서
- 리눅스용 메모장이다.
- 아래는 새로운 vi파일을 만드는 과정이다.
```yaml
# 새 파일 생성 또는 기존 파일 열기
$ vi filename.txt
# 읽기 전용으로 열기
$ view filename.txt
$ vi -R filename.txt
# 특정 줄 번호로 열기
$ vi +10 filename.txt # 10번째 줄로 이동
$ vi +/pattern filename.txt # 'pattern' 검색 결과로 이동
# 복구 모드로 열기 (비정상 종료된 파일)
$ vi -r filename.txt
```
- vi 파일이름으로 vi 파일을 열 수 있다.
- 이후 i나 a로 커서 위치에서 수정을 진행한 후 esc로 빠져나오고 :wq로 저장하고 나간다.
- 만약 수정을 안했으면 그냥 q로 나가도 된다.
- q!면 저장을 하지 않고 밖으로 나가게 된다.
```yaml
# 1. vi로 새 파일 열기
$ vi first_practice.txt
# 2. 입력 모드로 진입 (i 키 누르기)
# 화면 하단에 -- INSERT -- 가 표시됨
# 3. 다음 텍스트 입력
Hello Ubuntu!
This is my first VI editing practice.
Learning VI editor is essential for Linux.
# 4. ESC 키를 눌러 명령 모드로 돌아가기
# 5. 파일 저장하고 종료: :wq 입력 후 Enter
```

### 📌# Vim 모드 전환 요약표

| 현재 모드     | 목표 모드      | 키 입력 | 설명                                |
|---------------|----------------|---------|-------------------------------------|
| 명령 모드     | 입력 모드      | `i`     | 커서 위치에서 입력 시작             |
| 명령 모드     | 입력 모드      | `a`     | 커서 다음 위치에서 입력 시작        |
| 명령 모드     | 입력 모드      | `o`     | 새 줄 추가 후 입력 시작             |
| 입력 모드     | 명령 모드      | `ESC`   | 명령 모드로 돌아가기                |
| 명령 모드     | 라인 명령 모드 | `:`     | 화면 하단에 `:` 프롬프트 열기       |
| 라인 명령 모드| 명령 모드      | `ESC` 또는 명령 실행 | 명령 실행 후 명령 모드로 돌아가기 |

### 📌 0-2. 삭제 명령어 

| 키    | 설명                  | 예시 결과                            |
| ---- | ------------------- | -------------------------------- |
| `x`  | **커서 위치의 문자 삭제**    | `Hello` → `Hell`                 |
| `X`  | **커서 앞의 문자 삭제**     | `Hello` → `ello`                 |
| `dw` | **커서부터 단어 끝까지 삭제**  | `Hello world` → `world`          |
| `db` | **커서부터 단어 시작까지 삭제** | `Hello world` → `world` (앞부분 삭제) |
| `dd` | **현재 줄 전체 삭제**      | 줄 전체가 제거됨                        |
| `D`  | **커서부터 줄 끝까지 삭제**   | `Hello world` → `Hello`          |

### 📌 0-3. 변경 명령어

| 키    | 설명                     | 동작                                |
| ---- | ---------------------- | --------------------------------- |
| `cw` | **단어 변경**              | 커서 위치부터 단어 끝까지 삭제 후 **입력 모드로 전환** |
| `cc` | **줄 변경**               | 현재 줄 전체 삭제 후 **입력 모드로 전환**        |
| `C`  | **줄 끝까지 변경**           | 커서 위치부터 줄 끝까지 삭제 후 **입력 모드 전환**   |
| `c$` | **줄 끝까지 변경** (`C`와 동일) | 커서 위치부터 줄 끝까지 삭제 후 **입력 모드 전환**   |
| `c0` | **줄 시작까지 변경**          | 커서 위치부터 줄 시작까지 삭제 후 **입력 모드 전환**  |

### 📌 0-4. 복사 붙여넣기, 실행취소
- 복사

| 키    | 설명                 | 사용 예시                  |
| ---- | ------------------ | ---------------------- |
| `yy` | **현재 줄 복사**        | 전체 줄을 복사               |
| `yw` | **현재 단어 복사**       | 커서 위치의 단어만 복사          |
| `y$` | **커서부터 줄 끝까지 복사**  | 줄의 뒷부분 복사              |
| `y0` | **커서부터 줄 시작까지 복사** | 줄의 앞부분 복사              |
| `yG` | **커서부터 파일 끝까지 복사** | 현재 위치부터 파일 마지막까지 전체 복사 |

- 붙여넣기

| 키   | 설명                          | 붙여넣기 위치     |
| --- | --------------------------- | ----------- |
| `p` | **붙여넣기** – 커서 **다음 위치**에 삽입 | 문자 뒤 / 줄 아래 |
| `P` | **붙여넣기** – 커서 **이전 위치**에 삽입 | 문자 앞 / 줄 위  |

- 실행취소

| 키          | 설명                       | 활용                 |
| ---------- | ------------------------ | ------------------ |
| `u`        | **마지막 동작 실행 취소 (undo)**  | 방금 한 실수 복구         |
| `U`        | **현재 줄의 모든 변경 취소**       | 해당 줄 전체를 원래 상태로 복구 |
| `Ctrl + r` | **되돌린 동작을 다시 실행 (redo)** | 실행 취소한 내용을 다시 복원   |

### 📌 0-5. 검색과 치환

| 명령어        | 설명                                        | 검색 방향 |
| ---------- | ----------------------------------------- | ----- |
| `/pattern` | **패턴 검색** – 커서 위치부터 \*\*아래쪽(앞→뒤)\*\*으로 검색 | 아래 방향 |
| `?pattern` | **패턴 검색** – 커서 위치부터 \*\*위쪽(뒤→앞)\*\*으로 검색  | 위 방향  |
| `n`        | **다음 검색 결과로 이동** (현재 검색 방향 유지)            | 현재 방향 |
| `N`        | **이전 검색 결과로 이동** (검색 방향 반대)               | 반대 방향 |

# 📌 1. 서비스
### 📌 1-1. 서비스와 데몬
- 눈에 안보이는데 뒤에서 계속 돌고있는 백그라운드 프로세스를 리눅스에서는 데몬이라고 부른다.
- 기본 서비스 제어 명령은 아래와 같다.

| 명령어                           | 설명                           | 예시                               |
| ----------------------------- | ---------------------------- | -------------------------------- |
| `sudo systemctl start 서비스명`   | 서비스 시작                       | `sudo systemctl start apache2`   |
| `sudo systemctl stop 서비스명`    | 서비스 중지                       | `sudo systemctl stop apache2`    |
| `sudo systemctl restart 서비스명` | 서비스 재시작 (중지 후 다시 시작)         | `sudo systemctl restart apache2` |
| `sudo systemctl reload 서비스명`  | 서비스 설정 파일만 다시 로드 (재시작 없이 적용) | `sudo systemctl reload apache2`  |

### 📌 1-2. ubuntu 패키지
- Ubuntu의 패키지 관리는 APT(Advanced Package Tool) 를 기반으로 한다.

| 명령어                                      | 설명                                 |
| ---------------------------------------- | ---------------------------------- |
| `sudo apt-get update`                    | **저장소 목록 갱신** (새로운 패키지 설치 전 실행 권장) |
| `sudo apt-get upgrade`                   | 설치된 패키지 **최신 버전으로 업그레이드**          |
| `sudo apt-get install 패키지이름`             | **새 패키지 설치**                       |
| `sudo apt-get --reinstall install 패키지이름` | **패키지 재설치**                        |
| `sudo apt-get remove -y 패키지이름`           | 패키지 삭제 (**설정 파일은 유지**)             |
| `sudo apt-get purge -y 패키지이름`            | 패키지 삭제 + **설정 파일까지 삭제**            |
| `sudo apt-cache search 패키지이름`            | 패키지 **검색**                         |
| `sudo apt-cache show 패키지이름`              | 패키지 **상세 정보 확인**                   |
| `sudo apt-get autoremove`                | 사용하지 않는 **불필요한 패키지 제거**            |
| `sudo apt-get clean`                     | 다운로드한 설치 파일 전부 삭제                  |
| `sudo apt-get autoclean`                 | 더 이상 설치 불가능한 오래된 패키지 캐시만 삭제        |

# 📌 2. 방화벽
### 📌 2-1. 네트워크 관련 명령어

| 명령어            | 설명                             | 비고                              |
| -------------- | ------------------------------ | ------------------------------- |
| `ifconfig`     | IP 주소 확인 (net-tools 설치 필요)     | `ifconfig enp0s5` → 특정 인터페이스 확인 |
| `ping 주소`      | 대상 호스트에 패킷 전송하여 **네트워크 연결 확인** | 정상 응답 = 연결 O / 응답 없음 = 연결 불가    |
| `Ctrl + C`     | 실행 중인 `ping` 종료                | 종료 시 전송/수신 패킷 통계 표시             |
| `nslookup 도메인` | **DNS 조회** – 도메인에 대한 IP 주소 확인  | 예: `nslookup google.com`        |

### 📌 2-2. 방화벽 관리 명령어

| 명령어                         | 설명                                                                      | 예시                                                   |
| --------------------------- | ----------------------------------------------------------------------- | ---------------------------------------------------- |
| `sudo ufw enable`           | 방화벽 활성화                                                                 |                                                      |
| `sudo ufw disable`          | 방화벽 비활성화                                                                |                                                      |
| `sudo ufw status`           | 방화벽 상태 확인                                                               |                                                      |
| `sudo ufw default deny`     | 모든 외부 접속 차단                                                             | 기본 권장 설정                                             |
| `sudo ufw default allow`    | 모든 외부 접속 허용                                                             | 보안상 권장하지 않음                                          |
| `sudo ufw allow [포트번호]`     | 특정 포트 허용                                                                | `sudo ufw allow 22` (SSH), `sudo ufw allow 2222/tcp` |
| `sudo ufw allow [시작:끝]/tcp` | 포트 범위 허용                                                                | `sudo ufw allow 3000:3010/tcp`                       |
| `sudo ufw allow from [IP]`  | 특정 IP에서 접근 허용                                                           | `sudo ufw allow from 123.4.56.7`                     |
| `sudo ufw deny from [IP]`   | 특정 IP 차단                                                                | `sudo ufw deny from 123.45.6.78`                     |
| `sudo ufw delete [rule]`    | 방화벽 규칙 삭제                                                               | `sudo ufw delete allow 2222/tcp`                     |
| `sudo ufw reload`           | 방화벽 규칙 다시 로드 (적용)                                                       | 규칙 수정 후 반드시 실행                                       |
| `sudo ufw reset`            | 방화벽 규칙 초기화                                                              | 모든 설정 초기화                                            |
| **Ping 차단**                 | `/etc/ufw/before.rules` 파일에서 `ACCEPT` → `DROP`으로 수정 후 `sudo ufw reload` | ICMP(ping) 차단                                        |

# 📌 3. VSFTPD
### 📌 3-1. FTP 서비스의 종류

| 구분         | OS      | 예시                                                    |
| ---------- | ------- | ----------------------------------------------------- |
| **Server** | Linux   | `vsftpd`, `proftpd` (→ proftpd는 설정 쉬움, vsftpd는 성능 우수) |
| **Client** | Linux   | `ncftp`, `lftp`                                       |
| **Client** | Windows | 알FTP, 알드라이브 (무료)                                      |
| **Client** | MacOS   | CyberDuck (유료)                                        |
| **Client** | 공용      | FileZilla (무료/유료)                                     |

### 📌 3-2. FTP 접속 사용자 유형

| 유형                     | 설명                                   |
| ---------------------- | ------------------------------------ |
| **일반 사용자**             | 리눅스 계정을 그대로 사용, 각자 홈 디렉토리 안에서만 작업 가능 |
| **익명 사용자 (anonymous)** | 기본 등록됨, 비밀번호 없음, 보안상 취약 → 실무에서는 차단   |

### 📌 3-3. FTP 전송 모드'

| 모드         | 특징                          | 포트                             |
| ---------- | --------------------------- | ------------------------------ |
| **액티브 모드** | 접속과 데이터 전송 각각 1개 포트 사용      | 접속: 21 / 데이터: 20               |
| **패시브 모드** | 데이터 전송에 여러 포트 사용 → 전송 효율 높음 | 접속: 21 / 데이터: 1024번 이후 (설정 가능) |

### 📌 3-4. vsftpd 서비스 설치 및 설정
- 설치
```bash
sudo apt-get install vsftpd
```
- 주요설정
```bash
chroot_local_user=YES          # 홈 디렉토리까지만 접근 제한
allow_writeable_chroot=YES     # 홈 디렉토리에 쓰기 허용
write_enable=YES               # 쓰기 가능
local_umask=022                # 기본 umask
file_open_mode=0644            # 파일 기본 퍼미션
listen_port=9902               # 접속 포트 변경
pasv_enable=YES                # 패시브 모드 활성화
pasv_min_port=10100            # 패시브 최소 포트
pasv_max_port=10200            # 패시브 최대 포트
```
- 서비스 제어
```bash
sudo systemctl start vsftpd      # 서비스 시작
sudo systemctl status vsftpd     # 상태 확인
sudo systemctl enable vsftpd     # 부팅 시 자동 실행
```
- 방화벽설정
```bash
sudo ufw allow 9902/tcp
sudo ufw allow 10100:10200/tcp
sudo ufw reload
sudo ufw status
```
- 이후 파일질라와 연결하여 클라이언트 접속을 확인해본다.
- 설정을 잘못한 경우에는 아래 방법으로 삭제한다.
```bash
sudo systemctl stop vsftpd        # 서비스 중지
sudo systemctl disable vsftpd     # 자동 실행 해제
sudo apt-get purge -y vsftpd      # 설정파일 포함 삭제
```

