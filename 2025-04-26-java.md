# ğŸ“Œ 1. ì˜ì‚¬ - ì§„ë£Œê¸°ë¡ ì„œë¹„ìŠ¤ ë§ˆë¬´ë¦¬
- ì¼ë‹¨ ì´ ì‘ì—…ì€ ì˜ì‚¬ - ì§„ë£Œê¸°ë¡ê¹Œì§€ í•˜ê³  ì •ë¦¬í•˜ë„ë¡ í•˜ê² ë‹¤.
- ì˜ì‚¬ ì„œë¹„ìŠ¤ì—ì„œ í•´ë‹¹ ì˜ì‚¬ë¥¼ ì‚­ì œí•˜ë©´ ê·¸ ì˜ì‚¬ê°€ í¬í•¨ëœ ì§„ë£Œê¸°ë¡ë“¤ì„ ìš°ì„  ì‚­ì œí•˜ê³  ì´í›„ ì‚­ì œí•˜ëŠ” ë°©ì‹ì„ ì‚¬ìš©í•˜ë„ë¡ í•˜ê² ë‹¤.

### ğŸ“Œ 1-1. doctorMapper
- ì¼ë°˜ì ì¸ mapperì´ë‹¤. ë‹¤ë§Œ optionsì—ì„œ ìë™ìƒì„±í‚¤ë¥¼ ìë™ìœ¼ë¡œ í™•ë³´í•´ì£¼ëŠ” ì˜µì…˜ì€ doctorí…Œì´ë¸”ì˜ ê¸°ë³¸í‚¤ê°€ ë³µí•© ê¸°ë³¸í‚¤ì¸ë°ë‹¤ê°€ auto_incrementë„ ì•„ë‹ˆì–´ì„œ êµ³ì´ ê±¸ì–´ì¤„ í•„ìš”ê°€ ì—†ì–´ì„œ ì œì™¸í•˜ì˜€ë‹¤.
```java
@Mapper
public interface DoctorMapper {
    @Insert(" INSERT INTO doctor (DR_NAME, DR_ID, LCNS_NO, HIRE_YMD, MCDP_CD, TLNO) "
              + "values (drName, drId, lcnsNo, hireYmd, mcdpCd, tlno);"
    )
       // ìë™ìƒì„±í‚¤ê°€ ì•„ë‹ˆë¯€ë¡œ optionsëŠ” êµ³ì´ì„.
    public int insert(Doctor input);

    @Update("UPDATE doctor SET " +
           "DR_NAME = #{drName}, DR_ID = #{drId}, LCNS_NO = #{lcnsNo}, HIRE_YMD = #{hireYmd}, MCDP_CD = #{mcdpCd}, TLNO = {tlno}" +
           "WHERE DR_ID = #{drId}")
    public int update(Doctor input);

    @Delete("DELETE FROM doctor WHERE DR_ID = #{drId}")
    public int delete(Doctor input);

   
    @Results(id="resultMap", value={
        @Result(property="drName", column="DR_NAME"),
        @Result(property="drId", column="DR_ID"),
        @Result(property="lcnsNo", column="LCNS_NO"),
        @Result(property="hireYmd", column="HIRE_YMD"),
        @Result(property="mcdpCd", column="MCDP_CD"),
        @Result(property="tlno", column="TLNO")
    })
    @Select("SELECT DR_NAME, DR_ID, LCNS_NO, HIRE_YMD, MCDP_CD, TLNO FROM doctor " +
    "WHERE DR_ID = #{drId}")
    public Doctor selectOne(Doctor input);

    @Select("<script>"+
           "SELECT DR_NAME, DR_ID, LCNS_NO, HIRE_YMD, MCDP_CD, TLNO FROM doctor" +
           "<where>" +
           "    <if test=\"drId != null and drId != ''\">...</if>" +
           "</where>" +
           "</script>")
    @ResultMap("resultMap")
    public List<Doctor> selectList(Doctor input);

    @Select("<script>" +
           "SELECT COUNT(*) FROM doctor" +
           "<where>" +
           "    <if test=\"drId != null and drId != ''\">...</if>" +
           "</where>" +
           "</script>")
    public int selectCount(Doctor input);
}
```

### ğŸ“Œ 1-2. doctorë¥¼ ì§€ìš°ê¸° ìœ„í•œ appointmentMapper
- appointment í…Œì´ë¸”ì´ doctorë¥¼ ì°¸ì¡°í•˜ì—¬ doctor idê°€ appointment í…Œì´ë¸”ì˜ ì°¸ì¡°í‚¤ê°€ ë˜ë¯€ë¡œ ìš°ì„  appointmentì˜ ì™¸ë˜í‚¤ë¥¼ ì‚­ì œí•´ì•¼í•œë‹¤. 
- ì´ëŠ” mddridë¥¼ ì‚­ì œí•˜ê¸° ìœ„í•œ mapperì˜ ì¼ë¶€ë¶„ì´ë‹¤.
```java
@Data
public class Appointment {
    private LocalDateTime apntYmd; // ì§„ë£Œ ì˜ˆì•½ ì¼ì‹œ
    private int apntNo; // ì§„ë£Œ ì˜ˆì•½ ë²ˆí˜¸
    private String ptNo; // í™˜ìë²ˆí˜¸
    private String mcdpCd; // ì§„ë£Œê³¼ ì½”ë“œ
    private String mddrId; // ì˜ì‚¬ ID
    private String apntCnclYn; // ì˜ˆì•½ì·¨ì†Œ ì—¬ë¶€
    private LocalDateTime apntCnclYmd; // ì˜ˆì•½ì·¨ì†Œë‚ ì§œ
}
```

### ğŸ“Œ 1-3. doctorserviceimpl
- ì •ì„ëŒ€ë¡œ í•œë²ˆ ì‹¹ ë§Œë“¤ì—ˆë‹¤.
```java
public class DocorserviceImpl implements DoctorService {
    DoctorMapper doctorMapper = null;
    AppointmentMapper appointmentMapper = null;
    

    public DocorserviceImpl(SqlSession sqlSession){
        doctorMapper = sqlSession.getMapper(DoctorMapper.class);
        appointmentMapper = sqlSession.getMapper(AppointmentMapper.class);
    }    

    @Override
    public Doctor addItem(Doctor params) throws ServiceNoResultException, Exception {
        if (doctorMapper.insert(params) == 0){
            throw new ServiceNoResultException("ì‘ë™ ê²°ê³¼ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
        }
        return doctorMapper.selectOne(params);
    }

    @Override
    public Doctor editItem(Doctor params) throws ServiceNoResultException, Exception {
        if (doctorMapper.update(params) == 0){
            throw new ServiceNoResultException("ì‘ë™ ê²°ê³¼ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
        }
        return doctorMapper.selectOne(params);
    }

    @Override
    public int getCount(Doctor params) throws ServiceNoResultException, Exception {
        return doctorMapper.selectCount(params);
    }

    @Override
    public Doctor getItem(Doctor params) throws ServiceNoResultException, Exception {
        Doctor output = null;
        output = doctorMapper.selectOne(params);

        if (output == null){
            throw new ServiceNoResultException("ì‘ë™ ê²°ê³¼ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
        }

        return output;
    }

    @Override
    public List<Doctor> getList(Doctor params) throws ServiceNoResultException, Exception {
        return doctorMapper.selectList(params);
    }

    @Override
    public int deleteItem(Doctor params) throws ServiceNoResultException, Exception {
    // ìš°ì„  appointmapper ì‚­ì œ
    Appointment appointment = new Appointment();
    appointment.setMddrId(params.getDrId());
    appointmentMapper.deleteByDoctor(appointment);

    // doctor ì‚­ì œ
    int output = doctorMapper.delete(params);

    if (output == 0){
        throw new ServiceNoResultException("ì‘ë™ ê²°ê³¼ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
    }
        return output;
    }
}
```

