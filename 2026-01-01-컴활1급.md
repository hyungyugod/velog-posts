# 📌 1. 기본작업(필터 · 조건부서식 · 보호) — “표를 데이터베이스처럼 다루는 파트”
## 1-1. 고급필터(Advanced Filter)
- **실행 흐름**
  - 데이터 범위(표 안 아무 셀) 클릭 → **데이터 > 고급**
  - “다른 위치에 복사”를 선택하고 **복사 위치에 ‘필드명(헤더)’을 먼저 블록 지정**한다.
- **핵심 원리(왜 필드명을 먼저 잡나?)**
  - 엑셀은 복사 위치에 적힌 필드명을 보고 **결과 표의 스키마(schema, 결과 컬럼 구조)** 를 확정한다.
  - 즉, “아, 이 사람이 만들고 싶은 결과 표의 컬럼이 이거구나”를 먼저 알려주는 행위다.
- **와일드카드/패턴**
  - `전임*` : “전임”으로 시작
  - `?` : **정확히 1글자** (SQL의 `_`와 유사)
- **조건 작성 2가지**
  1) **필드명 기반 조건**: 헤더 아래에 조건값을 적는 일반 방식  
  2) **논리식(=논리식) 조건**: 헤더를 `조건1`, `조건2`처럼 두고 수식으로 조건을 건다  
     - 예: `=F13>=AVERAGE($F$4:$F$12)`  
     - 이유: 고급필터는 내부적으로 조건을 “아래로 채우기”처럼 해석하므로, 비교 대상 셀이 상대적으로 움직이게 설계된다.
- **문자열 결합(&)로 비교 연산 만들기**
  - 평균 이상 조건 예: `=">="&AVERAGE(범위)`
  - 설계 의도: 조건 칸은 “문자열 형태의 조건식”을 받는 경우가 많아서 `>=` 같은 연산자도 문자열로 결합해 넣는다.
- **자잘하지만 자주 나오는 팁**
  - 복사(Ctrl+C) 상태는 **Esc**로 해제 가능

## 1-2. 조건부서식(Conditional Formatting)
- **블록 설정은 위 → 아래가 안전**
  - 조건부서식은 “각 셀에 개별 규칙”이 아니라 **기준 셀 하나의 수식을 기준으로 상대 복제**한다.
  - 그래서 범위를 위에서 아래로 잡고, 수식은 **범위의 첫 행(대표 행)** 기준으로 쓰는 게 실수 방지에 유리하다.
- **수식 작성 규칙(상대/절대의 감각)**
  - 수식은 “적용 범위의 첫 셀” 기준으로 작성한다.
  - 작성 후 주소가 `$`로 절대화되면, **움직여야 할 축(행/열)은 `$`를 풀어 상대화**한다.
  - 조건부서식은 아래로만이 아니라 **옆으로도 복제**될 수 있어 주소 고정이 더 섬세해야 한다.
- **와일드카드 직접 사용은 제한적**
  - 조건부서식은 고급필터처럼 `전임*`를 직접 쓰기보다, **수식으로 처리**하는 경우가 안정적이다.
  - 예: `=LEFT(C3,2)="전임"`
- **AND/OR 작성**
  - AND는 `AND(조건1,조건2,...)`처럼 콤마로 구분
  - OR는 `OR(조건1,조건2,...)`
  - 주의: 함수 마법사에서 비교연산(예: `<=6`) 쓸 때 **부등호 주변 띄어쓰기 금지**
- **색 관련**
  - “음영색” = 채우기 색  
  - “무늬색”은 마우스 오버로 색 이름 확인 가능

## 1-3. 시트보호 vs 통합문서 보호
- **시트보호**
  - 시트 안의 데이터(셀) **수정/삭제 등 작업을 제한**하는 보호
  - `Ctrl+1`(셀 서식)에서 **잠금/수식 숨김**을 설정해둔 뒤, 보호를 켜면 적용된다.
- **통합문서 보호(구조/창)**
  - “구조” 체크: 시트 **삽입/삭제/이름 변경** 같은 시트 단위 구조 변경을 막는다.
- **엑셀의 설계 철학**
  - 기본적으로 모든 셀은 “잠금 가능 상태”로 되어 있다.  
  - 보호를 켜는 순간 **기본값은 ‘막힘’이 안전**하다는 보안 우선 설계다.
- **실무형 작업 순서(시험에 자주 맞음)**
  1) 전체 선택 → 잠금 해제  
  2) 잠가야 할 특정 열/범위만 다시 잠금  
  3) 시트보호 실행

---

# 📌 2. 계산작업(함수) — “문제는 요구조건, 해법은 조합”
## 2-1. 텍스트 가공: 뒤 2글자 제거 + 대문자
- 포인트: 인수가 많으면 **함수 마법사**, 조합은 **주어진 함수로**
- 예: `=UPPER(LEFT(A4,LEN(A4)-2))`
- 이후 채우기 핸들로 복사

## 2-2. 순위(RANK.EQ)로 상·중·하 분류
- 절대참조 필수: 순위 범위가 밀리면 결과가 붕괴한다.
  - 예: `RANK.EQ(D12,$D$4:$D$12,0)`
- `RANK.EQ` 특징
  - 동일 값은 동일 등수
  - 그 다음 등수는 “건너뛰는” 방식(예: 1,1,3…)
- 분기(IF) 결합 예시 포인트
  - 함수 마법사에서 문자 인수는 자동으로 큰따옴표가 붙는다.
  - 인수 칸에서 다른 함수를 넣을 땐, 인수 칸에 커서를 두고 함수 목록에서 선택하면 해당 인수용 마법사가 뜬다.

## 2-3. 최대값 위치의 다른 열 값 찾기: INDEX + MATCH
- MATCH: 범위에서 값의 **위치(인덱스)** 를 찾는다.
  - `0` = 정확히 일치, `1` = 근사값(정렬 전제)
- INDEX: 범위의 **행/열 위치의 값**을 꺼낸다.
- 대표 예:
  - `=INDEX(A4:A12, MATCH(MAX(D4:D12), D4:D12, 0), 1)`
- 팁
  - 채우기를 안 하면 절대화가 덜 중요하지만, 시험에서는 **안전하게 절대화**하는 습관이 점수 방어에 좋다.

## 2-4. VLOOKUP + MATCH 조합(열 인덱스 동적화)
- VLOOKUP은 “찾는 값이 참조표의 첫 열”이어야 한다.
- 바뀌면 안 되는 참조 범위는 F4로 절대화
- 열 인덱스를 MATCH로 구하기:
  - `=VLOOKUP(B6,$B$31:$E$35, MATCH(F6,$B$31:$E$31,0), 0)`
- 자주 터지는 함정
  - 표 구조에 따라 MATCH로 구한 위치와 VLOOKUP 열 번호가 1 차이 나는 경우가 있어,
    - (1) MATCH 범위를 헤더/빈칸 포함으로 재설계하거나
    - (2) 결과에 `+1` 보정이 필요할 때가 있다.

---

# 📌 3. 배열수식(CTRL+SHIFT+ENTER) — “셀 하나 계산이 아니라, 범위를 한 번에 사고하기”
## 3-1. SUM(IF()) 형태(조건으로 합계)
- 조건 범위는 보통 **절대화**가 안전
- 예:
  - `{=SUM(IF($C$4:$C$12=$A15, $D$4:$D$12))}`
- 입력 방식
  - 수식 입력 후 **Ctrl+Shift+Enter**
  - (시험 버전에서 배열수식 유지되는 환경 기준)

## 3-2. 곱셈/덧셈 논리(AND/OR의 배열식)
- 형태 1) `=계산함수(IF(조건, 계산범위))`
- 형태 2) `=계산함수((조건)*(계산범위))`
  - AND는 `*` (둘 다 1이어야 1)
  - OR는 `+` (둘 중 하나면 1 이상)
  - 개수 세기는 계산범위를 `1`로 두는 방식이 자주 나온다.
- 예:
  - `{=MAX(IF(($C$3:$C$18=C$23)*($B$3:$B$18=$B24), $I$3:$I$18))}`

## 3-3. INDEX/MATCH 배열 응용(조건에 맞는 열만 남기기)
- “찾을 배열”에도 조건을 걸어 **원치 않는 열/행을 0으로 날려버리고** MATCH를 수행한다.
- 예(구조 이해용):
  - `{=INDEX($D$3:$D$18, MATCH(MAX(($B$3:$B$18=$B41)*(L$3:L$18)), ($B$3:$B$18=$B41)*(L$3:L$18), 0), 1)}`

---

# 📌 4. 분석작업(피벗 · 정렬 · 부분합 · 유효성) — “표를 ‘구조’로 재구성하는 기능들”
## 4-1. 피벗테이블 핵심 조작
- 표 안 셀에 커서만 있어도 범위 인식이 자동으로 된다.
  - 단, “표 제목”이 붙어 있거나 구조가 애매하면 범위 인식이 꼬일 수 있다.
- 레이아웃/부분합 서식
  - 개요 형식: 그룹 아래부터 데이터가 보이는 느낌
  - 테이블 형식: 그룹명 바로 옆부터 데이터가 보이는 느낌
- 보고서 서식(자동서식)
  - 시험에서 요구하는 “해당 명령”을 반드시 써야 점수가 나오는 경우가 있어,
  - 빠른 실행 도구 모음에 “모든 명령”에서 찾아 추가해두는 전략이 유리하다.
- 그룹화(날짜/숫자)
  - 범위 블록으로 그룹화하는 게 아니라,
  - **셀 하나 클릭 → 우클릭 → 그룹**으로 시작/끝/간격을 지정하는 방식이 자주 맞다.
- 피벗 옵션
  - 빈 셀 표시, 행/열 총합계, 값 필드 위치(시그마 값 위치) 등을 옵션에서 조정 가능

## 4-2. 정렬/필터/부분합에서 “필드명 포함”이 중요한 이유
- 필드명까지 선택해야 하는 기능들: 정렬, 필터, 고급필터, 부분합, 피벗 등 “DB스러운 기능”
- 핵심 차이
  - **필드명이 포함되면** 데이터는 단순 덩어리가 아니라 **속성을 가진 레코드 집합**이 된다.
  - 그러면 엑셀은 “무엇을 기준으로?”를 판단할 수 있어 구조적 처리가 가능해진다.
- 부분합 작업 순서
  1) 문제의 정렬 조건을 먼저 모두 처리
  2) 그 다음 부분합
- 부분합의 설계 철학
  - 부분합은 누적 덧셈이 아니라 **표 전체를 다시 해석해 ‘구조를 재작성’**하는 작업에 가깝다.
  - 그래서 재적용/재계산 때 **전체개요까지 함께 선택**하라는 요구가 자주 나온다.

## 4-3. 데이터 유효성 검사 + 자동필터 구분
- 유효성 검사 메세지
  - 클릭 시 뜨는 메세지 = **설명 메세지**
  - 잘못 입력 시 뜨는 메세지 = **오류 메세지**
  - 시험은 아이콘/띄어쓰기까지 디테일 채점이 걸릴 수 있어 그대로 맞추는 게 중요
- 필터
  - 그냥 “필터”면 대개 **자동필터(화살표)** 를 의미
  - 날짜 필터 → 사용자 지정 필터에서 조건 입력 가능

---

# 📌 5. 차트작업 — “데이터(계열) vs 좌표(가로축) 구분이 반은 먹고 들어감”
## 5-1. 데이터 선택에서 ‘계열’과 ‘가로축 레이블’의 근본 차이
- 계열(Series)
  - 추가/삭제 가능한 **데이터 객체**
- 가로축 레이블(Category axis labels)
  - 차트 전체가 공유하는 **좌표 기준(축의 정의)**
  - 그래서 데이터 선택 창에서 가로축 레이블은 “추가/삭제 버튼”이 없는 경우가 생긴다.
- 해결법
  - **행/열 전환**으로 축 기준을 뒤집어 문제를 해결
  - 또는 Ctrl로 필요한 범위만 다시 지정해 차트를 재구성

## 5-2. 실전 조작 모음
- 차트 종류 변경: 차트 영역 우클릭 → 차트 종류 변경
- 레이블 추가: 레이블 요소 클릭 → 우클릭 → 데이터 레이블 서식
- 텍스트를 셀과 연동: 텍스트 상자 선택 후 수식 입력줄에서 `=셀참조`
- 도넛 차트
  - “구멍 크기/각도” 등은 **데이터 계열 서식**에서 설정
  - 더블클릭하면 전체가 아니라 “조각”만 선택되어 분리 가능
- 범례 위치 변경: 범례 서식에서 조정
- 배경/요소 색: 각 요소 서식에서 개별 지정(또는 상단 페인트통)

---

# 📌 6. 매크로 작업(기록 · 서식 · 컨트롤) — “반복을 코드로 박제하기”
## 6-1. 매크로 기록 전/후 ‘빈 셀 클릭’의 의미
- 시작 전에 빈 공간 클릭
  - “여긴 데이터가 아니다. 지금부터는 구조/작업을 시작한다”는 신호가 되어,
  - 기록된 매크로가 의도치 않게 데이터 범위를 끌고 가지 않게 돕는다.
- 끝날 때도 빈 공간 클릭
  - 마지막 선택이 데이터 위에 남아 있으면 이후 작업에서 참조가 꼬일 수 있어 깔끔하게 마무리

## 6-2. 양식 컨트롤 vs ActiveX
- 양식 컨트롤(Form Controls)
  - “셀 값을 바꾸는 간단한 스위치/트리거”
  - 시험에서 빠르고 안정적
- ActiveX 컨트롤
  - “이벤트 기반 미니 프로그램”
  - 외부 컴포넌트(컨트롤 기술) 성격이 강해 세밀하지만 변수가 늘어난다.
- 버튼/도형 배치 팁
  - Alt를 누르고 그리면 셀 격자에 딱 맞춰 배치
  - 도형은 **우클릭 → 매크로 지정**에서 직접 연결해야 한다.

## 6-3. 사용자 지정 표시형식(서식 기호)
- 구조: `양수;음수;0;문자열`
- `#` : 값이 없으면 공백
- `0` : 값이 없으면 0 출력
- `@` : 문자 표시(패턴 매칭에서 와일드카드처럼 언급되기도 함)
- `Ctrl+1` → “일반” 선택 시 서식 해제

## 6-4. 조건부서식 매크로가 누를 때마다 규칙이 쌓이는 이유
- 조건부서식은 “덮어쓰기 1개”가 아니라 **규칙 집합(rule set)** 이다.
- 기록된 매크로는 보통 “새 규칙 추가” 동작을 다시 실행하므로 규칙이 계속 누적된다.
- 해결: 규칙 관리자에서 불필요한 규칙을 정리해 “1개만 남기기”

---

# 📌 7. VBA(사용자정의함수 · 폼/프로시저) — “엑셀을 ‘앱’처럼 쓰는 구간”
## 7-1. 사용자 정의 함수(UDF) 기본
- Alt+F11 → VBA 편집기
- **새 함수는 모듈(Module)에서 작성**하는 게 안전(시험에서도 사실상 필수처럼 나옴)
- 반환(return)은 `함수명 = 값` 대입 방식
- 주석은 작은따옴표(`'`)

### (예) 총매출
```vba
Public Function fn총매출(단가, 할인율, 판매량)

fn총매출 = 단가 * (1 - 할인율) * 판매량

End Function
```

### (예) IF/ELSEIF 포함 업적 계산
```vba
Public Function fn업적(직급, 연구과제, 연구논문, 산학협동, 사회봉사)

If 직급 = "조교수" Then
    fn업적 = "대상자 아님"

ElseIf 직급 = "부교수" Then
    fn업적 = 연구과제 * 0.2 + 연구논문 * 0.2 + 산학협동 * 0.3 + 사회봉사 * 0.3

End If

End Function
```

## 7-2. CurrentRegion의 ‘연속’ 정의(시험 단골)
- 엑셀에서 연속(connected region)은
  - 중간에 **완전히 빈 행/빈 열**이 없을 것
- `Range("B5").CurrentRegion` 확장 방식
  - 위/아래: 빈 행 만나기 전까지 확장
  - 좌/우: 빈 열 만나기 전까지 확장
- 중요 포인트
  - **테두리(선)는 데이터가 아니다**
  - 단추/도형은 떠있는 객체라서 데이터가 아니다

### 행 개수 세기
```vba
Range("B5").CurrentRegion.Rows.Count
```

## 7-3. 폼(UserForm) 프로시저 설계 포인트
- 디자인 모드에서 요소 더블클릭 → 해당 이벤트 프로시저로 이동
- 프로시저 이름 규칙: `개체이름_이벤트`  
  - 이 규칙을 지키면 엑셀 엔진이 이벤트 발생 시 자동 실행한다.
- 개체 이름 확인: 요소 선택 후 F4(속성 창)

### 콤보상자 값 넣기 2가지
- 1개씩: `개체명.AddItem "값"`
- 범위로: `개체명.RowSource = "A1:A5"`

### 입력 행 위치 공식(시험형)
- `Range("표의 첫 셀").CurrentRegion.Rows.Count + Offset`
- “표의 첫 셀”은 **필드명(헤더)이 있는 셀**부터 잡는 게 일반적으로 안정적
- 표 제목이 헤더와 붙어 있으면 CurrentRegion에 제목이 포함될 수 있어 Offset을 조정해야 한다.

### 문자열 → 숫자 변환
- 폼 입력값은 문자열이므로 계산 전 `Val()`로 숫자화하는 습관이 안전

### 종료
- `Unload Me`

### (예) 입력 + 초기화 + 종료 문구
```vba
Private Sub UserForm_Initialize()
Cmb학과.RowSource = "j4:j8"
End Sub


Private Sub Cmd입력_Click()
입력행 = Range("b3").CurrentRegion.Rows.Count + 2

Cells(입력행, 2) = Cmb학과
Cells(입력행, 3) = Txt성명
Cells(입력행, 4) = Txt연구과제
Cells(입력행, 5) = Txt연구논문
Cells(입력행, 6) = Txt산학협동
Cells(입력행, 7) = Val(Txt연구과제) + Val(Txt연구논문) + Val(Txt산학협동)

Cmb학과 = ""
Txt성명 = ""
Txt연구과제 = ""
Txt연구논문 = ""
Txt산학협동 = ""

End Sub


Private Sub Cmd종료_Click()

Unload Me

Range("b17") = "수고하셨습니다."

End Sub
```

## 7-4. Cells vs Range(셀 지정 사고방식)
- `Cells(행, 열)` : 좌표 기반(2차원 그리드에 직접 꽂기)
- `Range("B17")` : 주소 기반(사람이 읽기 쉬움)
- 설계 철학
  - Cells는 “계산으로 위치를 만들고” 그 결과를 넣을 때 강력
  - Range는 “고정된 목적지”에 문구/값을 박을 때 직관적
