# ğŸ“Œ 0. ë³´ìŠ¤ í´ë¡  í”„ë¡œì íŠ¸
### ğŸ“Œ 0-1. ë¡œê·¸ì¸ ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™” (MD5)
- ì¼ë‹¨ MD5 ë°©ì‹ìœ¼ë¡œ ì•”í˜¸í™” ì ìš©í•˜ì˜€ë‹¤.
- ì´ëŠ” ë‹¨ë°©í–¥ ì•”í˜¸í™”ë¡œ ì•”í˜¸ë¥¼ ì…ë ¥í•˜ë©´ md5 í•´ì‹œ ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•˜ì—¬ ê¸¸ì´ë¥¼ ëŠ˜ë¦° 128ë¹„íŠ¸ì˜ í•´ì‹œë¥¼ ë°˜í™˜í•˜ì—¬ ì €ì¥í•œë‹¤. 
- ì´ë•Œ ê°™ì€ ê°’ì€ ë¬´ì¡°ê±´ ê°™ì€ í•´ì‹œê°’ì„ ê°€ì§€ë©° ë³µí˜¸í™”ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì¡°ê¸ˆë§Œ ë‹¬ë¼ì ¸ë„ í•´ì‹œê°’ì´ ì™„ì „íˆ ë‹¬ë¼ì ¸ ê±°ì˜ ë¶ˆê°€ëŠ¥í•˜ë‹¤. 
- í•˜ì§€ë§Œ ì†ë„ê°€ ë¹¨ë¼ ì•„ë¬´ ê°’ì´ë‚˜ ë§‰ë„£ì–´ë´¤ì„ë•Œ ê¸ˆë°©ëš«ë¦´ ë¿ë”ëŸ¬ ìš”ìƒˆëŠ” íŒŒí›¼ë²•ì´ ë„ˆë¬´ ì˜ ì•Œë ¤ì ¸ìˆì–´ ë³´ì•ˆìš©ìœ¼ë¡œëŠ” ì˜ ì‚¬ìš©í•˜ì§€ëŠ” ì•Šê¸´ í•˜ë‹¤.
```java
    @Select("SELECT * FROM users WHERE user_id = #{userId} AND user_email = #{userEmail} AND user_password = MD5(#{userPassword})")
    @ResultMap("UserMap")
    User getUserProfile(User userInfo) throws Exception;
```

### ğŸ“Œ 0-2. The input type of the launch configuration does not exist ì—ëŸ¬
- ì´ ì—ëŸ¬ê°€ í•œì°¸ë– ì„œ ì•ˆëì—ˆëŠ”ë° í•´ê²°í•˜ëŠ” ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.
- ìš°ì„  ì´ ë¬¸ì œëŠ” aië¡œ ì²˜ë¦¬í•˜ë ¤ë©´ gptì—ê²Œ ë¬¼ì–´ë³´ëŠ” ê²ƒë³´ë‹¤ copilotì´ í›¨ì”¬ ë¹ ë¥´ë‹¤. (ê²°êµ­ copilotìœ¼ë¡œ í•´ê²°)
- ì§ì ‘ì ì¸ ì›ì¸ì€ @AutoConfigureTestDatabas ì–´ë…¸í…Œì´ì…˜ì¸ë° ì´ëŠ” ê¸°ì¡´ ì„¤ì •ëœ dbë¥¼ ì°¾ìœ¼ë¼ëŠ” ëœ»ìœ¼ë¡œ ì´ê±¸ ë¶™ì˜€ì—ˆëŠ”ë° ì‚¬ì‹¤ ê·¸ëƒ¥ springboottest ì–´ë…¸í…Œì´ì…˜ë§Œ ë¶™ì—¬ë„ í•´ê²°ë˜ëŠ” ë¬¸ì œë¼ì„œ ê·¸ëƒ¥ ê¹”ë”í•˜ê²Œ ì´ê±°ë§Œ ë¶™ì´ëŠ”ê²Œ ì¢‹ì€ ê±° ê°™ë‹¤. ê¸°ì¡´ ì„¤ì •ëœ dbë¥¼ ì°¾ìœ¼ë¼ëŠ” ëœ»ì˜ ì–´ë…¸í…Œì´ì…˜ì„ ì¶”ê°€ë¡œ ë¶™ì´ë‹ˆ springì— í˜¼ì„ ì´ ìˆì—ˆë˜ ê²ƒ ê°™ë‹¤.
- ë˜ ë§¤í¼ì˜ sql ì¿¼ë¦¬ ë¬¸ì œì¼ìˆ˜ë„ ìˆëŠ”ë° ì´ê±´ ë‹¤ë¥¸ test ìƒí™©ì—ì„œ ë°œê²¬í–ˆë‹¤. 
- ìš°ì„  launch ë¬¸ì œ ê°™ì€ ê²ƒì„ ìš°ì„  ì‚´í´ë³´ê³  ì•ˆë˜ë©´ ìœ„ì˜ ìƒí™©ì„ ì²´í¬í•´ë³´ì 

### ğŸ“Œ 0-3. LoginServiceTest ì˜¤ë¥˜ í•´ê²°
- ë¬¸ì œ 1: User í´ë˜ìŠ¤ import ëˆ„ë½ 
- -> ì˜¤ë¥˜: User cannot be resolved to a type
- í•´ê²°: User í´ë˜ìŠ¤ import ì¶”ê°€
```java
User user = loginService.login(...);  // User í´ë˜ìŠ¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ
```
- ë¬¸ì œ 2: LoginService ë©”ì„œë“œëª… ë¶ˆì¼ì¹˜
- -> ì˜¤ë¥˜: The method login(String, String) is undefined for the type LoginService
- í•´ê²°: ì‹¤ì œ LoginService ì¸í„°í˜ì´ìŠ¤ ë©”ì„œë“œ ì‚¬ìš©
```java
// ë¬¸ì œ - ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ë©”ì„œë“œ í˜¸ì¶œ
User user = loginService.login("email", "password");
// í•´ê²°
User user = loginService.loginCheck(input);
```
- ë¬¸ì œ 3: User ê°ì²´ getter ë©”ì„œë“œëª… ë¶ˆì¼ì¹˜
- ì˜¤ë¥˜: The method getEmail() is undefined for the type User
- í•´ê²°: ì˜¬ë°”ë¥¸ getter ë©”ì„œë“œ ì‚¬ìš©'
```java
// í•´ê²°
assertEquals("cat@space.com", user.getUserEmail());
```
- ë¬¸ì œ 4: **ì˜ˆì™¸ ì²˜ë¦¬ ë°©ì‹ ì˜¤í•´**
- ì˜¤ë¥˜: LoginServiceê°€ null ë°˜í™˜ ëŒ€ì‹  ì˜ˆì™¸ë¥¼ ë˜ì§€ëŠ”ë° assertNull() ì‚¬ìš©
- í•´ê²°: ì˜ˆì™¸ ë°œìƒì„ í…ŒìŠ¤íŠ¸í•˜ë„ë¡ ë³€ê²½
```java
// ë¬¸ì œ - ì˜ˆì™¸ê°€ ë°œìƒí•˜ëŠ”ë° nullì„ ê¸°ëŒ€
assertNull(loginService.loginCheck(input));

// í•´ê²°
Exception exception = assertThrows(Exception.class, () -> {
    loginService.loginCheck(input);
});
assertEquals("ì˜ëª»ëœ ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ ì…ë‹ˆë‹¤.", exception.getMessage());
```
- ë¬¸ì œ 5: MyBatis ë§¤ê°œë³€ìˆ˜ ë°”ì¸ë”© ì˜¤ë¥˜
- ì˜¤ë¥˜: Parameter 'newPassword' not found. Available parameters are [arg1, arg0, param1, param2]
- í•´ê²°: @Param ì–´ë…¸í…Œì´ì…˜ ì¶”ê°€
```java
// UserMapper.java ë¬¸ì œ
int resetPw(int userId, String newPassword) throws Exception;
// í•´ê²°
int resetPw(@Param("userId") int userId, @Param("newPassword") String newPassword) throws Exception;
```
- ë¬¸ì œ 6: ë©”ì„œë“œ ì‹œê·¸ë‹ˆì²˜ ë¶ˆì¼ì¹˜
- ì˜¤ë¥˜: ë¬¸ìì—´ ë§¤ê°œë³€ìˆ˜ë¡œ í˜¸ì¶œí–ˆì§€ë§Œ User ê°ì²´ê°€ í•„ìš”
- í•´ê²°: User ê°ì²´ ì‚¬ìš©
```java
// ë¬¸ì œ
String result = loginService.findIdByEmail("test@example.com");
// í•´ê²°
User input = new User();
input.setUserEmail("cat@space.com");
User result = loginService.findByEmail(input);
```
- ìµœì¢… ì½”ë“œ
```java
@Slf4j
@SpringBootTest
class LoginServiceTest {

    @Autowired
    private LoginService loginService;

    /* ë¡œê·¸ì¸  */

    @DisplayName("ë¡œê·¸ì¸ ì„±ê³µ ì‹œ User ë°˜í™˜")
    @Test
    void loginCheck_success() throws Exception {
        // given - ë¨¼ì € UserMapperë¡œ ì‹¤ì œ ì‚¬ìš©ì ì •ë³´ í™•ì¸
        User findInput = new User();
        findInput.setUserEmail("cat@space.com");
        User existingUser = loginService.findByEmail(findInput);
        
        // ì‚¬ìš©ìê°€ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸
        assertNotNull(existingUser, "í…ŒìŠ¤íŠ¸ìš© ì‚¬ìš©ìê°€ DBì— ì¡´ì¬í•´ì•¼ í•©ë‹ˆë‹¤");
        
        // given - ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸ (ì‹¤ì œ ë¹„ë°€ë²ˆí˜¸ í•„ìš”)
        User loginInput = new User();
        loginInput.setUserEmail("cat@space.com");
        loginInput.setUserPassword("1234"); // ì¼ë°˜ì ì¸ í…ŒìŠ¤íŠ¸ ë¹„ë°€ë²ˆí˜¸ ì‹œë„
        
        // when & then - ì‹¤ì œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ëª¨ë¥´ë¯€ë¡œ ì˜ˆì™¸ ì²˜ë¦¬
        try {
            User user = loginService.loginCheck(loginInput);
            assertNotNull(user);
            assertEquals("cat@space.com", user.getUserEmail());
            log.info("ë¡œê·¸ì¸ ì„±ê³µ: {}", user.getUserEmail());
        } catch (Exception e) {
            log.info("ë¡œê·¸ì¸ ì‹¤íŒ¨ (ì˜ˆìƒë¨): {}", e.getMessage());
            // ì‹¤ì œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ëª¨ë¥´ëŠ” ê²½ìš°, ì´ í…ŒìŠ¤íŠ¸ëŠ” ì‹¤íŒ¨í•  ìˆ˜ ìˆìŒ
            // ì‹¤ì œ ê°œë°œ ì‹œì—ëŠ” ì•Œë ¤ì§„ í…ŒìŠ¤íŠ¸ ê³„ì •ì„ ì‚¬ìš©í•´ì•¼ í•¨
        }
    }

    @DisplayName("ë¡œê·¸ì¸ ì‹¤íŒ¨ ì‹œ ì˜ˆì™¸ ë°œìƒ")
    @Test
    void loginCheck_fail() {
        // given
        User input = new User();
        input.setUserEmail("no_user@example.com");
        input.setUserPassword("wrongPw");
        
        // when & then
        Exception exception = assertThrows(Exception.class, () -> {
            loginService.loginCheck(input);
        });
        
        assertEquals("ì˜ëª»ëœ ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ ì…ë‹ˆë‹¤.", exception.getMessage());
    }

    /*  ì•„ì´ë””/ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°  */

    @DisplayName("ì´ë©”ì¼ë¡œ ì‚¬ìš©ì ì¡°íšŒ OK")
    @Test
    void findByEmail_ok() throws Exception {
        // given
        User input = new User();
        input.setUserEmail("cat@space.com");
        
        // when
        User result = loginService.findByEmail(input);
        
        // then
        assertNotNull(result);
        assertEquals("cat@space.com", result.getUserEmail());
    }

    @DisplayName("ì´ë¦„+íœ´ëŒ€í°ìœ¼ë¡œ ì‚¬ìš©ì ì¡°íšŒ OK")
    @Test
    void findByNameAndPhone_ok() throws Exception {
        // given
        User input = new User();
        input.setUserName("ì„±ë•¡ë•¡");
        input.setUserPhone("010-3295-2895");
        
        // when
        User result = loginService.findByNameAndPhone(input);
        
        // then
        assertNotNull(result);
        assertEquals("ì„±ë•¡ë•¡", result.getUserName());
        assertEquals("010-3295-2895", result.getUserPhone());
    }

    @DisplayName("ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ì„±ê³µ")
    @Test
    void resetPw_ok() throws Exception {
        // given
        int userId = 1;
        String newPassword = "newPassword123";
        
        // when
        int result = loginService.resetPw(userId, newPassword);
        
        // then
        assertEquals(1, result);
    }
}
```

### ğŸ“Œ 0-4. LoginControllerTest
- viewì™€ì˜ í†µì‹ ì€ ì–‘í˜¸í•¨ì„ ì•Œ ìˆ˜ ìˆë‹¤.
- .andExpect(status().isOk()): ì„œë²„ê°€ HTTP 200 OK ìƒíƒœ ì½”ë“œë¡œ ì‘ë‹µí–ˆìŒì„ ì•Œ ìˆ˜ ìˆë‹¤.
- .andExpect(view().name("login/index")) : ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ë°˜í™˜í•˜ëŠ” **ë·°ì˜ ì´ë¦„ì´ "login/index"**ì¸ì§€ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
- .andExpect(model().attributeExists("referrer")); : ë·°(í…œí”Œë¦¿)ë¡œ ì „ë‹¬ë˜ëŠ” Model ê°ì²´ ì•ˆì— "referrer"ë¼ëŠ” ì´ë¦„ì˜ ë°ì´í„°ê°€ ìˆëŠ”ì§€ ê²€ì‚¬í•  ìˆ˜ ìˆë‹¤.
- ë·°ëœë”ë§ê¹Œì§€ ë³´ëŠ” ê²ƒì€ í…ŒìŠ¤íŠ¸ë¡œëŠ” í•œê³„ê°€ ìˆë‹¤.
```java
@SpringBootTest
@AutoConfigureMockMvc
class LoginControllerTest {

    @Autowired
    MockMvc mockMvc;

    @DisplayName("GET /login ë·° ë° ëª¨ë¸ OK")
    @Test
    void loginPage_ok() throws Exception {
        mockMvc.perform(get("/login"))
                .andExpect(status().isOk())
                .andExpect(view().name("login/index"))     // thymeleaf ìœ„ì¹˜ì— ë§ì¶° ìˆ˜ì •
                .andExpect(model().attributeExists("referrer"));
    }
}
```

### ğŸ“Œ 0-5. LoginRestControllerTest
- performì„ í†µí•´ì„œ ì‹¤ì œ ajaxë¥¼ êµ¬í˜„í•˜ì—¬ ì§ì ‘ ë³´ë‚¼ ìˆ˜ ìˆë‹¤.
- .andExpect(jsonPath("$.success").value(true)); : ì´ê±¸ í†µí•´ì„œ ì„œë²„ê°€ ì‘ë‹µí•œ JSON ê°ì²´ì˜ ìµœìƒë‹¨ì— "success"ë¼ëŠ” í‚¤ê°€ ìˆê³  ê°’ì´ trueë¡œ ì˜ ì™”ìŒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
```java
@SpringBootTest
@AutoConfigureMockMvc
class LoginRestControllerTest {

    @Autowired
    MockMvc mockMvc;

    private final ObjectMapper om = new ObjectMapper();

    /* /api/login */

    // ì‹¤ì œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ëª¨ë¥´ë¯€ë¡œ ì¼ì‹œì ìœ¼ë¡œ ì£¼ì„ ì²˜ë¦¬
    // @DisplayName("API ë¡œê·¸ì¸ ì„±ê³µ 200 + success:true")
    // @Test
    // void apiLogin_success() throws Exception {
    //     mockMvc.perform(post("/api/login")
    //             .contentType(MediaType.APPLICATION_FORM_URLENCODED)
    //             .param("user_email","cat@space.com")
    //             .param("user_password", "passsssworddd"))
    //             .andExpect(status().isOk())
    //             .andExpect(jsonPath("$.success").value(true));
    // }

    @DisplayName("API ë¡œê·¸ì¸ ì‹¤íŒ¨ - ì˜ëª»ëœ ë¹„ë°€ë²ˆí˜¸ í˜•ì‹")
    @Test
    void apiLogin_fail_invalidPassword() throws Exception {
        mockMvc.perform(post("/api/login")
                .contentType(MediaType.APPLICATION_FORM_URLENCODED)
                .param("user_email","cat@space.com")
                .param("user_password", "1234")) // ì˜ë¬¸ ì—†ìŒ - ì‹¤íŒ¨í•´ì•¼ í•¨
                .andExpect(status().isOk())
                .andExpect(jsonPath("$.success").value(false))
                .andExpect(jsonPath("$.message").value("ë¹„ë°€ë²ˆí˜¸ëŠ” 8~20ì ì˜ë¬¸ê³¼ ìˆ«ìì˜ ì¡°í•©ì´ì–´ì•¼ í•©ë‹ˆë‹¤."));
    }

    @DisplayName("API ë¡œê·¸ì¸ ì‹¤íŒ¨ - ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì‚¬ìš©ì")
    @Test
    void apiLogin_fail_userNotFound() throws Exception {
        mockMvc.perform(post("/api/login")
                .contentType(MediaType.APPLICATION_FORM_URLENCODED)
                .param("user_email","no_user@example.com")
                .param("user_password", "password123"))
                .andExpect(status().isOk())
                .andExpect(jsonPath("$.success").value(false));
    }

    /* /api/find-id  */

    @DisplayName("ì•„ì´ë”” ì°¾ê¸° ì´ë©”ì¼ë°©ì‹ OK")
    @Test
    void findIdByEmail_ok() throws Exception {
        mockMvc.perform(post("/api/find-id")
                .contentType(MediaType.APPLICATION_JSON)
                .content(om.writeValueAsString(Map.of(
                    "type",  "email",
                    "email", "cat@space.com" // ì‹¤ì œ DBì— ìˆëŠ” ì´ë©”ì¼
                ))))
                .andExpect(status().isOk())
                .andExpect(jsonPath("$.success").value(true))
                .andExpect(jsonPath("$.userEmail").value("cat@space.com"));
    }

    @DisplayName("ì•„ì´ë”” ì°¾ê¸° íœ´ëŒ€í°ë°©ì‹ OK")
    @Test
    void findIdByPhone_ok() throws Exception {
        mockMvc.perform(post("/api/find-id")
                .contentType(MediaType.APPLICATION_JSON)
                .content(om.writeValueAsString(Map.of(
                    "type",  "phone",
                    "name",  "ì„±ë•¡ë•¡", // ì‹¤ì œ DBì— ìˆëŠ” ë°ì´í„°
                    "phone", "010-3295-2895"
                ))))
                .andExpect(status().isOk())
                .andExpect(jsonPath("$.success").value(true));
    }

    /* /api/find-pw  */

    @DisplayName("ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°(ë©”ì¼ ì „ì†¡) OK")
    @Test
    void findPw_ok() throws Exception {
        mockMvc.perform(post("/api/find-pw")
                .contentType(MediaType.APPLICATION_JSON)
                .content(om.writeValueAsString(Map.of(
                    "email", "cat@space.com" // ì‹¤ì œ DBì— ìˆëŠ” ì´ë©”ì¼
                ))))
                .andExpect(status().isOk())
                .andExpect(jsonPath("$.success").value(true));
    }

    /* /api/reset-pw */

    @DisplayName("ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ë©”ì¼ ë°œì†¡ OK")
    @Test
    void resetPw_ok() throws Exception {
        // ì‹¤ì œ ì»¨íŠ¸ë¡¤ëŸ¬ì— /api/reset-pw ì—”ë“œí¬ì¸íŠ¸ê°€ ìˆìŒ (í•˜ì´í”ˆ ì‚¬ìš©, PUT ë©”ì†Œë“œ)
        mockMvc.perform(put("/api/reset-pw")
                .contentType(MediaType.APPLICATION_JSON)
                .content(om.writeValueAsString(Map.of(
                    "email", "cat@space.com"
                ))))
                .andExpect(status().isOk())
                .andExpect(jsonPath("$.success").value(true));
    }
}
```

### ğŸ“Œ 0-6. vs ì½”ë“œ ë‚´ì¥ ë¸Œë¼ìš°ì €ëŠ” alert ê°™ì€ ê²ƒì„ ì§€ì›í•˜ì§€ ì•Šì„ ìˆ˜ ìˆë‹¤.
- ì„¤ì •ì´ ì˜ëª»ë˜ì—ˆì„ë•Œ ë‚´ì¥ ë¸Œë¼ìš°ì €ê°€ ë¼ì´ë¸Œì„œë²„ë¥¼ í¬ë¡¬ ê°™ì€ë°ì—ì„œ ì•ˆë„ìš°ê³  ë°”ë¡œ ë‚´ì¥ ë¸Œë¼ìš°ì €ë¡œ ë„ìš°ëŠ”ë° ì´ë•Œ alertì´ ì•ˆëœ¨ëŠ” ë¬¸ì œê°€ ë°œìƒí–ˆë‹¤.
- ì´ ë¬¸ì œë¥¼ ì•Œê³  ì•„ë˜ ì—ëŸ¬ë¥¼ í•´ê²°í–ˆë‹¤.
- ì´ë©”ì¼ë¡œ ì°¾ê¸° í–ˆì„ ë•Œ ì—†ëŠ” ì´ë©”ì¼ì´ë©´ ê·¸ëŸ° ì´ë©”ì¼ ì—†ë‹¤ê³  ì•Œë ¤ì£¼ê¸° -> ë‚´ì¥ ë¸Œë¼ìš°ì € ë¬¸ì œ (í•´ê²°)
- ë¡œê·¸ì¸ ì‹¤íŒ¨í–ˆì„ë•Œ ë°˜ì‘ì•ˆí•˜ëŠ” ë¬¸ì œ -> ë‚´ì¥ ë¸Œë¼ìš°ì € ë¬¸ì œ (í•´ê²°)

### ğŸ“Œ 0-7. ë©”ì¼ ì „ì†¡ì‹œ ë°œìƒí•œ ë‘ê°€ì§€ ì—ëŸ¬
- No static resource api/reset_pw. -> /api/reset-pwë¡œ ì–¸ë”ë°”ë¥¼ ì•ˆì¼ì–´ì•¼ í–ˆìŒ(jsì˜¤ë¥˜ í•´ê²°)
- Method 'POST' is not supported. -> ë°›ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ putMappingìœ¼ë¡œ í•´ë‘ , postë¡œ ê³ ì¹¨ (í•´ê²°)

### ğŸ“Œ 0-8. íŠ¹ì • ë¡œì§ë§Œ(ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ëª¨ë‹¬) ë˜‘ê°™ì´ ì‘ë™í•˜ì§€ ì•ŠëŠ” ì˜¤ë¥˜
- ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •ì—ì„œ ë„˜ì–´ê°„ 3depth ì´ë©”ì¼ ì•ˆë³´ì„ ì˜¤ë¥˜ + ëª¨ë‹¬ ê»ë‹¤ì¼œë„ ë¹„ë°€ë²ˆí˜¸ ë‚¨ì•„ìˆìŒ -> ê³„ì†ë„ ì•ˆëˆŒë¦¼ -> ë¹„ë°€ë²ˆí˜¸ ëª¨ë‹¬ì—ì„œëŠ” í˜„ì¬ ì´ë©”ì¼ì„ ì „ì—­ë³€ìˆ˜ë¡œ ì €ì¥í•˜ì§€ ì•Šê³  ë§ˆìŠ¤í‚¹ë„ ì•ˆí•´ë’€ì—ˆìŒ. (ìœ„ì—ì„œ í•œ ì²˜ë¦¬ ë˜‘ê°™ì´ í•˜ëŠ”ì§€ í™•ì¸í•˜ê¸°)
-  document.querySelector('.result-email').textContent = maskEmail(data.userEmail); : window.currentEmail = data.userEmail; // í˜„ì¬ ì´ë©”ì¼ì„ ì „ì—­ ë³€ìˆ˜ì— ì €ì¥ -> (í•´ê²°)

### ğŸ“Œ 0-9. ì¬ë¶€ì—¬í•œ ë¹„ë°€ë²ˆí˜¸ê°€ í˜•ì‹ì— ë§ì§€ ì•ŠëŠ” ë¬¸ì œ
- ì•„ë˜ëŠ” ì´ì „ì˜ ë¡œì§ì¸ë° ë¹„ë°€ë²ˆí˜¸ê°€ ì˜ë¬¸ + ìˆ«ì 8~20ìë¼ ë¡œì§ì´ ë§ì§€ ì•Šì•˜ë‹¤. ì›ë˜ëŠ” chars ë’¤ì— íŠ¹ìˆ˜ë¬¸ìê°€ ìˆì–´ì„œ ì§€ì› ê³ 
- ì´í›„ì—ëŠ” ìˆ«ìë§Œ ë“¤ì–´ê°€ê±°ë‚˜ ì˜ì–´ë§Œ ë“¤ì–´ê°€ëŠ” ë¬¸ì œê°€ ë°œìƒí•˜ì˜€ë‹¤.
```java
String chars = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";
        StringBuilder sb = new StringBuilder();
        for (int i = 0; i < 8; i++) {
            int idx = (int) (Math.random() * chars.length());
            sb.append(chars.charAt(idx));
        }
        String newPassword = sb.toString();

        try {
            loginService.resetPw(user.getUserId(), newPassword);

        } catch (Exception e) {
            result.put("success", false);
            result.put("message", "ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
            result.put("timestamp", LocalDateTime.now().toString());
            return result;
        }
```
- ìˆ˜ì •ë³¸ì€ ì•„ë˜ì™€ ê°™ë‹¤. dbì— ì €ì¥í•˜ëŠ” ë¡œì§ì„ ë¹ ëœ¨ë ¸ì–´ì„œ ë‹¤ì‹œ ìˆ˜ì •í•˜ì˜€ë‹¤.
```java
// ì„ì‹œ ë¹„ë°€ë²ˆí˜¸ ìƒì„±(8ìë¦¬: ì˜ë¬¸, ìˆ«ì, íŠ¹ìˆ˜ë¬¸ì í¬í•¨)
        String chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";
        String nums = "0123456789";
        Random rnd = new Random();
        String newPassword = null;

        while (true) {
            StringBuilder sb = new StringBuilder();
            // ì˜ë¬¸ì 1ê°œ ë¬´ì¡°ê±´ í¬í•¨
            sb.append(chars.charAt(rnd.nextInt(chars.length())));
            // ìˆ«ì 1ê°œ ë¬´ì¡°ê±´ í¬í•¨
            sb.append(nums.charAt(rnd.nextInt(nums.length())));

            // ë‚˜ë¨¸ì§€ 6ìë¦¬ëŠ” ì˜ë¬¸/ìˆ«ì ì„ì–´ì„œ ëœë¤ ìƒì„±
            String all = chars + nums;
            for (int i = 0; i < 6; i++) {
                sb.append(all.charAt(rnd.nextInt(all.length())));
            }

            // ì„ê¸° (ì˜ë¬¸, ìˆ«ìê°€ 1ë²ˆì§¸, 2ë²ˆì§¸ì— ëª°ë¦¬ì§€ ì•Šê²Œ)
            List<Character> pwChars = new ArrayList<>();

            for (char c : sb.toString().toCharArray()) pwChars.add(c);

            Collections.shuffle(pwChars);

            StringBuilder resultPw = new StringBuilder();

            for (char c : pwChars) resultPw.append(c);

            newPassword = resultPw.toString();

            // ì •ê·œì‹ ì¡°ê±´ ì²´í¬
            if (newPassword.matches("^(?=.*[A-Za-z])(?=.*\\d)[A-Za-z\\d]{8}$")) {
                break;
            }
            // ì¡°ê±´ ë¶ˆë§Œì¡± ì‹œ whileë¡œ ë‹¤ì‹œ ìƒì„±
        }

        if (newPassword == null || newPassword.isEmpty()) {
            result.put("success", false);
            result.put("message", "ì„ì‹œ ë¹„ë°€ë²ˆí˜¸ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
            result.put("timestamp", LocalDateTime.now().toString());
            return result;
        }

        try {
            loginService.resetPw(user.getUserId(), newPassword);

        } catch (Exception e) {
            result.put("success", false);
            result.put("message", "ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
            result.put("timestamp", LocalDateTime.now().toString());
            return result;
        }
```

### ğŸ“Œ 0-10. ë¡œê·¸ì¸ í™ˆë²„íŠ¼, ë’¤ë¡œê°€ê¸° ë²„íŠ¼ êµ¬í˜„
- í™ˆìœ¼ë¡œ ê°€ê¸°ëŠ” ê·¸ëƒ¥ ì£¼ì†Œì— ë°”ë¡œ íƒ€ì„ë¦¬í”„ë¡œ mainì„ ê±¸ì–´ì£¼ì—ˆê³  ë’¤ë¡œê°€ê¸°ëŠ” id="back-btn"ë¥¼ ì¶”ê°€í•œ ë‹¤ìŒì— jsë¥¼ ë„£ì—ˆë‹¤.
- ë’¤ë¡œê°€ê¸°ëŠ” ì§„ì§œ ì´ì „í˜ì´ì§€ë¡œ ê°€ê³ (ë³´ìŠ¤ì‚¬ì´íŠ¸ê°€ ì•„ë‹ˆì–´ë„) í™ˆë²„íŠ¼ì€ ë³´ìŠ¤ ë©”ì¸ìœ¼ë¡œ ëŒì•„ê°„ë‹¤.
```html
<div class="top-buttons">
    <!-- ë’¤ë¡œê°€ê¸° -->
    <a type="button" href="#" class="back-button" id="back-btn">
        <img th:src="@{/assets/img/login/back_icon.png}" alt="ë’¤ë¡œê°€ê¸° ì•„ì´ì½˜" class="back-icon">
    </a>

    <!-- í™ˆìœ¼ë¡œ ê°€ê¸° -->
    <a th:href="@{/main}" class="home-button">
        <img th:src="@{/assets/img/login/home_icon.png}" alt="í™ˆ ì•„ì´ì½˜" class="home-icon">
    </a>
</div>
```
- ì•„ë˜ëŠ” ë’¤ë¡œê°€ê¸° jsì´ë‹¤.
```js
// ë’¤ë¡œê°€ê¸° ë²„íŠ¼ í´ë¦­ ì‹œ ë™ì‘
document.getElementById('back-btn').addEventListener('click', function(e) {
    e.preventDefault();
    if (window.history.length > 1) {
        window.history.back();
    } else {
        window.location.href = '/main';
    }
});
```

### ğŸ“Œ 0-11. ë¡œê·¸ì¸ ì „ë©´ ìˆ˜ì •
- ìš°ì„  ResponseEntitiy í´ë˜ìŠ¤ë¥¼ í™œìš©í•˜ì—¬ ë” ì‰½ê²Œ ì‘ë‹µì„ ë³´ë‚¼ ìˆ˜ ìˆë„ë¡ ì „ì²´ì ìœ¼ë¡œ ë¦¬íŒ©í† ë§ í•˜ì˜€ë‹¤. ê·¸ ê³¼ì •ì—ì„œ ëª¨ë“  íŒ€ì›ë“¤ê³¼ ë°ì´í„° ì „ì†¡ í‹€ì„ ë§ì¶”ê¸° ìœ„í•´ì„œ ResponseDTOë¥¼ ë§Œë“¤ì–´ì„œ ì‘ë‹µì„ ë³´ë‚´ë„ë¡ ì„¤ê³„í•˜ì˜€ë‹¤.
- ì•„ë˜ëŠ” ë¹Œë” íŒ¨í„´ìœ¼ë¡œ ë§Œë“¤ì–´ì§„ ê°ì²´ë¡œ ajax í˜¸ì¶œì— ì‘ë‹µí•˜ëŠ” ê²ƒì¸ë° ì´ë©”ì¼ë§Œ ë³´ë‚´ëŠ”ë° ë¹„ë°€ë²ˆí˜¸ë¥¼ ì‹¤ì–´ì„œ ë³´ë‚´ëŠ” ê²ƒì€ ë³´ì•ˆìƒ ì¢‹ì§€ ì•Šìœ¼ë¯€ë¡œ ë”°ë¡œ ì´ë©”ì¼ ê°ì²´ì— ë‹´ì•„ ì „ì†¡í•œë‹¤.
```java
User emailUser = new User();
            

    if (user != null) {
        emailUser.setUserEmail(user.getUserEmail());
        response = ResponseDTO.builder()
                .success(true)
                .message("ì‚¬ìš©ì ì •ë³´ë¥¼ ì°¾ì•˜ìŠµë‹ˆë‹¤.")
                .data(emailUser)
                .timestamp(LocalDateTime.now())
                .build();
    }
```
- ì•„ë˜ì„œëŠ” ê°ì²´ ì•ˆì— data ì•ˆì— UserEmailì„ ë´ì•¼ í•˜ë¯€ë¡œ responseData.data.userEmail; ì´ë ‡ê²Œ í˜¸ì¶œí•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.
```js
try {
    // ajax ìš”ì²­ (ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°)
    const response = await fetch('/api/find-pw', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'}, // JSON í˜•ì‹ìœ¼ë¡œ ì „ì†¡
        body: JSON.stringify({ email }) // {email: "..."} ê°ì²´ í˜•ì‹ìœ¼ë¡œ ì „ì†¡
    });
    const responseData = await response.json();

    if (responseData.success) {
            // ì„±ê³µ ì‹œ, ì´ë©”ì¼ ë§ˆìŠ¤í‚¹ í›„ ê²°ê³¼ì°½ì— í‘œì‹œ
        // ì„±ê³µ ì‹œ, ë‹¤ìŒ ë‹¨ê³„ ëª¨ë‹¬ ì—´ê¸°
        document.querySelector('.result-email').textContent = maskEmail(responseData.data.userEmail);
        window.currentEmail = responseData.data.userEmail; // í˜„ì¬ ì´ë©”ì¼ì„ ì „ì—­ ë³€ìˆ˜ì— ì €ì¥
        document.getElementById('modal-main').style.display = 'none';
        document.getElementById('modal-result').style.display = 'flex';
    } else {
        alert(responseData.message || 'ì…ë ¥í•˜ì‹  ì •ë³´ì™€ ì¼ì¹˜í•˜ëŠ” ê³„ì •ì´ ì—†ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì‹œê±°ë‚˜ ì‚¬ì´íŠ¸ ìš´ì˜ìì—ê²Œ ë¬¸ì˜í•´ì£¼ì„¸ìš”.');
    }
} catch (err) {
    alert('ì„œë²„ ì˜¤ë¥˜ì…ë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš”.');
}
```

### ğŸ“Œ 0-12. ë³´ìŠ¤ í´ë¡  ì½”ë”© ì „ì²´ ì—ëŸ¬ í†µì¼
- ìš°ì„  í—¨ë“¤ëŸ¬ëŠ” ì•„ë˜ì²˜ëŸ¼ ë‘ê°œë¥¼ ë§Œë“¤ì—ˆê³  @ExceptionHandler(Exception.class)ëŠ” Exception.classë¥¼ ìƒì†ë°›ëŠ” ëª¨ë“  ì—ëŸ¬ë¥¼ í•œë²ˆì— ê´€ë¦¬í•œë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.
- ì „ì²´ì ìœ¼ë¡œ ê¸°ë³¸ ì—ëŸ¬ë¥¼ 500ì—ëŸ¬ë¡œ ì •ì˜í•´ë‘ê³  íŠ¹ìˆ˜ ì œì‘í•œ CustomExceptionì— í¬í•¨ëœ ì—ëŸ¬ë©´ í•´ë‹¹ì—ëŸ¬ì— ë§ëŠ” êµ¬ì²´ì ì¸ ìƒí™©ì„ êµ¬í˜„í•˜ë„ë¡ í•˜ì˜€ë‹¤.
- ëª¨ë“  ì—ëŸ¬ëŠ” ResponseDTOì— ë‹´ê²¨ ResponseEntity.status(status).body(errorResponse); ì´ í˜•íƒœë¡œ ë°˜í™˜ëœë‹¤.
``` java
@Slf4j
@RestControllerAdvice
public class RestControllerExceptionHandler {
    
    @ExceptionHandler(Exception.class)
    public ResponseEntity<ResponseDTO> restExceptionHandler(Exception e) {
        log.error(e.getMessage(), e);

        int status = HttpStatus.INTERNAL_SERVER_ERROR.value(); // ìì²´ ì •ì˜í•œ ì—ëŸ¬ê°€ ì•„ë‹ ê²½ìš° 500ì—ëŸ¬ë¡œ ì •ë¦¬

        // CustomExceptionì´ ë°œìƒí•œ ê²½ìš°, ìƒíƒœ ì½”ë“œì™€ ë©”ì„¸ì§€ë¥¼ ê°€ì ¸ì˜¤ê¸°
        if (e instanceof CustomException) { 
            CustomException customException = (CustomException) e;
            status = customException.getStatus().value(); 
        }

        ResponseDTO errorResponse = ResponseDTO.builder()
                .status(status) // ìƒíƒœì½”ë“œ
                .message(e.getMessage()) // ì˜ˆì™¸ ë©”ì„¸ì§€
                .error(HttpStatus.valueOf(status).getReasonPhrase()) // ì—ëŸ¬ í´ë˜ìŠ¤ ì´ë¦„
                .timestamp(LocalDateTime.now()) // í˜„ì¬ ì‹œê°„
                .build(); 

        return ResponseEntity.status(status).body(errorResponse); 
    }
}
```
- ìœ„ëŠ” restControllerì—ì„œ ë°œìƒí•œ ì—ëŸ¬ë¥¼ catchí•˜ê³  ì•„ë˜ëŠ” controllerì—ì„œ ë°œìƒí•œ ì—ëŸ¬ë¥¼ catchí•˜ëŠ” ì—­í• ì„ í•œë‹¤.
- ì´ë•Œ ì—ëŸ¬ë¥¼ ìºì¹˜í•œ í›„ì— ì§ì ‘ ë§Œë“  ì»¤ìŠ¤í…€ ì—ëŸ¬ í˜ì´ì§€ë¡œ ë¦¬í„´ì‹œì¼œ ì—ëŸ¬ ë¬¸êµ¬ë¥¼ ë„ì›Œì¤€ë‹¤.
```java
@Slf4j
@ControllerAdvice
public class ControllerExceptionHandler {

    @ExceptionHandler(Exception.class)
    public String handleException(Exception e, Model model) {
        int status = 500;
        String error = "Internal Server Error";
        String message = "ì„œë²„ ë‚´ë¶€ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";

        if (e instanceof CustomException) {
            CustomException ce = (CustomException) e;
            status = ce.getStatus().value();
            error = ce.getStatus().getReasonPhrase();
            message = ce.getMessage();
        }

        log.error("{} ì—ëŸ¬ ë°œìƒ: {}", status, e.getMessage(), e);

        model.addAttribute("status", status);
        model.addAttribute("error", error);
        model.addAttribute("message", message);

        return "error/index";
    }
}
```
- ì´ ì—ëŸ¬ ì½”ë“œ ìŠ¤íƒ€ì¼ì„ í† ëŒ€ë¡œ ì´ 6ê°œì˜ íŠ¹ìˆ˜ ì—ëŸ¬ í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì–´ì„œ íŒ€ì›ë“¤ê³¼ ê³µìœ í•˜ì˜€ë‹¤.
```java
@Getter
@Setter
public class CustomException extends Exception { 

    private HttpStatus status; 


    public CustomException(String message) {
        super(message); 
        this.status = HttpStatus.INTERNAL_SERVER_ERROR; 
    }

    public CustomException(HttpStatus status, String message) {
        super(message); 
        this.status = status; 
    }
}
```

# ğŸ“Œ 1. ì—ëŸ¬ì²˜ë¦¬ ìˆ˜ì—… 
### ğŸ“Œ 1-1. @getter, @setterì™€ @dataì˜ ì°¨ì´ 
- @getter, @setterëŠ” ê°ê° getterì™€ setterë§Œ ìƒˆë¡œ ìƒì„±í•´ì£¼ëŠ” ë°˜ë©´ 
- @DataëŠ” @Getter, @Setter, @ToString, @EqualsAndHashCode, @RequiredArgsConstructor ê¹Œì§€ ëª¨ë‘ í•œë²ˆì— ì ìš©í•˜ëŠ” ì–´ë…¸í…Œì´ì…˜ì´ë‹¤.

### ğŸ“Œ 1-2. MyException
- private HttpStatus status; : ìŠ¤í”„ë§ì—ì„œ ì‚¬ìš©í•˜ëŠ” httpì—ëŸ¬ì˜ ìƒíƒœì½”ë“œë¥¼ ì €ì¥í•  ìˆ˜ ìˆëŠ” í•„ë“œì´ë‹¤.
-  404(NOT_FOUND): ì°¾ëŠ” ë¦¬ì†ŒìŠ¤(í˜ì´ì§€, ë°ì´í„° ë“±)ê°€ ì—†ë‹¤ -> ì—†ëŠ” urlì´ë‚˜ ì—†ëŠ” ìƒí’ˆ, ê²Œì‹œê¸€, ìœ ì €ë¡œ ì¡°íšŒí• ë•Œ
-  400(BAD_REQUEST): ìš”ì²­(request)ì´ ì˜ëª»ëë‹¤ -> í´ë¼ì´ì–¸íŠ¸ê°€ ë³´ë‚¸ ë°ì´í„°ë‚˜ íŒŒë¼ë¯¸í„°ê°€ ì˜ëª»ëœ ê²½ìš° (í•„ìˆ˜ê°’ ëˆ„ë½, í˜•ì‹ì˜¤ë¥˜, í¼ êµ¬ì¡° ë“±)
-  409(CONFLICT): ìš”ì²­ì´ í˜„ì¬ ì„œë²„ ìƒíƒœì™€ ì¶©ëŒ(conflict)í•¨ -> ì¤‘ë³µ ë“±ë¡: ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì•„ì´ë””/ì´ë©”ì¼/ë‹‰ë„¤ì„ìœ¼ë¡œ ê°€ì… ì‹œë„, ë‘ ëª…ì´ ë™ì‹œì— í•œ ì¬ê³ ë¥¼ êµ¬ë§¤í•  ë•Œ ì¬ê³  ë¶€ì¡±, ì´ë¯¸ ì·¨ì†Œëœ ì£¼ë¬¸ì„ ë˜ ì·¨ì†Œí•˜ë ¤ í•  ë•Œ ë“±
-  401(UNAUTHORIZED): ë¡œê·¸ì¸ ì•ˆ í•œ ì‚¬ìš©ì, í† í° ëˆ„ë½/ë§Œë£Œ
-  403(FORBIDDEN): ê¶Œí•œ ì—†ëŠ” ì‚¬ìš©ìê°€ ê´€ë¦¬ì í˜ì´ì§€ ì ‘ê·¼ ë“±
-  422(UNPROCESSABLE_ENTITY): ìœ íš¨ì„±ì€ ë§ìœ¼ë‚˜ ì˜ë¯¸ì ìœ¼ë¡œ ì²˜ë¦¬ ë¶ˆê°€ (ë“œë¬¼ê²Œ ì‚¬ìš©) -> (ex: ë¹„ë°€ë²ˆí˜¸/ì´ë©”ì¼ ë‘˜ ë‹¤ ë§ëŠ”ë° ì´ë¯¸ íƒˆí‡´ ê³„ì • ë“±)
-  500(INTERNAL_SERVER_ERROR): ë°±ì—”ë“œ ë‚´ë¶€ì—ì„œ ë°œìƒí•˜ëŠ” ì—ëŸ¬
-  ì—¬ê¸°ëŠ” ì»¤ìŠ¤í…€ exceptionì˜ ì¢…ë¥˜ë¥¼ ë‘ê°€ì§€ë¡œ ë‚˜ëˆ„ëŠ”ë° í•˜ë‚˜ëŠ” ë©”ì„¸ì§€ë§Œ ë„˜ê²¼ì„ë•Œ ë©”ì„¸ì§€ì™€ 500ì—ëŸ¬ë¥¼ ë„˜ê¸°ëŠ” ê²ƒì´ê³  ë˜ í•˜ë‚˜ëŠ” ë©”ì„¸ì§€ì™€ ì—ëŸ¬ë¥¼ ê°™ì´ ì»¤ìŠ¤í…€í•´ì„œ ë³´ë‚¼ ìˆ˜ ìˆëŠ” ì—ëŸ¬ì´ë‹¤.
```java
@Getter
@Setter
public class MyException extends Exception { // ì»¤ìŠ¤í…€ ì˜ˆì™¸ í´ë˜ìŠ¤ ì •ì˜

    private HttpStatus status; // HTTP ìƒíƒœ ì½”ë“œ ê°ì²´

    /**
     * ë©”ì„¸ì§€ë§Œ ë„˜ê²¼ì„ë•Œ í•­ìƒ 500ì„ ë°˜í™˜í•œë‹¤.
     * @param message
     */
    public MyException(String message) {
        super(message); // Exception í´ë˜ìŠ¤ì˜ ìƒì„±ìë¥¼ í˜¸ì¶œí•˜ì—¬ ë©”ì‹œì§€ë¥¼ ì„¤ì •
        this.status = HttpStatus.INTERNAL_SERVER_ERROR;
    }

    public MyException(HttpStatus status, String message) {
        super(message); // Exception í´ë˜ìŠ¤ì˜ ìƒì„±ìë¥¼ í˜¸ì¶œí•˜ì—¬ ë©”ì‹œì§€ë¥¼ ì„¤ì •
        this.status = status; // ì‚¬ìš©ì ì •ì˜ HTTP ìƒíƒœ ì½”ë“œ ì„¤ì •
    }
}
```

### ğŸ“Œ 1-3. AlreadyExistException(ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ê°’ ì—ëŸ¬)
- ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ê°’ì´ë¼ê³  í‘œí˜„í•˜ëŠ” ì—ëŸ¬ì´ë‹¤ (ex."ì´ë¯¸ ë“±ë¡ëœ ì´ë©”ì¼ì…ë‹ˆë‹¤")
- í•˜ì—¬ "ì´ë¯¸ ë“±ë¡ëœ ì´ë©”ì¼ì…ë‹ˆë‹¤"ì™€ ê°™ì€ ìƒí™©ì— ë§ëŠ” ë©”ì„¸ì§€ì™€ ì˜ëª»ëœ ìš”ì²­(ì´ë¯¸ ìˆëŠ” ê°’ì„ ìš”ì²­í•¨) ì—ëŸ¬ë¥¼ ë„ìš´ë‹¤.
```java
public class AlreadyExistException extends MyException {

    public AlreadyExistException(String message) {
        super(HttpStatus.BAD_REQUEST, message);
    }
}
```

### ğŸ“Œ 1-4. @ExceptionHandler (ì—ëŸ¬ì²˜ë¦¬ í•¸ë“¤ëŸ¬)
- @ControllerAdvice: ì‹±ê¸€í„´ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡ë˜ë©° ê°„ë‹¨íˆ ê³µí†µ ê´€ì‹¬ì‚¬(Advice)ë¥¼ ëª¨ë“  @Controllerì— ì ìš©í•  ìˆ˜ ìˆëŠ” ì–´ë…¸í…Œì´ì…˜ì´ë‹¤.
- @RestControllerAdviceëŠ” @ControllerAdvice + @ResponseBodyì˜ í•©ì„± ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ í•­ìƒ JSON ë“± HTTP ì‘ë‹µ ë³¸ë¬¸ìœ¼ë¡œ ë°˜í™˜(@ResponseBody)í•œë‹¤.
- ë‚´ë¶€ì •ì˜ëŠ” ì•„ë˜ì— ì²¨ë¶€í–ˆë‹¤.
- Controller, Service ë“±ì—ì„œ ì˜ˆì™¸ ë°œìƒ -> DispatcherServletì´ ì˜ˆì™¸ ê°ì§€ -> @RestControllerAdviceì— ë“±ë¡ëœ @ExceptionHandler ë©”ì„œë“œ ê²€ìƒ‰ -> ì˜ˆì™¸ íƒ€ì…(í´ë˜ìŠ¤ ê¸°ì¤€)ìœ¼ë¡œ ê°€ì¥ ì˜ ë§ëŠ” ë©”ì„œë“œ ì‹¤í–‰ -> @ExceptionHandler ë©”ì„œë“œì—ì„œ JSON(í˜¹ì€ ë‹¤ë¥¸ ê°ì²´) ë°˜í™˜ -> @ResponseBodyì— ì˜í•´ ë°˜í™˜ê°’ì´ ìë™ìœ¼ë¡œ JSON ë³€í™˜ -> HTTP ìƒíƒœì½”ë“œ + JSON ë³¸ë¬¸ìœ¼ë¡œ ì‘ë‹µí•œë‹¤.
- @ExceptionHandler : ëª¨ë“  ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©´ ì‹¤ì œë¡œ ë°œìƒí•œ ì˜ˆì™¸ ê°ì²´ë¥¼ ì´ ë©”ì„œë“œì— ë„˜ê²¨ì£¼ê³  ì´ ë©”ì„œë“œê°€ ìë™ ì‹¤í–‰ëœë‹¤. (ì—¬ëŸ¬ê°œê°€ ìˆë‹¤ë©´ ìƒí™©ì— ê°€ì¥ ë§ëŠ” ê²ƒìœ¼ë¡œ)
- result.put("error", e.getClass().getSimpleName()); : ì—ëŸ¬ í´ë˜ìŠ¤ëª…ìœ¼ë¡œ ë‚´ê°€ ì •ì˜í•œ ì—ëŸ¬ë©´ AlreadyExistException ê°™ì€ ê²ƒì„ ì˜ë¯¸í•œë‹¤.

- ë³´ìŠ¤ ì‚¬ì´íŠ¸ì—ì„œë„ ì•„ë˜ì™€ ê°™ì´ ì‚¬ìš©í•˜ë©´ ì¢‹ì„ ê±° ê°™ë‹¤.
- ì´ë¯¸ ê°€ì…ëœ ì´ë©”ì¼(ì•„ì´ë””) -> 409 CONFLICT
- ì´ë©”ì¼, ë¹„ë°€ë²ˆí˜¸, ì „í™”ë²ˆí˜¸ ë“± í˜•ì‹ ì˜¤ë¥˜ -> 400 BAD_REQUEST
- ì—†ëŠ” ì´ë©”ì¼, ë¹„ë°€ë²ˆí˜¸ -> 404 Not Found
- ë¡œê·¸ì¸ ì•ˆí•˜ê³  ì‚¬ì´íŠ¸ ì§„ì… -> 401 UNAUTHORIZED
- ë¹„ë°€ë²ˆí˜¸ í‹€ë¦¼ -> 400 Bad Request ë˜ëŠ” 401 UNAUTHORIZED
- ì„¸ì…˜ ë§Œë£Œ -> 401 UNAUTHORIZED
- ì—†ëŠ” ìƒí’ˆ, ì£¼ë¬¸, ì¥ë°”êµ¬ë‹ˆ ë‹´ê¸° -> 404 Not Found
- í’ˆì ˆ ìƒí’ˆ ë‹´ê¸°/ì£¼ë¬¸ (í’ˆì ˆ í•  ê±°ë©´) -> 409 Conflict
- ì´ë¯¸ ì·¨ì†Œí•œ ìƒí™©ì—ì„œ ì¤‘ë³µ ì·¨ì†Œ, ì‚­ì œ -> 409 Conflict
```java
// @RestControllerAdvice ë‚´ë¶€ ì •ì˜
@ControllerAdvice
@ResponseBody
public @interface RestControllerAdvice { ... }
```
```java
@Slf4j
@RestControllerAdvice
public class MyExceptionHandler {
    
    @ExceptionHandler(Exception.class)
    public ResponseEntity<Map<String, Object>> myExceptionHabdler(Exception e) {
        log.error(e.getMessage(), e); // ë¡œê·¸ë¥¼ í•œë²ˆë§Œ ë‚¨ê¹€ -> ë“¤ì–´ì˜¨ ì—ëŸ¬ ë©”ì„¸ì§€ì™€ ì—ëŸ¬ ê°ì²´ ìì²´ë¥¼ í¬í•¨í•˜ì—¬

        int status = HttpStatus.INTERNAL_SERVER_ERROR.value(); // ê¸°ë³¸ì ìœ¼ë¡œ 500 ì—ëŸ¬ë¡œ ì„¤ì • (ì•„ë¬´ë§ ì—†ëŠ” ê·¸ëƒ¥ ì¼ë°˜ ì—ëŸ¬ë©´ int 500ì„ ë³´ëƒ„)

        if (e instanceof MyException) { // ë§Œì•½ ë‚´ê°€ ë§Œë“  ì˜ˆì™¸ë¼ë©´
            MyException myException = (MyException) e;
            status = myException.getStatus().value(); // MyExceptionì˜ ìƒíƒœ ì½”ë“œë¡œ ë³€ê²½
        }

        Map<String, Object> result = new LinkedHashMap<>();
        result.put("status", status);
        result.put("message", e.getMessage()); // ì—ëŸ¬ ë©”ì„¸ì§€
        result.put("error", e.getClass().getSimpleName()); // ì—ëŸ¬ íƒ€ì…
        result.put("timestamp", LocalDateTime.now().toString()); // ì—ëŸ¬ ë°œìƒ ì‹œê°„\

        return ResponseEntity.status(status).body(result); // ìƒíƒœ ì½”ë“œì™€ ê²°ê³¼ë¥¼ ë°˜í™˜
    }
}
```

### ğŸ“Œ 1-5. ì—ëŸ¬ì²˜ë¦¬ì™€ @RequiredArgsConstructorë¥¼ ë°˜ì˜í•œ memberservice
- @RequiredArgsConstructor -> ëª¨ë“  private í•„ë“œê°’ì„ ì£¼ì…ë°›ëŠ” ìƒì„±ì ìë™ìƒì„±, í•„ë“œì— finalë¶™ì—¬ì„œ í•œ ë²ˆ ì£¼ì…ëœ ì˜ì¡´ì„± ê°ì²´ê°€ "ì ˆëŒ€ ë°”ë€Œì§€ ì•ŠëŠ”ë‹¤"ëŠ” ê±¸ ì½”ë“œ ì°¨ì›ì—ì„œ ë³´ì¥í•´ì¤Œ
- finalì´ ë¶™ì–´ìˆìœ¼ë©´ "ì´ í•„ë“œëŠ” ìƒì„±ìì—ì„œ ê¼­ ì´ˆê¸°í™”í•´ì•¼ í•˜ê³ , ê·¸ í›„ì—ëŠ” ì ˆëŒ€ ë°”ë€Œì§€ ì•Šì•„!" ë¼ëŠ” ë©”ì‹œì§€ê°€ ì½”ë“œë¥¼ ë³´ëŠ” ì‚¬ëŒ(ë¯¸ë˜ì˜ ë‚˜, ë™ë£Œ)í•œí…Œ í™•ì‹¤í•˜ê²Œ ì „ë‹¬ë¨
- í…ŒìŠ¤íŠ¸ ì½”ë“œì—ì„œë„ í•œ ë²ˆ ì£¼ì…í•œ Mock ê°ì²´ê°€ í…ŒìŠ¤íŠ¸ ì¤‘ì— ë³€ê²½ë˜ëŠ” ì‹¤ìˆ˜ë¥¼ ë°©ì§€í•  ìˆ˜ ìˆë‹¤.
- ê°’ì´ ë°”ë€Œì§€ ì•Šìœ¼ë‹ˆê¹Œ ì—¬ëŸ¬ ìŠ¤ë ˆë“œê°€ ë™ì‹œì— ì ‘ê·¼í•´ë„ ì•ˆì „í•˜ê²Œ ë™ì‘í•¨(ì“°ë ˆë“œ ì„¸ì´í”„)
- ì—ëŸ¬ë¥¼ í•„ìš”í•œ ìƒí™©ì—ì„œ ë˜ì§€ê¸°ë§Œ í•˜ë©´ ì–´ì§œí”¼ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ê°€ ì²˜ë¦¬í•˜ê¸° ë•Œë¬¸ì— ê·¸ëƒ¥ ë˜ì§€ê¸°ë§Œ í•˜ë©´ ëœë‹¤. ê·¸ ë‚˜ë¦„ì˜ ì²˜ë¦¬ë¥¼ í•œë‹¤.
- ë©”ì„œë“œì˜ ì‹¤í–‰ ì—¬ë¶€ì™€ ê´€ê³„ì—†ì´ ì—ëŸ¬ê°€ ë‚˜ë©´ ì—ëŸ¬ jsonë§Œì„ ë°˜í™˜ë°›ëŠ”ë‹¤.

- ì—ëŸ¬ ê´€ë ¨ ê¶ê¸ˆì¦ í•´ì†Œ
- ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ try-catchë¡œ ì§ì ‘ ì˜ˆì™¸ë¥¼ ì¡ì•„ë²„ë¦¬ë©´ â†’ @RestControllerAdviceì˜ @ExceptionHandlerëŠ” 'ë°œë™ë˜ì§€ ì•ŠëŠ”ë‹¤!' ì™œëƒë©´ Springì˜ ì „ì—­ ì˜ˆì™¸ì²˜ë¦¬(í•¸ë“¤ëŸ¬)ëŠ”
"ìœ„ë¡œ ì „ë‹¬ë˜ì§€ ì•Šì€(=catchë˜ì§€ ì•Šì€) ì˜ˆì™¸"ë§Œ dispatcherserveletì´ ì¡ê¸° ë•Œë¬¸ì´ë‹¤.
- ê·¸ë¦¬ê³  ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©´ ê·¸ ìˆœê°„ ì—ëŸ¬ê°€ í•¨ìˆ˜ í˜¸ì¶œ ìŠ¤íƒì„ ê±°ìŠ¬ëŸ¬ ì˜¬ë¼ê°€ë©´ì„œ catchí•  ì¹œêµ¬ë¥¼ ì°¾ê³  catchí•  ì¹œêµ¬ê°€ ì—†ìœ¼ë©´ dispatcherserveletì´ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ ì‹¤í–‰í•˜ëŠ” êµ¬ì¡°ì´ê¸° ë•Œë¬¸ì— ì—ëŸ¬ê°€ ë™ì‹œì— ë°œìƒí•  ê°€ëŠ¥ì„±ì€ ì—†ë‹¤.
- ì‹¤ì œë¡œ ì˜ˆì™¸(Exception)ê°€ ë°œìƒí•´ì„œ @ExceptionHandler(= ì „ì—­ ì˜ˆì™¸ í•¸ë“¤ëŸ¬)ê°€ ë°œë™í•˜ë©´ **ê·¸ë•Œê¹Œì§€ í˜¸ì¶œëœ í•¨ìˆ˜ ìŠ¤íƒ(ì‹¤í–‰ íë¦„)ì€ ì „ë¶€ "ì¤‘ë‹¨"**ë˜ê³  ì˜ˆì™¸ê°€ í„°ì§„ "ìˆœê°„" ë°”ë¡œ ìœ„ë¡œ ì˜¬ë¼ê°€ì„œ **ê°€ì¥ ê°€ê¹Œìš´ í•¸ë“¤ëŸ¬ë¡œ "ì í”„"**í•˜ëŠ” ì‹ìœ¼ë¡œ ë™ì‘í•œë‹¤.
- ì´ë•Œ @ControllerAdviceëŠ” @Controller ë¶™ì€ í´ë˜ìŠ¤ì˜ ì˜ˆì™¸ë¥¼ ì£¼ë¡œ ì²˜ë¦¬í•˜ê³ 
- @RestControllerAdviceëŠ” @RestControllerê°€ ë¶™ì€ í´ë˜ìŠ¤ì˜ ì˜ˆì™¸ë¥¼ ì£¼ë¡œ ì²˜ë¦¬í•œë‹¤.
```java
@Slf4j
@Service
@RequiredArgsConstructor
public class MemberServiceImpl implements MemberService {
    private final MemberMapper memberMapper;

    @Override
    public void isUniqueUserId(Member input) throws Exception {
        if (memberMapper.selectCount(input) > 0) {
            throw new AlreadyExistException("ì´ë¯¸ ì‚¬ìš©ì¤‘ì¸ ì•„ì´ë””ì…ë‹ˆë‹¤.");
        }
    }

    @Override
    public void isUniqueEmail(Member input) throws Exception {
        if (memberMapper.selectCount(input) > 0) {
            throw new AlreadyExistException("ì´ë¯¸ ì‚¬ìš©ì¤‘ì¸ ì´ë©”ì¼ì…ë‹ˆë‹¤.");
            }
    }

    @Override
    public Member join(Member input) throws Exception {
        int row = 0;

        Member temp1 = new Member();
        temp1.setUserId(input.getUserId());
        this.isUniqueUserId(temp1);

        Member temp2 = new Member();
        temp2.setEmail(input.getEmail());
        this.isUniqueEmail(temp2);

        row = memberMapper.insert(input);
        if (row < 1) {
            throw new ServiceNoResultException("íšŒì›ê°€ì…ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."); // ë”°ë¡œ ìƒíƒœ ì •ì˜ ì•ˆë˜ì–´ ìˆì–´ì„œ 500
        }

        return memberMapper.selectItem(input);
    }
}
```
