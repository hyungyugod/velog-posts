# 📌 1. 엑셀 출제유형분석2회 - 기타작업 3
## 1-1. 버튼 요소에 프로시저 코딩하기
- 디자인 모드로 변환한 후에 요소를 더블클릭하면 vba 창이 나온다.
- alt f11 또한 vba창을 연다
- 프로시저이름은 개체이름 + 이벤트 구조로 약속되어있을때 엑셀의 엔진에서 자동으로 실행해주므로 vba 창에서 각각 선택하여 프로시저 이름을 바꿀 수 있는 콤보박스가 상단에 마련되어있다.
- 콤보상자에 목록값을 입력하는 법을 개체명.additem "값" 이런식으로 하나하나 넣는 방법이 있고 개체명.Rowsource = "A1:A5" 이런식으로 한 묶음을 한번에 넣는 방법이 있다.
- 입력행의 위치 구하는 공식을 알아야한다. range("표의 첫셀").correntregion(표의 연결된 자료들).rows.count + offset(숫자로 입력) 이다.
- 표의 첫 셀은 필드값이 저장되어있는 셀부터이다.
- 이때 표의 제목이 표와 붙어있을때 correntregion에 표의 제목이 포함된다. 이후 offset을 더해서 입력할 행의 행번호가 되도록 맞춰주어야 한다.
- 그리고 입력받은 값은 문자열이므로 val 명령으로 숫자로 변경해주어야 한다.
- 입력한 다음에 폼을 비어있게 하고 싶으면 입력 코드 후에 빈값을 입력하는 코드를 추가적으로 정리해줘도 된다.
- 종료 명령은 unload me이다. 이후 셀을 지정하여 문구가 나오려고 한다면 range의 셀에 해당 문자를 대입해주면 된다.
- cells는 행열, range는 b17 이런 식으로 대입하여 특정 셀을 지정한다.

```vba
Private Sub UserForm_Initialize()
Cmb학과.RowSource = "j4:j8"
End Sub


Private Sub Cmd입력_Click()
입력행 = Range("b3").CurrentRegion.Rows.Count + 2

Cells(입력행, 2) = Cmb학과
Cells(입력행, 3) = Txt성명
Cells(입력행, 4) = Txt연구과제
Cells(입력행, 5) = Txt연구논문
Cells(입력행, 6) = Txt산학협동
Cells(입력행, 7) = Val(Txt연구과제) + Val(Txt연구논문) + Val(Txt산학협동)

Cmb학과 = ""
Txt성명 = ""
Txt연구과제 = ""
Txt연구논문 = ""
Txt산학협동 = ""

End Sub


Private Sub Cmd종료_Click()

Unload Me

Range("b17") = "수고하셨습니다."

End Sub
```

