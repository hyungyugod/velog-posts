# 📌 1. 엑셀 출제유형분석3회-(기본작업, 계산작업)
## 1-1. 고급필터
- vba에서 val이 엑셀함수에서 value이다.
- 셀의 값을 가공할때는 일반식이 아니고 논리식을 이용하여 고급필터 조건을 서술해야한다.
- and 조건은 그냥 옆자리에 서술하면 된다. 그리고 조건3으로 필드명을 새로 적어준다.
- 만약 논리식으로 수식을 작성했을때 일반식으로 작성할때 처럼 필드명을 원본과 똑같이 작성하면 원본과 바인딩된 일반식으로 착각하고 내부 식을 처리하여 전부 오류가 나게 된다. 일반식이 올 자리인데 논리식이 와 있기 때문이다.
- year 등의 날짜함수로 추출된 값은 이미 숫자이다.

## 1-2. 조건부 서식
- 글자수는 len으로 센다.
- 수식으로 셀을 지정할때 절대화를 풀어주는 것을 잊으면 안된다.
- 채우기의 무늬 색에서 색 이름을 확인하고 테마색에서 색을 고른다.

## 1-3. 페이지 레이아웃 설정
- 페이지 설정에서 페이지 가운데 맞춤을 가로로 설정하므로서 페이지를 가운데 정렬할 수 있다. 인쇄에서 레이아웃을 확인할 수 있다.
- 같은 페이지 설정에서 머리글과 바닥글에 관련된 설정을 할 수 있다.

## 1-4. 데이터베이스 함수 이용한 계산문제
- 함수 마법사로 작성할때 절대화를 신경써야 한다.
- 데이터베이스 함수에서 필드 인수는 조건에 맞는 결과를 낼 필드명을 지정해주면 된다. 즉 데이터 베이스에서 특정 필드를 지정해 주는 것이다. 이때 필드명이 아닌 필드 번호(인덱스)로 넣어도 된다.
- =DSUM($B$2:$H$32,$G$2,F$36:F$37)/DCOUNT($B$2:$H$32,$G$2,F$36:F$37)
- 위에서처럼 두번째 필드값은 조건과 관련된 값이 아니라 더하거나 셀 대상의 필드이다.

## 1-5. hlookup, match 함수 이용하기
- lookup함수와 match함수가 같이 있을때는 match함수부터 풀이하는 것이 좋다. 
- hlookup은 행단위로 아래로 내려가며 찾는 것이기 때문에 열 조건을 포함하여 테이블범위를 작성하고 match로 구한 행 인덱스를 lookup함수의 인수로 사용해야 한다. 이때 match는 찾을 값을 찾을 테이블에서 찾아 인덱스를 반환하는데 행단위, 열단위 어느것으로 설정하든 설정가능해서 우선 정하고 이를 lookup함수의 인수로 쓰는것이 편리하다.
- 범위조건인 경우 범위조건을 true로 설정한다.
- 1이상 이런식으로 필드명이 나와있어도 이건 진짜 문자열이 아니라 셀 서식이다.
- HLOOKUP(B3,$C$43:$E$48,MATCH(F3,$B$43:$B$48,0),1)*H3
- 위에서 중요한 것은 hlookup은 필드명뿐만 아니라 전체 데이터를 선택해야한다는 점이다.

## 1-6. 배열수식 if 사용
- 한방향으로 채우기핸들을 사용할 경우는 굳이 절대화를 하지 않아도 된다.
- 명자를 붙여야할 경우 계산결과에  &"명"을 쓰면된다.
- {=COUNT(IF($C$3:$C$32=M11,1))&"명"}

## 1-7. 배열수식 if 미사용
- 배열수식 문제에세 if를 제시하지 않으면 조건 * 조건 즉 불리언 연산으로 계산함수를 사용해야 한다.
- 채우기 핸들을 좌우 위아래 모두 이동해야할 경우 절대화를 철저히 해주어야 한다. 움직이지 않는 곳에 $를 걸어 절대화를 한다.
- sum 함수를 이용하여 개수를 구할때는 조건 * 조건 * 계산범위에서 계산범위를 1로 두면 된다.
- if를 사용할때와 차이는 if는 if 함수 안에서 조건과 계산범위를 콤마로 구분하여 작성한다.

## 1-8. 사용자 정의 함수를 활용하여 표에 값 표시하기
- 새로운 사용자 정의 함수를 만드는 것은 새로운 모듈을 만드는 것이므로 새 모듈을 만들고 코딩을 해주면 된다.
- if문은 if 조건 then elseif 조건 then end if 형식이다.
- if문을 중첩해서 쓸때 end if 를 두번 써줘야함을 유의해야한다.
- 만든 함수는 함수마법사를 통해 사용한다.

