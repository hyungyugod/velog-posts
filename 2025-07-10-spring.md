# ğŸ“Œ 0. ë³´ìŠ¤ í´ë¡  í”„ë¡œì íŠ¸
### ğŸ“Œ 0-1. ë¡œê·¸ì¸ í•œ ìƒí™©ì—ì„œë„ ë¡œê·¸ì¸ í˜ì´ì§€ì— ì ‘ê·¼ ê°€ëŠ¥í•œ ë¬¸ì œ
- ë¡œê·¸ì¸ í˜ì´ì§€ì— ì ‘ê·¼í–ˆëŠ”ë° ì´ë¯¸ ì„¸ì…˜ì´ ìˆìœ¼ë©´ ë©”ì¸í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸í•œë‹¤. 
- ì¦‰ ì´ë¯¸ ë¡œê·¸ì¸ì´ ë˜ì–´ìˆìœ¼ë©´ ë©”ì¸í˜ì´ì§€ë¡œ ì´ë™ì‹œì¼œì¤€ë‹¤.
```java
/**
 * ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™, refererê°€ ìˆë‹¤ë©´ í•´ë‹¹ URLë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸í•  ìˆ˜ ìˆë„ë¡ ì²˜ë¦¬
 * @param request
 * @param model
 * @return
 */
@GetMapping("/login")
public String loginPage(HttpServletRequest request, Model model) throws Exception {
    if (request.getSession().getAttribute("memberInfo") != null) {
        return "redirect:/main"; // ì´ë¯¸ ë¡œê·¸ì¸ëœ ê²½ìš° ë©”ì¸ í˜ì´ì§€ë¡œ
    }

    String referrer = request.getHeader("Referer"); // ëŒ€ë¬¸ì "Referer" ì‚¬ìš©ì´ ë§ìŒ
    if (referrer == null || referrer.contains("/login")) {
    referrer = "/main"; // ê¸°ë³¸ê°’ ëª…ì‹œ
    }   

    model.addAttribute("referrer", referrer); // ë¦¬ë‹¤ì´ë ‰íŠ¸í•  URLì„ ëª¨ë¸ì— ì¶”ê°€
    return "login/index";
}
```

### ğŸ“Œ 0-2. api ë¬¸ì œ ìë™í™” -> swagger
- ì›ë˜ëŠ” REST APIì˜ ëª…ì„¸(Documentation) í‘œì¤€ í¬ë§·ì´ì, ëª…ì„¸ ë¬¸ì„œë¥¼ ìë™ ìƒì„±í•´ì£¼ëŠ” ë„êµ¬ì˜€ìœ¼ë‚˜ ì§€ê¸ˆì€ Swaggerë¼ëŠ” ì´ë¦„ì´ "OpenAPI Specification(OAS)"ìœ¼ë¡œ ë°”ë€Œë©´ì„œ REST APIì˜ êµ¬ì¡°, íŒŒë¼ë¯¸í„°, ì‘ë‹µ, ì˜ˆì™¸ ë“± ëª¨ë“  ê²ƒì„ ë¬¸ì„œí™”í•˜ëŠ” í‘œì¤€ í¬ë§·ìœ¼ë¡œ ìë¦¬ì¡ì•˜ë‹¤.
- implementation 'org.springdoc:springdoc-openapi-starter-webmvc-ui:2.6.0' ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì¶”ê°€í•˜ë©´ ìŠ¤í”„ë§ì—ì„œ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ìˆê³  Swagger UIì™€ **OpenAPI 3.x ëª…ì„¸ ë¬¸ì„œ(JSON/YAML)**ë¥¼ ìë™ ìƒì„±í•´ì¤€ë‹¤.
- Swagger(OpenAPI) ì–´ë…¸í…Œì´ì…˜ì€ API ì½”ë“œì— ë¬¸ì„œí™” ì •ë³´ë¥¼ ì§ì ‘ ì¶”ê°€í•  ìˆ˜ ìˆë„ë¡ í•´ì¤€ë‹¤.
- @Tag: API ê·¸ë£¹/ë„ë©”ì¸ë³„ ë¬¶ìŒ
- @Operation: ê°œë³„ API ë©”ì„œë“œ(ì„¤ëª…, summary, íŒŒë¼ë¯¸í„° ë“±)
- @ApiResponses: ì‘ë‹µ ì½”ë“œë³„ ì„¤ëª…
```java
@Controller
@RequiredArgsConstructor
@Tag(name = "ë¡œê·¸ì¸ ì»¨íŠ¸ë¡¤ëŸ¬", description = "ë¡œê·¸ì¸ í˜ì´ì§€ë¥¼ í‘œì‹œí•˜ê³ , ì´ë¯¸ ë¡œê·¸ì¸ëœ ì‚¬ìš©ìë¥¼ ë©”ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸í•˜ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤.")
public class LoginController {
    /**
     * ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™, refererê°€ ìˆë‹¤ë©´ í•´ë‹¹ URLë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸í•  ìˆ˜ ìˆë„ë¡ ì²˜ë¦¬
     * @param request HttpServletRequest ê°ì²´
     * @param model Model ê°ì²´
     * @return ë¡œê·¸ì¸ í˜ì´ì§€ ë·° ì´ë¦„
     */
    @Operation(
        summary = "ë¡œê·¸ì¸ í˜ì´ì§€ ì¡°íšŒ",
        description = "ë¡œê·¸ì¸ í˜ì´ì§€ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤. ì´ë¯¸ ë¡œê·¸ì¸ëœ ì‚¬ìš©ìëŠ” ë©”ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ëœë‹¤. " +
                    "ì´ì „ í˜ì´ì§€ ì •ë³´(Referer)ê°€ ìˆìœ¼ë©´ ë¡œê·¸ì¸ í›„ í•´ë‹¹ í˜ì´ì§€ë¡œ ëŒì•„ê°ˆ ìˆ˜ ìˆë„ë¡ ì²˜ë¦¬í•œë‹¤.",
        parameters = {
            @Parameter(name = "request", description = "í´ë¼ì´ì–¸íŠ¸ê°€ ìš”ì²­í•œ HTTP ìš”ì²­ ê°ì²´", required = true, hidden = true),
            @Parameter(name = "model", description = "ë·°ì— ë°ì´í„°ë¥¼ ì „ë‹¬í•˜ê¸° ìœ„í•œ ëª¨ë¸ ê°ì²´", required = true, hidden = true)
        }
    )
    @ApiResponses(value = {
        @ApiResponse(responseCode = "200", description = "ë¡œê·¸ì¸ í˜ì´ì§€ ì •ìƒ í‘œì‹œ"),
        @ApiResponse(responseCode = "302", description = "ì´ë¯¸ ë¡œê·¸ì¸ëœ ì‚¬ìš©ì, ë©”ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸"),
        @ApiResponse(responseCode = "500", description = "ì„œë²„ ë‚´ë¶€ ì˜¤ë¥˜")
    })
    @GetMapping("/login")
    public String loginPage(
        HttpServletRequest request, Model model) throws Exception {
        if (request.getSession().getAttribute("memberInfo") != null) {
            return "redirect:/main"; // ì´ë¯¸ ë¡œê·¸ì¸ëœ ê²½ìš° ë©”ì¸ í˜ì´ì§€ë¡œ
        }

        String referrer = request.getHeader("Referer"); // ëŒ€ë¬¸ì "Referer" ì‚¬ìš©ì´ ë§ìŒ
        if (referrer == null || referrer.contains("/login")) {
        referrer = "/main"; // ê¸°ë³¸ê°’ ëª…ì‹œ
        }   

        model.addAttribute("referrer", referrer); // ë¦¬ë‹¤ì´ë ‰íŠ¸í•  URLì„ ëª¨ë¸ì— ì¶”ê°€
        return "login/index";
    }
}
```

### ğŸ“Œ 0-3. ê¸°ì¡´ ë¹„ë°€ë²ˆí˜¸ ì´ˆê¸°í™” ë¡œì§ ë¶„ë¦¬ 
- ì›ë˜ ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ê²€ì¦ê³¼ ì„œë¹„ìŠ¤ í˜¸ì¶œ, ì‘ë‹µ ë°˜í™˜ ì •ë„ë§Œ í•´ì•¼í•˜ì§€ë§Œ ë„ˆë¬´ ë§ì€ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ë‹´ë‹¹í•˜ê³  ìˆì–´ ìš°ì„  í•´ë‹¹ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ë¶„ë¦¬í•˜ê¸°ë¡œ í–ˆë‹¤.
- ê·¸ëŸ¬ëŠ” ê³¼ì •ì—ì„œ managersë¥¼ ë§Œë“¤ê³  ê¸°ì¡´ì— ííŠ¸ëŸ¬ì ¸ìˆë˜ í´ë˜ìŠ¤ë“¤ì„ íŒ¨í‚¤ì§€ë¡œ ë¬¶ì–´ë‚´ì—ˆë‹¤.
- ì´ë•Œ ìë™ìœ¼ë¡œ íŒ¨í‚¤ì§€ importê°€ ìˆ˜ì •ë˜ì§€ë§Œ ë‹¤ë¥¸ ì‚¬ëŒì˜ ì»´í“¨í„°ì—ì„œ í•´ë‹¹ ê²½ë¡œë¥¼ ëª»ì°¾ìœ¼ë©´ í•œë²ˆ ê·¸ íŒŒì¼ì„ ì§ì ‘ ì°¾ì•„ê°€ í´ë¦­í•˜ë©´ ë°”ë¡œ ì˜¤ë¥˜ê°€ í•´ê²°ëœë‹¤.
```java
@PostMapping("/api/reset-pw")
    public ResponseEntity<ResponseDTO> resetPw(@RequestBody Map<String, String> params) throws Exception {
        String email = params.get("email");
        ResponseDTO response;

        // ì´ë©”ì¼ ë¹ˆê°’ ê²€ì‚¬
        if (email == null || email.trim().isEmpty()) {
            throw new InvalidFormatException("ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”.");
        }

        // ì´ë©”ì¼ í˜•ì‹ ê²€ì‚¬
        String emailPattern = "^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$";
        if (!Pattern.matches(emailPattern, email)) {
            throw new InvalidFormatException("ì˜¬ë°”ë¥¸ ì´ë©”ì¼ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤.");
        }

        // ì…ë ¥ëœ ì´ë©”ì¼ë¡œ User ê°ì²´ ìƒì„±
        User inputUser = new User();
        inputUser.setUserEmail(email);

        // íšŒì› ì •ë³´ ì¡°íšŒ
        User user = loginService.findByEmail(inputUser);
        
        if (user == null) {
            throw new UnauthorizedException("ì…ë ¥í•˜ì‹  ì •ë³´ì™€ ì¼ì¹˜í•˜ëŠ” ê³„ì •ì´ ì—†ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì‹œê±°ë‚˜ ì‚¬ì´íŠ¸ ìš´ì˜ìì—ê²Œ ë¬¸ì˜í•´ì£¼ì„¸ìš”.");
        }

        // ì„ì‹œ ë¹„ë°€ë²ˆí˜¸ ìƒì„±(8ìë¦¬: ì˜ë¬¸, ìˆ«ì, íŠ¹ìˆ˜ë¬¸ì í¬í•¨)
        String chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";
        String nums = "0123456789";
        SecureRandom  rnd = new SecureRandom();
        String newPassword = null;

        while (true) {
            StringBuilder sb = new StringBuilder();
            // ì˜ë¬¸ì 1ê°œ ë¬´ì¡°ê±´ í¬í•¨
            sb.append(chars.charAt(rnd.nextInt(chars.length())));
            // ìˆ«ì 1ê°œ ë¬´ì¡°ê±´ í¬í•¨
            sb.append(nums.charAt(rnd.nextInt(nums.length())));

            // ë‚˜ë¨¸ì§€ 6ìë¦¬ëŠ” ì˜ë¬¸/ìˆ«ì ì„ì–´ì„œ ëœë¤ ìƒì„±
            String all = chars + nums;
            for (int i = 0; i < 6; i++) {
                sb.append(all.charAt(rnd.nextInt(all.length())));
            }

            // ì„ê¸° (ì˜ë¬¸, ìˆ«ìê°€ 1ë²ˆì§¸, 2ë²ˆì§¸ì— ëª°ë¦¬ì§€ ì•Šê²Œ)
            List<Character> pwChars = new ArrayList<>();

            for (char c : sb.toString().toCharArray()) pwChars.add(c);

            Collections.shuffle(pwChars);

            StringBuilder resultPw = new StringBuilder();

            for (char c : pwChars) resultPw.append(c);

            newPassword = resultPw.toString();

            // ì •ê·œì‹ ì¡°ê±´ ì²´í¬
            if (newPassword.matches("^(?=.*[A-Za-z])(?=.*\\d)[A-Za-z\\d]{8}$")) {
                break;
            }
            // ì¡°ê±´ ë¶ˆë§Œì¡± ì‹œ whileë¡œ ë‹¤ì‹œ ìƒì„±
        }

        if (newPassword == null || newPassword.isEmpty()) {
            throw new InternalServerErrorException("ì„ì‹œ ë¹„ë°€ë²ˆí˜¸ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
        }

        // ì„ì‹œ ë¹„ë°€ë²ˆí˜¸ë¡œ ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •
        loginService.resetPw(user.getUserId(), newPassword);

        // ë©”ì¼ í…œí”Œë¦¿ íŒŒì¼ ì§ì ‘ ì½ê¸°
        String template;
        
        ClassPathResource resource = new ClassPathResource("mail_templates/reset_pw.html"); // mail_templates ë””ë ‰í† ë¦¬ì—ì„œ í…œí”Œë¦¿ íŒŒì¼ì„ ì½ì–´ì˜´        
        byte[] bytes = Files.readAllBytes(resource.getFile().toPath()); // íŒŒì¼ì„ ë°”ì´íŠ¸ ë°°ì—´ë¡œ ì½ìŒ
        template = new String(bytes, "UTF-8");

        // í…œí”Œë¦¿ ì¹˜í™˜
        template = template.replace("{{userEmail}}", user.getUserEmail());
        template = template.replace("{{password}}", newPassword);

        // ë©”ì¼ ë°œì†¡
        String subject = "[í´ë¡ ë³´ìŠ¤]" + user.getUserEmail() + "ë‹˜ì˜ ë¹„ë°€ë²ˆí˜¸ê°€ ì¬ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤.";
        
        MimeMessage message = javaMailSender.createMimeMessage();
        MimeMessageHelper helper = new MimeMessageHelper(message, false, "UTF-8");
        helper.setSubject(subject); // ë©”ì¼ ì œëª© ì„¤ì •
        helper.setText(template, true); // ë©”ì¼ ë‚´ìš© ì„¤ì •

        helper.setTo(user.getUserEmail()); // ì‚¬ìš©ìì˜ ì´ë©”ì¼ ì£¼ì†Œë¡œ ë°œì†¡
        helper.setFrom(new InternetAddress(senderEmail, senderName, "UTF-8"));  // ë¯¸ë¦¬ ì„¤ì •í•´ë‘” ì´ë©”ì¼ê³¼ ì´ë¦„ ì„¸íŒ…
        javaMailSender.send(message); // ë©”ì¼ ë°œì†¡

        // ì‘ë‹µ ê²°ê³¼ ìƒì„±
        response = ResponseDTO.builder()
                .success(true)
                .message("ì„ì‹œ ë¹„ë°€ë²ˆí˜¸ê°€ ì´ë©”ì¼ë¡œ ë°œì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.")
                .timestamp(LocalDateTime.now())
                .build();
        return ResponseEntity.ok(response);
    }
```
- ìœ„ì˜ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì•„ë˜ì²˜ëŸ¼ ì •ë¦¬í•˜ì˜€ë‹¤.
```java
@PostMapping("/api/reset-pw")
    public ResponseEntity<ResponseDTO> resetPw(@RequestBody Map<String, String> params) throws Exception {
        String email = params.get("email");
        ResponseDTO response;

        // ì´ë©”ì¼ ë¹ˆê°’ ê²€ì‚¬
        if (email == null || email.trim().isEmpty()) {
            throw new InvalidFormatException("ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”.");
        }

        // ì´ë©”ì¼ í˜•ì‹ ê²€ì‚¬
        String emailPattern = "^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$";
        if (!Pattern.matches(emailPattern, email)) {
            throw new InvalidFormatException("ì˜¬ë°”ë¥¸ ì´ë©”ì¼ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤.");
        }

        // ì…ë ¥ëœ ì´ë©”ì¼ë¡œ User ê°ì²´ ìƒì„±
        User inputUser = new User();
        inputUser.setUserEmail(email);

        // íšŒì› ì •ë³´ ì¡°íšŒ
        User user = loginService.findByEmail(inputUser);
        
        if (user == null) {
            throw new UnauthorizedException("ì…ë ¥í•˜ì‹  ì •ë³´ì™€ ì¼ì¹˜í•˜ëŠ” ê³„ì •ì´ ì—†ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì‹œê±°ë‚˜ ì‚¬ì´íŠ¸ ìš´ì˜ìì—ê²Œ ë¬¸ì˜í•´ì£¼ì„¸ìš”.");
        }

        // ì„ì‹œ ë¹„ë°€ë²ˆí˜¸ ìƒì„± í›„ ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • -> ë©”ì¼ ë°œì†¡
        loginService.resetPw(user);

        // ì‘ë‹µ ê²°ê³¼ ìƒì„±
        response = ResponseDTO.builder()
                .success(true)
                .message("ì„ì‹œ ë¹„ë°€ë²ˆí˜¸ê°€ ì´ë©”ì¼ë¡œ ë°œì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.")
                .timestamp(LocalDateTime.now())
                .build();
        return ResponseEntity.ok(response);
    }
```
- ì„ì‹œë¹„ë°€ë²ˆí˜¸ ìƒì„±, ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •, ê·¸ë¦¬ê³  ì¬ì„¤ì •ëœ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë©”ì¼ë¡œ ë°œì†¡í•˜ëŠ” ê¸°ëŠ¥ê¹Œì§€ë¥¼ ëª¨ë‘ loginService.resetPw(user); ì—ì„œ í•˜ë„ë¡ ìˆ˜ì •í•˜ì˜€ë‹¤.
- ê·¸ë¦¬ê³  ì´ë¡œì¸í•œ ë¹„ì¦ˆë‹ˆìŠ¤ë¡œì§ì€ ì„œë¹„ìŠ¤ì—ì„œ ë‹´ë‹¹í•˜ë¯€ë¡œ ì•„ë˜ì™€ ê°™ë‹¤.
```java
/**
 * ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ë©”ì„œë“œ êµ¬í˜„ì²´
 * @param user User ê°ì²´, ë¹„ë°€ë²ˆí˜¸ë¥¼ ì¬ì„¤ì •í•  ì‚¬ìš©ì ì •ë³´ í¬í•¨
 * @throws Exception ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • ì‹¤íŒ¨ ì‹œ ì˜ˆì™¸ ë°œìƒ
 */
@Override
public void resetPw(User user) throws Exception {

    //ì„ì‹œë¹„ë°€ë²ˆí˜¸ ìƒì„±
    String newPassword = passwordManager.generateNewPassword();

    if (newPassword == null || newPassword.isEmpty()) {
        throw new InternalServerErrorException("ì„ì‹œ ë¹„ë°€ë²ˆí˜¸ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
    }

    // ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •
    userMapper.resetPw(user.getUserId(), newPassword);

    // ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • í›„ ì¬ì„¤ì •ëœ ì´ë©”ì¼ì„ ê°€ì§€ê³  ì´ë©”ì¼ ì „ì†¡
    emailManager.newPasswordEmailSend(user, newPassword);
}
```
- ìœ ì € ê°ì²´ë¥¼ ë°›ì•„ ì„ì‹œë¹„ë°€ë²ˆí˜¸ ìƒì„± -> ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì • -> ì´ë©”ì¼ ì „ì†¡ì˜ í•œ íë¦„ì„ ì£¼ë„í•˜ë©° ê°ê° ê¸°ëŠ¥ì„ ë‹´ë‹¹í•˜ëŠ” ë§¤ë‹ˆì €ë¥¼ í˜¸ì¶œí•œë‹¤.
- ë§¤ë‹ˆì € ë©”ì„œë“œë¥¼ staticìœ¼ë¡œ ë§Œë“œë ¤ë‹¤ê°€ í™•ì¥ì„±ì„ ê³ ë ¤í•˜ì—¬ ê°ì²´ë¥¼ ìƒì„±í•˜ëŠ” í˜•íƒœë¡œ ë§Œë“¤ì—ˆë‹¤.
- ì•„ë˜ëŠ” ì°¨ë¡€ë¡œ ë¹„ë°€ë²ˆí˜¸ ìƒì„±, ë©”ì¼ ì „ì†¡ ë¡œì§ì´ë‹¤.
```java
@Component
public class PasswordManager {
    
    /**
     * ì„ì‹œ ë¹„ë°€ë²ˆí˜¸ ìƒì„± ë©”ì†Œë“œ
     * ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸° ê¸°ëŠ¥ì—ì„œ ì‚¬ìš©
     * @return 8ìë¦¬ ì„ì‹œ ë¹„ë°€ë²ˆí˜¸ (ì˜ë¬¸, ìˆ«ì, íŠ¹ìˆ˜ë¬¸ì í¬í•¨)
     */
    public String generateNewPassword() throws Exception {
        // ì„ì‹œ ë¹„ë°€ë²ˆí˜¸ ìƒì„±(8ìë¦¬: ì˜ë¬¸, ìˆ«ì, íŠ¹ìˆ˜ë¬¸ì í¬í•¨)
        String chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";
        String nums = "0123456789";
        SecureRandom  rnd = new SecureRandom();
        String newPassword = null;

        while (true) {
            StringBuilder sb = new StringBuilder();
            // ì˜ë¬¸ì 1ê°œ ë¬´ì¡°ê±´ í¬í•¨
            sb.append(chars.charAt(rnd.nextInt(chars.length())));
            // ìˆ«ì 1ê°œ ë¬´ì¡°ê±´ í¬í•¨
            sb.append(nums.charAt(rnd.nextInt(nums.length())));

            // ë‚˜ë¨¸ì§€ 6ìë¦¬ëŠ” ì˜ë¬¸/ìˆ«ì ì„ì–´ì„œ ëœë¤ ìƒì„±
            String all = chars + nums;
            for (int i = 0; i < 6; i++) {
                sb.append(all.charAt(rnd.nextInt(all.length())));
            }

            // ì„ê¸° (ì˜ë¬¸, ìˆ«ìê°€ 1ë²ˆì§¸, 2ë²ˆì§¸ì— ëª°ë¦¬ì§€ ì•Šê²Œ)
            List<Character> pwChars = new ArrayList<>();

            for (char c : sb.toString().toCharArray()) pwChars.add(c);

            Collections.shuffle(pwChars);

            StringBuilder resultPw = new StringBuilder();

            for (char c : pwChars) resultPw.append(c);

            newPassword = resultPw.toString();

            // ì •ê·œì‹ ì¡°ê±´ ì²´í¬
            if (newPassword.matches("^(?=.*[A-Za-z])(?=.*\\d)[A-Za-z\\d]{8}$")) {
                break;
            }
            // ì¡°ê±´ ë¶ˆë§Œì¡± ì‹œ whileë¡œ ë‹¤ì‹œ ìƒì„±
        }
        return newPassword;
    }
}
```
- ì•„ë˜ëŠ” ì´ë©”ì¼ ë©”ë‹ˆì €ì´ë‹¤.
- @Componentë¥¼ ì•ˆë¶™ì´ë©´ ì¼ì¼íˆ new ë¡œ ê°ì²´ë¥¼ ìƒì„±í•´ì•¼ í•˜ë¯€ë¡œ @Componentë¥¼ ë¶™ì—¬ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ê´€ë¦¬í•´ì£¼ëŠ” ê²ƒì´ ì¢‹ë‹¤.
```java
@Component
@RequiredArgsConstructor
public class EmailManager {

    @Value("${mailhelper.sender.email}")
    private String senderEmail; // ë°œì‹ ì ì´ë©”ì¼

    @Value("${mailhelper.sender.name}")
    private String senderName; // ë°œì‹ ì ì´ë¦„

    private final JavaMailSender javaMailSender;

    /**
     * ìƒˆë¡œìš´ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì´ë©”ì¼ë¡œ ì „ì†¡í•˜ëŠ” ë©”ì„œë“œ
     * @param user User ê°ì²´, ë¹„ë°€ë²ˆí˜¸ë¥¼ ì¬ì„¤ì •í•  ì‚¬ìš©ì ì •ë³´ í¬í•¨
     * @param newPassword ìƒˆë¡œ ìƒì„±ëœ ë¹„ë°€ë²ˆí˜¸
     * @throws Exception ì´ë©”ì¼ ì „ì†¡ ì¤‘ ë°œìƒí•  ìˆ˜ ìˆëŠ” ì˜ˆì™¸
     */
    public void newPasswordEmailSend(User user, String newPassword) throws Exception {

        // ë©”ì¼ í…œí”Œë¦¿ íŒŒì¼ ì§ì ‘ ì½ê¸°
        ClassPathResource resource = new ClassPathResource("mail_templates/reset_pw.html"); // mail_templates ë””ë ‰í† ë¦¬ì—ì„œ í…œí”Œë¦¿ íŒŒì¼ì„ ì½ì–´ì˜´        
        byte[] bytes = Files.readAllBytes(resource.getFile().toPath()); // íŒŒì¼ì„ ë°”ì´íŠ¸ ë°°ì—´ë¡œ ì½ìŒ
        String template = new String(bytes, "UTF-8");

        // í…œí”Œë¦¿ ì¹˜í™˜
        template = template.replace("{{userEmail}}", user.getUserEmail());
        template = template.replace("{{password}}", newPassword);

        // ë©”ì¼ ë°œì†¡
        String subject = "[í´ë¡ ë³´ìŠ¤]" + user.getUserEmail() + "ë‹˜ì˜ ë¹„ë°€ë²ˆí˜¸ê°€ ì¬ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤.";
        
        MimeMessage message = javaMailSender.createMimeMessage();
        MimeMessageHelper helper = new MimeMessageHelper(message, false, "UTF-8");
        helper.setSubject(subject); // ë©”ì¼ ì œëª© ì„¤ì •
        helper.setText(template, true); // ë©”ì¼ ë‚´ìš© ì„¤ì •

        helper.setTo(user.getUserEmail()); // ì‚¬ìš©ìì˜ ì´ë©”ì¼ ì£¼ì†Œë¡œ ë°œì†¡
        helper.setFrom(new InternetAddress(senderEmail, senderName, "UTF-8"));  // ë¯¸ë¦¬ ì„¤ì •í•´ë‘” ì´ë©”ì¼ê³¼ ì´ë¦„ ì„¸íŒ…
        javaMailSender.send(message); // ë©”ì¼ ë°œì†¡
    }
}
```

### ğŸ“Œ 0-4. ê¸°ì¡´ ì—…ë°ì´íŠ¸ ë¡œì§ ë¶„ë¦¬
- EditControllerì—ì„œ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ë˜ ë¡œì§ì´ ì¡°ê¸ˆ ë³µì¡í•´ì„œ ê¸°ì¡´ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ì„œë¹„ìŠ¤ë¡œ ë¡œì§ì„ ì˜®ê²¨ ë¶„ë¦¬í•˜ì˜€ë‹¤.
```java
@PostMapping("/api/profile/update")
    public ResponseEntity<ResponseDTO> updateProfile(
            HttpSession session, 
            @SessionAttribute("memberInfo") User member,
            @RequestParam(value = "profileImg", required = false) MultipartFile profileImg,
            @RequestParam(value = "deleteProfileImg", required = false) Boolean deleteProfileImg,
            @RequestParam(value = "profileImgChange", required = false) Boolean profileImgChange,
            @RequestParam Map<String, String> editedMap // ëª¨ë“  ìˆ˜ì •ëœ input/select/checkbox ê°’ì´ ëª¨ì—¬ìˆìŒ.
    ) throws Exception {

        // í•„ìˆ˜ í•­ëª© ìœ íš¨ì„± ê²€ì‚¬
        String name = editedMap.get("name");
        String phone = editedMap.get("phone");
        String gender = editedMap.get("gender");
        String birthYear = editedMap.get("birthYear");
        String birthMonth = editedMap.get("birthMonth");
        String birthDay = editedMap.get("birthDay");

        if (name == null || name.trim().isEmpty()
                || phone == null || phone.trim().isEmpty()
                || gender == null || gender.trim().isEmpty()
                || birthYear == null || birthYear.trim().isEmpty()
                || birthMonth == null || birthMonth.trim().isEmpty()
                || birthDay == null || birthDay.trim().isEmpty()) {
            throw new InvalidFormatException("í•„ìˆ˜ ì…ë ¥ í•­ëª©ì´ ëˆ„ë½ë˜ì—ˆìŠµë‹ˆë‹¤.");
        }

        // ì´ë¦„ í˜•ì‹ ê²€ì‚¬ (í•œê¸€ 2ê¸€ì ì´ìƒ)
        if (!name.matches("^[ê°€-í£]{2,}$")) {
            throw new InvalidFormatException("ì´ë¦„ì€ í•œê¸€ 2ê¸€ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.");
        }

        // 010-xxxx-xxxx ë˜ëŠ” 010xxxxxxxx ëª¨ë‘ í—ˆìš©
        String phonePattern1 = "^01(?:0|1|[6-9])(?:\\d{3}|\\d{4})\\d{4}$";
        String phonePattern2 = "^01(?:0|1|[6-9])[-]?(?:\\d{3}|\\d{4})[-]?\\d{4}$";
        if (!phone.matches(phonePattern1) && !phone.matches(phonePattern2)) {
            throw new InvalidFormatException("ì—°ë½ì²˜ í˜•ì‹ì´ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤. 010-xxxx-xxxx ë˜ëŠ” 010xxxxxxxx í˜•ì‹ì´ì–´ì•¼ í•©ë‹ˆë‹¤.");
        }

        // date í˜•ì‹ ê²€ì‚¬ (YYYY-MM-DD)
        int year = Integer.parseInt(birthYear);
        int month = Integer.parseInt(birthMonth);
        int day = Integer.parseInt(birthDay);

        if (month < 1 || month > 12 || day < 1 || day > 31) {
            throw new InvalidFormatException("ìƒë…„ì›”ì¼ í˜•ì‹ì´ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤.");
        }

        LocalDate birthDate = LocalDate.of(year, month, day);
        LocalDate today = LocalDate.now();

        if (birthDate.isAfter(today)) {
            throw new InvalidFormatException("ìƒë…„ì›”ì¼ì€ ë¯¸ë˜ ë‚ ì§œë¥¼ ì…ë ¥í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
        }

        // ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì‹œ ì¼ì¹˜ ì—¬ë¶€ í™•ì¸
        String newPassword = editedMap.get("newPassword");
        String confirmPassword = editedMap.get("confirmPassword");

        if ((newPassword != null && !newPassword.isEmpty()) || (confirmPassword != null && !confirmPassword.isEmpty())) { // ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ì´ ìš”ì²­ëœ ê²½ìš° - ë‘˜ ì¤‘ í•˜ë‚˜ë¼ë„ ì…ë ¥ë˜ì–´ ìˆìœ¼ë©´ ìš”ì²­í•œ ê²ƒìœ¼ë¡œ ë³¸ë‹¤.
            if (newPassword == null || newPassword.isEmpty() || confirmPassword == null || confirmPassword.isEmpty()) { // ë‘˜ ì¤‘ í•˜ë‚˜ ë¹¼ë¨¹ì€ ê²½ìš°
                throw new InvalidFormatException("ë¹„ë°€ë²ˆí˜¸ì™€ ë¹„ë°€ë²ˆí˜¸ í™•ì¸ì„ ëª¨ë‘ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤.");
            }
            if (!newPassword.equals(confirmPassword)) { // ë‘ ê°’ì´ ë‹¤ë¥¸ ê²½ìš°
                throw new InvalidFormatException("ë¹„ë°€ë²ˆí˜¸ì™€ ë¹„ë°€ë²ˆí˜¸ í™•ì¸ì´ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
            }

            if (!newPassword.matches("^(?=.*[A-Za-z])(?=.*\\d)[A-Za-z\\d]{8,20}$")) {
                throw new InvalidFormatException("ë¹„ë°€ë²ˆí˜¸ëŠ” ì˜ë¬¸ìì™€ ìˆ«ìë¥¼ í¬í•¨í•˜ì—¬ 8ì ì´ìƒ 20ì ì´í•˜ë¡œ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤.");
            }
        }

        // ê¸°ì¡´ íšŒì› ì •ë³´ ì¡°íšŒ
        User userProfile = editService.getUserProfile(member);

        // í”„ë¡œí•„ ì´ë¯¸ì§€ ì²˜ë¦¬ (ì—…ë¡œë“œ > ì‚­ì œ > ë³€ê²½ ì—†ìŒ ìˆœ)
        if (profileImg != null && !profileImg.isEmpty()) { // í”„ë¡œí•„ ì´ë¯¸ì§€ê°€ ì—…ë¡œë“œë˜ì–´ìˆë‹¤ë©´

            String originalFileName = profileImg.getOriginalFilename();
                
            if (originalFileName != null) {
                String lower = originalFileName.toLowerCase();
                if (!(lower.endsWith(".jpg") || lower.endsWith(".jpeg") || lower.endsWith(".png"))) {
                    throw new InvalidFormatException("í”„ë¡œí•„ ì´ë¯¸ì§€ëŠ” ì´ë¯¸ì§€ íŒŒì¼(jpg, jpeg, png)ë§Œ ì—…ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
                }
            }

                // MIME íƒ€ì… ê²€ì‚¬
                String contentType = profileImg.getContentType();
                if (contentType == null ||
                    !(contentType.equalsIgnoreCase("image/jpeg") ||
                    contentType.equalsIgnoreCase("image/png"))) {
                    throw new InvalidFormatException("í”„ë¡œí•„ ì´ë¯¸ì§€ëŠ” ì´ë¯¸ì§€ íŒŒì¼(jpg, jpeg, png)ë§Œ ì—…ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
                }
            
                // ì´ë¯¸ì§€ íŒŒì¼ì¸ì§€ í™•ì¸
                BufferedImage img = ImageIO.read(profileImg.getInputStream());

                if (img == null) {
                    throw new InvalidFormatException("í”„ë¡œí•„ ì´ë¯¸ì§€ê°€ ì˜¬ë°”ë¥¸ ì´ë¯¸ì§€ íŒŒì¼ì´ ì•„ë‹™ë‹ˆë‹¤.");
                }
    
                // ê¸°ì¡´ ì´ë¯¸ì§€ ì‚­ì œ (ìˆìœ¼ë©´)
                String originalImgUrl = userProfile.getUserProfileImg();

                if (originalImgUrl != null && !originalImgUrl.isEmpty()) {

                    String relativePath = originalImgUrl.replace("/files", "");
                    String realFilePath = uploadDir + relativePath;
                    File file = new File(realFilePath); // ê¸°ì¡´ ì´ë¯¸ì§€ê¹Œì§€ì˜ ê²½ë¡œ ëš«ì–´ë‘ 

                    if (file.exists()) 
                        file.delete();
                }

                // ìƒˆ íŒŒì¼ ì €ì¥ + DB ì—…ë°ì´íŠ¸
                editService.saveProfileImage(member, profileImg); // ìƒˆ ì´ë¯¸ì§€ ì €ì¥ ë° DB update


            } else if (Boolean.TRUE.equals(deleteProfileImg)) { // deleteProfileImgì´ trueë¼ë©´ <- ë¬¸ìì—´ë¡œ ì˜¤ì§€ë§Œ ìœ„ì—ì„œ bolleanìœ¼ë¡œ ìë™ë³€í™˜ë¨.
                // ê¸°ì¡´ ì´ë¯¸ì§€ ì‚­ì œ (ìˆìœ¼ë©´)
                String originalImgUrl = userProfile.getUserProfileImg();

                if (originalImgUrl != null && !originalImgUrl.isEmpty()) {

                    String relativePath = originalImgUrl.replace("/files", "");
                    String realFilePath = uploadDir + relativePath;
                    File file = new File(realFilePath);

                    if (file.exists()) 
                        file.delete();
                }

                // DBì—ì„œ URL null ì²˜ë¦¬ = ì‚­ì œì²˜ë¦¬
                editService.deleteProfileImage(member);
            }
            // else profileImgChange === falseë©´ ì•„ë¬´ ë³€í™” ì—†ìŒ

        // ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì²˜ë¦¬
        if (newPassword != null && !newPassword.isEmpty()) {
            editService.changeUserPassword(member, newPassword);
        }

        // ë‚˜ë¨¸ì§€ í”„ë¡œí•„ ì •ë³´ ì—…ë°ì´íŠ¸
        editService.updateUserProfile(member, editedMap);

        // ì„¸ì…˜ ì •ë³´ ì—…ë°ì´íŠ¸   
        // ì„¸ì…˜ì— ì €ì¥ëœ íšŒì› ì •ë³´ëŠ” ë¡œê·¸ì¸ ì‹œì ì˜ ì •ë³´ì´ë¯€ë¡œ, ìˆ˜ì • í›„ ë‹¤ì‹œ ì¡°íšŒí•˜ì—¬ ì—…ë°ì´íŠ¸í•´ì•¼í•œë‹¤.
        User updatedUser = editService.getUserProfile(member);
        session.setAttribute("memberInfo", updatedUser);

        return ResponseEntity.ok(ResponseDTO.builder()
                .success(true)
                .message("í”„ë¡œí•„ì´ ì„±ê³µì ìœ¼ë¡œ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.")
                .timestamp(LocalDateTime.now())
                .build());
    }
```
- ì„œë¹„ìŠ¤ì—ì„œ ì˜¤ì§ ì´ë¯¸ì§€ë¥¼ ì‚­ì œí•˜ê¸° ìœ„í•œ ëª¨ë“  ë¡œì§ì„ ìˆ˜í–‰í•œë‹¤.
- ê¸°ì¡´ ì»´í“¨í„°ì— ìˆëŠ” ì´ë¯¸ì§€ë¥¼ ì‚­ì œí•˜ê³  dbì— ìˆëŠ” ì´ë¯¸ì§€ê¹Œì§€ ì‚­ì œí•˜ëŠ” ë¡œì§ì„ í•œ ê³³ì— ëª¨ì•˜ë‹¤.
```java
@Override
    public void deleteProfileImage(User userInfo) throws Exception {
        // ê¸°ì¡´ ì»´í“¨í„°ì— ìˆëŠ” ì´ë¯¸ì§€ ì‚­ì œ
        String originalImgUrl = userInfo.getUserProfileImg();

        if (originalImgUrl != null && !originalImgUrl.isEmpty()) {

            String relativePath = originalImgUrl.replace("/files", "");
            String realFilePath = uploadDir + relativePath;
            File file = new File(realFilePath);

            if (file.exists()) 
                file.delete();
        }
                
        int result = 0;

        // í”„ë¡œí•„ ì´ë¯¸ì§€ ì‚­ì œë¥¼ ìœ„í•œ DB ì‘ì—… ìˆ˜í–‰
        result = userMapper.deleteProfileImage(userInfo);

        if (result == 0) {
            throw new InternalServerErrorException("í”„ë¡œí•„ ì´ë¯¸ì§€ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
        }
    }
```
- ìƒˆë¡œìš´ íŒŒì¼ì„ ì‚½ì…í•˜ëŠ” ë¡œì§ì„ ì¶”ê°€í•˜ì˜€ë‹¤.
- ê¸°ì¡´ ì»´í“¨í„°ì— ìˆëŠ” ì´ë¯¸ì§€ë¥¼ ì‚­ì œí•˜ê³  dbëŠ” ê¸°ì¡´ ì´ë¯¸ì§€ì— updateë¥¼ ì§„í–‰í•œë‹¤.
```java
public void saveProfileImage(User user, MultipartFile profileImg) throws Exception {
        // ê¸°ì¡´ ì´ë¯¸ì§€ ì‚­ì œ (ìˆìœ¼ë©´)
        String originalImgUrl = user.getUserProfileImg();

        if (originalImgUrl != null && !originalImgUrl.isEmpty()) {

            String relativePath = originalImgUrl.replace("/files", "");
            String realFilePath = uploadDir + relativePath;
            File file = new File(realFilePath); // ê¸°ì¡´ ì´ë¯¸ì§€ê¹Œì§€ì˜ ê²½ë¡œ ëš«ì–´ë‘ 

            if (file.exists()) 
                file.delete();
        }

        // íŒŒì¼ëª…/í™•ì¥ì ì¶”ì¶œ ë° ì—…ë¡œë“œ ê²½ë¡œ ìƒì„±
        String originalName = profileImg.getOriginalFilename(); // ì›ë³¸ íŒŒì¼ëª…
        if (originalName == null || originalName.isEmpty()) throw new InternalServerErrorException("íŒŒì¼ì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.");

        String ext = originalName.substring(originalName.lastIndexOf("."));
        String uniqueName = UUID.randomUUID().toString().replace("-", "") + ext;

        // ë‚ ì§œë³„ í´ë”ë¡œ êµ¬ì¡°í™”
        Calendar c = Calendar.getInstance();
        String folderPath = String.format("/%04d/%02d/%02d", c.get(Calendar.YEAR), c.get(Calendar.MONTH) + 1, c.get(Calendar.DAY_OF_MONTH));
        String saveDir = uploadDir + folderPath;

        File dir = new File(saveDir);
        if (!dir.exists()) 
            dir.mkdirs(); // ë””ë ‰í† ë¦¬ê°€ ì—†ìœ¼ë©´ ìƒì„±

        String savedFilePath = saveDir + "/" + uniqueName;
        // ì‹¤ì œ íŒŒì¼ ì €ì¥
        profileImg.transferTo(new File(savedFilePath));

        // ì›¹ì—ì„œ ì ‘ê·¼í•  url
        String fileUrl = uploadUrl + folderPath + "/" + uniqueName;

        User userInfo = new User();
        userInfo.setUserId(user.getUserId());
        userInfo.setUserProfileImg(fileUrl); // í”„ë¡œí•„ ì´ë¯¸ì§€ URL ì„¤ì •

        // DBì— í”„ë¡œí•„ ì´ë¯¸ì§€ URL ì—…ë°ì´íŠ¸
        int updated = userMapper.updateProfileImgUrl(userInfo);

        // DB ì—…ë°ì´íŠ¸ ê²°ê³¼ í™•ì¸
        if (updated == 0) {
            throw new InternalServerErrorException("DBì— í”„ë¡œí•„ ì´ë¯¸ì§€ URL ì €ì¥ ì‹¤íŒ¨");
        }
    }
```

### ğŸ“Œ 0-5. ì„œë¹„ìŠ¤ëŠ” ë§¤í¼ë§Œ ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ì„œë¹„ìŠ¤ì— ë„˜ê²¨ì¤„ íŒŒë¼ë¯¸í„° ìƒì„±ë§Œ
- ëª¨ë“  ì²˜ë¦¬ë¥¼ ì„œë¹„ìŠ¤ë¡œ ì˜®ê²¼ë‹¤ê°€ ì„œë¹„ìŠ¤ëŠ” íŒŒë¼ë¯¸í„°ë¥¼ ë“¤ê³  ë§¤í¼ë“¤ì„ ì´ìš©í•´ ì¡°ë¦½í•˜ëŠ” ì—­í• ì„ í•˜ê³  ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ê·¸ íŒŒë¼ë¯¸í„°ë“¤ì„ ê³„ì‚°í•´ì„œ ë„˜ê²¨ì¤˜ì•¼í•œë‹¤ëŠ” ì„¤ëª…ì„ ë“£ê³  ê·¸ëŒ€ë¡œ ë¦¬íŒ©í† ë§í•˜ì˜€ë‹¤. 
- ê·¸ ê³¼ì •ì—ì„œ ìµœëŒ€í•œ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ê°„ì†Œí™”í•˜ê¸° ìœ„í•´ ì •ë³´ ìˆ˜ì • ë¡œì§ì„ ìˆ˜ì •í•˜ê³  ìœ íš¨ì„± ê²€ì‚¬ë“¤ì„ ëª¨ë‘ ì •ë¦¬í•´ì„œ ìœ íš¨ì„± ê²€ì‚¬ ë§¤ë‹ˆì €ë¥¼ ì½”ë”©í•˜ì˜€ë‹¤. -> ê¸°ì¡´ì— ìˆë˜ ê±¸ ì •ë¦¬í•˜ëŠ” ê²ƒì€ ì½”íŒŒì¼ëŸ¿ìœ¼ë¡œ í•˜ë©´ ëœë‹¤.
- ì•„ë˜ëŠ” ë°”ë€ ì •ë³´ìˆ˜ì • í´ë˜ìŠ¤ì´ê³  validationManagerì˜ validateUser ë©”ì„œë“œë¥¼ í†µí•´ ë°›ì€ ê°’ì„ ëª¨ë‘ ê²€ì¦í•˜ì—¬ ê²€ì¦ëœ ê°’ë“¤ë§Œ updatedUserì— ë‹´ì•„ ë°˜í™˜í•œë‹¤.
- ì´ë•Œ ê²€ì¦ëœ ê°’ë“¤ ì¤‘ nullì¸ ê°’ë“¤ì´ ìˆëŠ”ë° ê·¸ê±´ ê·¸ëƒ¥ nullë¡œ ì—…ë°ì´íŠ¸ í•˜ë©´ ë˜ëŠ”ê±°ë¼ ê·¸ëƒ¥ ì´ëŒ€ë¡œ ìœ ì§€í•˜ì˜€ë‹¤. 
- ì´ë ‡ê²Œ ë¡œì§ì„ ì§„í–‰í•˜ë©´ ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ë§¤ìš° ê°„ë‹¨í•´ì§€ëŠ”ë° ì•„ë˜ëŠ” ë°”ë€ ì •ë³´ìˆ˜ì • ì»¨íŠ¸ë¡¤ëŸ¬ì´ë‹¤. ëª¨ë“  ë¡œì§ì„ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ìˆ˜í–‰í•˜ë©´ì„œ ì»¨íŠ¸ë¡¤ëŸ¬ì— ì ë¦¬ëŠ” ì½”ë“œì˜ ì–‘ì„ managerë¥¼ í†µí•´ ì¤„ì˜€ë‹¤.
- ë˜í•œ ê¸°ì¡´ì— ì•ˆì“°ë˜ ProfileImgChange íƒœê·¸ë¥¼ ì‚­ì œí•˜ì—¬ ì½”ë“œë¥¼ ì¢€ ë” ê¹”ë”í•˜ê²Œ ê³ ì³¤ë‹¤.
- ê²€ì¦ëœ ê°’ë“¤ì„ ê°ì²´ë¡œ ë°›ì•„ ê·¸ëŒ€ë¡œ ì—…ë°ì´íŠ¸ ì„œë¹„ìŠ¤ë¡œ ë„˜ê¸°ë©´ ì„œë¹„ìŠ¤ê°€ ì•Œì•„ì„œ ë§¤í¼ë¥¼ í˜¸ì¶œí•˜ì—¬ ìˆ˜ì •ì„ êµ¬í˜„í•œë‹¤.
```java
@PostMapping("/api/profile/update")
    public ResponseEntity<ResponseDTO> updateProfile(
            HttpSession session, 
            @SessionAttribute("memberInfo") User member,
            @RequestParam(value = "profileImg", required = false) MultipartFile profileImg,
            @RequestParam(value = "deleteProfileImg", required = false) Boolean deleteProfileImg,
            @RequestParam Map<String, String> editedMap
    ) throws Exception {

        User userProfile = editService.getUserProfile(member);

        // ValidationManagerë¥¼ ì‚¬ìš©í•˜ì—¬ ìœ íš¨ì„± ê²€ì‚¬ ë° User ê°ì²´ ìƒì„±
        User updatedUser = validationManager.validateUser(editedMap, profileImg, userProfile.getUserId());

        // í”„ë¡œí•„ ì´ë¯¸ì§€ ì²˜ë¦¬
        if (profileImg != null && !profileImg.isEmpty()) {
            // ì´ë¯¸ì§€ ìœ íš¨ì„± ê²€ì‚¬ëŠ” ValidationManagerì—ì„œ ì™„ë£Œí–ˆìœ¼ë¯€ë¡œ ë” ì§„í–‰í•˜ì§€ ì•Šì•„ë„ ëœë‹¤.
            BufferedImage img = ImageIO.read(profileImg.getInputStream());

            // ê¸°ì¡´ ì´ë¯¸ì§€ ì‚­ì œ í›„ ìƒˆ ì´ë¯¸ì§€ ì €ì¥
            fileUploadManager.deleteProfileImageFromDisk(userProfile);
            String fileUrl = fileUploadManager.storeProfileImageAndReturnUrl(profileImg);
            updatedUser.setUserProfileImg(fileUrl);

        } else if (Boolean.TRUE.equals(deleteProfileImg)) {
            // í”„ë¡œí•„ ì´ë¯¸ì§€ ì‚­ì œ
            fileUploadManager.deleteProfileImageFromDisk(userProfile);
            updatedUser.setUserProfileImg(null);
        }

        // í•œ ë²ˆì— ëª¨ë“  ì •ë³´ ì—…ë°ì´íŠ¸
        editService.updateUserProfile(updatedUser);

        // ì„¸ì…˜ ì •ë³´ ì—…ë°ì´íŠ¸
        session.setAttribute("memberInfo", editService.getUserProfile(userProfile));

        return ResponseEntity.ok(ResponseDTO.builder()
                .success(true)
                .message("í”„ë¡œí•„ì´ ì„±ê³µì ìœ¼ë¡œ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.")
                .timestamp(LocalDateTime.now())
                .build());
    }
```
- ì•„ë˜ëŠ” ìƒˆë¡œ ë§Œë“  validation managerì´ë‹¤.
- ê·¸ëƒ¥ ê¸°ì¡´ì˜ ê²€ì‚¬ ë¡œì§ì„ ê·¸ëŒ€ë¡œ ì˜®ê¸°ê³  ìœ íš¨ì„± ê²€ì‚¬ë¥¼ ìˆ˜í–‰í•˜ëŠ” ë¡œì§ë“¤ì— ëŒ€í•œ ìœ íš¨ì„± ê²€ì‚¬ ë¡œì§ì„ ë”°ë¡œ ëª¨ì€ ë©”ì„œë“œë¥¼ ë§Œë“¤ì–´ì„œ ëª¨ë“  ë¦¬íŒ©í† ë§ì´ ì´ íŒŒì¼ì•ˆì—ì„œ ì¼ì–´ë‚  ìˆ˜ ìˆë„ë¡ í•˜ì˜€ë‹¤.
```java
@Component
public class ValidationManager {
    
    // ------------------------------------ ê°œë³„ ìœ íš¨ì„± ê²€ì‚¬ ë©”ì„œë“œë“¤ ------------------------------------------------
    
    /**
     * ì´ë©”ì¼ ìœ íš¨ì„± ê²€ì‚¬
     * @param email ê²€ì‚¬í•  ì´ë©”ì¼
     * @return ê²€ì¦ëœ ì´ë©”ì¼
     * @throws InvalidFormatException ìœ íš¨ì„± ê²€ì‚¬ ì‹¤íŒ¨ ì‹œ
     */
    public String validateEmail(String email) throws InvalidFormatException {
        if (email == null || email.trim().isEmpty()) {
            throw new InvalidFormatException("ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”.");
        }
        if (!email.matches("^[\\w.-]+@[\\w.-]+\\.[a-zA-Z]{2,}$")) {
            throw new InvalidFormatException("ì´ë©”ì¼ í˜•ì‹ì´ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤.");
        }
        return email.trim();
    }
    
    /**
     * ë¹„ë°€ë²ˆí˜¸ ìœ íš¨ì„± ê²€ì‚¬ (í•„ìˆ˜)
     * @param password ê²€ì‚¬í•  ë¹„ë°€ë²ˆí˜¸
     * @return ê²€ì¦ëœ ë¹„ë°€ë²ˆí˜¸
     * @throws InvalidFormatException ìœ íš¨ì„± ê²€ì‚¬ ì‹¤íŒ¨ ì‹œ
     */
    public String validatePassword(String password) throws InvalidFormatException {
        if (password == null || password.trim().isEmpty()) {
            throw new InvalidFormatException("ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.");
        }
        if (password.length() < 8 || password.length() > 20 || !password.matches("^(?=.*[A-Za-z])(?=.*\\d)[A-Za-z\\d]{8,20}$")) {
            throw new InvalidFormatException("ë¹„ë°€ë²ˆí˜¸ëŠ” 8ì ì´ìƒ 20ì ì´í•˜ì˜ ì˜ë¬¸+ìˆ«ì ì¡°í•©ì´ì–´ì•¼ í•©ë‹ˆë‹¤.");
        }
        return password;
    }
    
    /**
     * ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ìœ íš¨ì„± ê²€ì‚¬ (ì„ íƒ, ê°’ì´ ìˆì„ ë•Œë§Œ)
     * @param newPassword ìƒˆ ë¹„ë°€ë²ˆí˜¸
     * @param confirmPassword ë¹„ë°€ë²ˆí˜¸ í™•ì¸
     * @return ê²€ì¦ëœ ë¹„ë°€ë²ˆí˜¸ (null ê°€ëŠ¥)
     * @throws InvalidFormatException ìœ íš¨ì„± ê²€ì‚¬ ì‹¤íŒ¨ ì‹œ
     */
    public String validatePasswordChange(String newPassword, String confirmPassword) throws InvalidFormatException {
        if ((newPassword != null && !newPassword.trim().isEmpty()) || (confirmPassword != null && !confirmPassword.trim().isEmpty())) {
            if (newPassword == null || newPassword.trim().isEmpty() || confirmPassword == null || confirmPassword.trim().isEmpty()) {
                throw new InvalidFormatException("ë¹„ë°€ë²ˆí˜¸ì™€ ë¹„ë°€ë²ˆí˜¸ í™•ì¸ì„ ëª¨ë‘ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤.");
            }
            if (!newPassword.equals(confirmPassword)) {
                throw new InvalidFormatException("ë¹„ë°€ë²ˆí˜¸ì™€ ë¹„ë°€ë²ˆí˜¸ í™•ì¸ì´ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
            }
            if (!newPassword.matches("^(?=.*[A-Za-z])(?=.*\\d)[A-Za-z\\d]{8,20}$")) {
                throw new InvalidFormatException("ë¹„ë°€ë²ˆí˜¸ëŠ” ì˜ë¬¸ìì™€ ìˆ«ìë¥¼ í¬í•¨í•˜ì—¬ 8ì ì´ìƒ 20ì ì´í•˜ë¡œ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤.");
            }
            return newPassword;
        }
        return null;
    }
    
    /**
     * ì´ë¦„ ìœ íš¨ì„± ê²€ì‚¬
     * @param name ê²€ì‚¬í•  ì´ë¦„
     * @return ê²€ì¦ëœ ì´ë¦„
     * @throws InvalidFormatException ìœ íš¨ì„± ê²€ì‚¬ ì‹¤íŒ¨ ì‹œ
     */
    public String validateName(String name) throws InvalidFormatException {
        if (name == null || name.trim().isEmpty()) {
            throw new InvalidFormatException("ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”.");
        }
        if (!name.matches("^[ê°€-í£]{2,}$")) {
            throw new InvalidFormatException("ì´ë¦„ì€ í•œê¸€ë¡œ 2ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.");
        }
        return name.trim();
    }
    
    /**
     * ì„±ë³„ ìœ íš¨ì„± ê²€ì‚¬
     * @param gender ê²€ì‚¬í•  ì„±ë³„
     * @return ê²€ì¦ëœ ì„±ë³„
     * @throws InvalidFormatException ìœ íš¨ì„± ê²€ì‚¬ ì‹¤íŒ¨ ì‹œ
     */
    public String validateGender(String gender) throws InvalidFormatException {
        if (gender == null || gender.trim().isEmpty()) {
            throw new InvalidFormatException("ì„±ë³„ì„ ì„ íƒí•˜ì„¸ìš”.");
        }
        return gender.trim();
    }
    
    /**
     * ì—°ë½ì²˜ ìœ íš¨ì„± ê²€ì‚¬
     * @param phone ê²€ì‚¬í•  ì—°ë½ì²˜
     * @return ê²€ì¦ëœ ì—°ë½ì²˜
     * @throws InvalidFormatException ìœ íš¨ì„± ê²€ì‚¬ ì‹¤íŒ¨ ì‹œ
     */
    public String validatePhone(String phone) throws InvalidFormatException {
        if (phone == null || phone.trim().isEmpty()) {
            throw new InvalidFormatException("ì—°ë½ì²˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”.");
        }
        if (!phone.matches("^01(?:0|1|[6-9])(?:\\d{3}|\\d{4})\\d{4}$") && 
            !phone.matches("^01(?:0|1|[6-9])[-]?(?:\\d{3}|\\d{4})[-]?\\d{4}$")) {
            throw new InvalidFormatException("ì—°ë½ì²˜ í˜•ì‹ì´ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤. 010-xxxx-xxxx ë˜ëŠ” 010xxxxxxxx í˜•ì‹ì´ì–´ì•¼ í•©ë‹ˆë‹¤.");
        }
        return phone.trim();
    }
    
    /**
     * ìƒë…„ì›”ì¼ ìœ íš¨ì„± ê²€ì‚¬
     * @param birthYear ìƒë…„
     * @param birthMonth ìƒì›”
     * @param birthDay ìƒì¼
     * @return ê²€ì¦ëœ ìƒë…„ì›”ì¼ (yyyy-MM-dd í˜•ì‹)
     * @throws InvalidFormatException ìœ íš¨ì„± ê²€ì‚¬ ì‹¤íŒ¨ ì‹œ
     */
    public String validateBirthdate(String birthYear, String birthMonth, String birthDay) throws InvalidFormatException {
        if (birthYear == null || birthYear.trim().isEmpty() || 
            birthMonth == null || birthMonth.trim().isEmpty() || 
            birthDay == null || birthDay.trim().isEmpty()) {
            throw new InvalidFormatException("ìƒë…„ì›”ì¼ì„ ëª¨ë‘ ì…ë ¥í•˜ì„¸ìš”.");
        }

        try {
            int year = Integer.parseInt(birthYear.trim());
            int month = Integer.parseInt(birthMonth.trim());
            int day = Integer.parseInt(birthDay.trim());

            if (month < 1 || month > 12 || day < 1 || day > 31) {
                throw new InvalidFormatException("ìƒë…„ì›”ì¼ í˜•ì‹ì´ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤.");
            }

            LocalDate birthDate = LocalDate.of(year, month, day);
            if (birthDate.isAfter(LocalDate.now())) {
                throw new InvalidFormatException("ìƒë…„ì›”ì¼ì€ ë¯¸ë˜ ë‚ ì§œë¥¼ ì…ë ¥í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
            }
            return String.format("%s-%s-%s", birthYear.trim(), birthMonth.trim(), birthDay.trim());
        } catch (NumberFormatException e) {
            throw new InvalidFormatException("ìƒë…„ì›”ì¼ì€ ìˆ«ìë¡œ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤.");
        }
    }
    
    /**
     * ìš°í¸ë²ˆí˜¸ ìœ íš¨ì„± ê²€ì‚¬ (ì„ íƒ)
     * @param postcode ê²€ì‚¬í•  ìš°í¸ë²ˆí˜¸
     * @return ê²€ì¦ëœ ìš°í¸ë²ˆí˜¸ (null ê°€ëŠ¥)
     * @throws InvalidFormatException ìœ íš¨ì„± ê²€ì‚¬ ì‹¤íŒ¨ ì‹œ
     */
    public String validatePostcode(String postcode) throws InvalidFormatException {
        if (postcode != null && !postcode.trim().isEmpty()) {
            if (!postcode.matches("^\\d{4,5}$")) {
                throw new InvalidFormatException("ìš°í¸ë²ˆí˜¸ëŠ” 4-5ìë¦¬ ìˆ«ìì—¬ì•¼ í•©ë‹ˆë‹¤.");
            }
            return postcode.trim();
        }
        return null;
    }
    
    /**
     * ì£¼ì†Œ ìœ íš¨ì„± ê²€ì‚¬ (ì„ íƒ)
     * @param address ê²€ì‚¬í•  ì£¼ì†Œ
     * @return ê²€ì¦ëœ ì£¼ì†Œ (null ê°€ëŠ¥)
     */
    public String validateAddress(String address) {
        if (address != null && !address.trim().isEmpty()) {
            return address.trim();
        }
        return null;
    }
    
    /**
     * ìƒì„¸ì£¼ì†Œ ìœ íš¨ì„± ê²€ì‚¬ (ì„ íƒ)
     * @param addressDetail ê²€ì‚¬í•  ìƒì„¸ì£¼ì†Œ
     * @return ê²€ì¦ëœ ìƒì„¸ì£¼ì†Œ (null ê°€ëŠ¥)
     */
    public String validateAddressDetail(String addressDetail) {
        if (addressDetail != null && !addressDetail.trim().isEmpty()) {
            return addressDetail.trim();
        }
        return null;
    }
    
    /**
     * í”„ë¡œí•„ ì´ë¯¸ì§€ ìœ íš¨ì„± ê²€ì‚¬ (ì„ íƒ)
     * @param profileImg ê²€ì‚¬í•  í”„ë¡œí•„ ì´ë¯¸ì§€
     * @throws InvalidFormatException ìœ íš¨ì„± ê²€ì‚¬ ì‹¤íŒ¨ ì‹œ
     */
    public void validateProfileImage(MultipartFile profileImg) throws InvalidFormatException {
        if (profileImg != null && !profileImg.isEmpty()) {
            String originalFileName = profileImg.getOriginalFilename();
            if (originalFileName != null) {
                String lower = originalFileName.toLowerCase();
                if (!(lower.endsWith(".jpg") || lower.endsWith(".jpeg") || lower.endsWith(".png"))) {
                    throw new InvalidFormatException("í”„ë¡œí•„ ì´ë¯¸ì§€ëŠ” ì´ë¯¸ì§€ íŒŒì¼(jpg, jpeg, png)ë§Œ ì—…ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
                }
            }

            String contentType = profileImg.getContentType();
            if (contentType == null || !(contentType.equalsIgnoreCase("image/jpeg") || contentType.equalsIgnoreCase("image/png"))) {
                throw new InvalidFormatException("í”„ë¡œí•„ ì´ë¯¸ì§€ëŠ” ì´ë¯¸ì§€ íŒŒì¼(jpg, jpeg, png)ë§Œ ì—…ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
            }
        }
    }
    
    /**
     * ì•½ê´€ ë™ì˜ ìœ íš¨ì„± ê²€ì‚¬ ë° ë³€í™˜
     * @param agreeSms SMS ìˆ˜ì‹  ë™ì˜ ë¬¸ìì—´
     * @param agreeEmail ì´ë©”ì¼ ìˆ˜ì‹  ë™ì˜ ë¬¸ìì—´  
     * @return [smsTerm, emailTerm] ë°°ì—´
     */
    public boolean[] validateAgreements(String agreeSms, String agreeEmail) {
        boolean smsTerm = "true".equals(agreeSms) || "on".equals(agreeSms);
        boolean emailTerm = "true".equals(agreeEmail) || "on".equals(agreeEmail);
        return new boolean[]{smsTerm, emailTerm};
    }
    
    /**
     * í•„ìˆ˜ ì•½ê´€ ë™ì˜ ìœ íš¨ì„± ê²€ì‚¬ (íšŒì›ê°€ì…ìš©)
     * @param requiredTerm í•„ìˆ˜ ì•½ê´€ ë™ì˜ ë¬¸ìì—´
     * @throws InvalidFormatException í•„ìˆ˜ ì•½ê´€ ë¯¸ë™ì˜ ì‹œ
     */
    public void validateRequiredAgreement(String requiredTerm) throws InvalidFormatException {
        boolean isRequired = "true".equals(requiredTerm) || "on".equals(requiredTerm);
        if (!isRequired) {
            throw new InvalidFormatException("í•„ìˆ˜ ì•½ê´€ì— ë™ì˜í•´ì•¼ í•©ë‹ˆë‹¤.");
        }
    }
    
    // ------------------------------------- í†µí•© ìœ íš¨ì„± ê²€ì‚¬ ë©”ì„œë“œë“¤ ------------------------------------------------
    
    /**
     * í”„ë¡œí•„ ìˆ˜ì •ìš© ì‚¬ìš©ì ì •ë³´ ìœ íš¨ì„± ê²€ì‚¬
     * @param editedMap ìˆ˜ì •í•  ì •ë³´ê°€ ë‹´ê¸´ Map
     * @param profileImg í”„ë¡œí•„ ì´ë¯¸ì§€ íŒŒì¼ (ì„ íƒì‚¬í•­)
     * @param userId ìˆ˜ì •í•  ì‚¬ìš©ì ID
     * @return ê²€ì¦ëœ User ê°ì²´
     * @throws InvalidFormatException ìœ íš¨ì„± ê²€ì‚¬ ì‹¤íŒ¨ ì‹œ
     */
    public User validateUser(Map<String, String> editedMap, MultipartFile profileImg, int userId) throws InvalidFormatException {
        User updatedUser = new User();
        updatedUser.setUserId(userId);

        // í•„ìˆ˜ í•­ëª©ë“¤
        updatedUser.setUserName(validateName(editedMap.get("name")));
        updatedUser.setUserPhone(validatePhone(editedMap.get("phone")));
        updatedUser.setUserGender(validateGender(editedMap.get("gender")));
        
        String birthdate = validateBirthdate(
            editedMap.get("birthYear"), 
            editedMap.get("birthMonth"), 
            editedMap.get("birthDay")
        );
        updatedUser.setUserBirthdate(birthdate);

        // ì„ íƒ í•­ëª©ë“¤
        String postcode = validatePostcode(editedMap.get("postcode"));
        if (postcode != null) updatedUser.setUserPostcode(postcode);
        
        String address = validateAddress(editedMap.get("address"));
        if (address != null) updatedUser.setUserAddress(address);
        
        String addressDetail = validateAddressDetail(editedMap.get("addressDetail"));
        if (addressDetail != null) updatedUser.setUserSpecificAddress(addressDetail);

        // ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ê²€ì‚¬
        String newPassword = validatePasswordChange(editedMap.get("newPassword"), editedMap.get("confirmPassword"));
        if (newPassword != null) updatedUser.setUserPassword(newPassword);

        // í”„ë¡œí•„ ì´ë¯¸ì§€ ê²€ì‚¬
        validateProfileImage(profileImg);

        // ë™ì˜ í•­ëª© ì„¤ì •
        if (editedMap.containsKey("agreeSms") || editedMap.containsKey("agreeEmail")) {
            boolean[] agreements = validateAgreements(editedMap.get("agreeSms"), editedMap.get("agreeEmail"));
            if (editedMap.containsKey("agreeSms")) updatedUser.setSmsTerm(agreements[0]);
            if (editedMap.containsKey("agreeEmail")) updatedUser.setEmailTerm(agreements[1]);
        }

        return updatedUser;
    }

    /**
     * ë¡œê·¸ì¸ìš© ì´ë©”ì¼ ìœ íš¨ì„± ê²€ì‚¬ (ë³´ì•ˆì„ ìœ„í•´ êµ¬ì²´ì ì¸ ì˜¤ë¥˜ ë©”ì‹œì§€ ì œê³µí•˜ì§€ ì•ŠìŒ)
     * @param email ê²€ì‚¬í•  ì´ë©”ì¼
     * @return ê²€ì¦ëœ ì´ë©”ì¼
     * @throws InvalidFormatException ìœ íš¨ì„± ê²€ì‚¬ ì‹¤íŒ¨ ì‹œ
     */
    public String validateLoginEmail(String email) throws InvalidFormatException {
        if (email == null || email.trim().isEmpty()) {
            throw new InvalidFormatException("ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”.");
        }
        if (!email.matches("^[\\w.-]+@[\\w.-]+\\.[a-zA-Z]{2,}$")) {
            throw new InvalidFormatException("ì˜ëª»ëœ ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ì…ë‹ˆë‹¤.");
        }
        return email.trim();
    }

    /**
     * ë¡œê·¸ì¸ìš© ë¹„ë°€ë²ˆí˜¸ ìœ íš¨ì„± ê²€ì‚¬ (ë³´ì•ˆì„ ìœ„í•´ êµ¬ì²´ì ì¸ ì˜¤ë¥˜ ë©”ì‹œì§€ ì œê³µí•˜ì§€ ì•ŠìŒ)
     * @param password ê²€ì‚¬í•  ë¹„ë°€ë²ˆí˜¸
     * @return ê²€ì¦ëœ ë¹„ë°€ë²ˆí˜¸
     * @throws InvalidFormatException ìœ íš¨ì„± ê²€ì‚¬ ì‹¤íŒ¨ ì‹œ
     */
    public String validateLoginPassword(String password) throws InvalidFormatException {
        if (password == null || password.trim().isEmpty()) {
            throw new InvalidFormatException("ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.");
        }
        if (!password.matches("^(?=.*[A-Za-z])(?=.*\\d)[A-Za-z\\d]{8,20}$")) {
            throw new InvalidFormatException("ì˜ëª»ëœ ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ì…ë‹ˆë‹¤.");
        }
        return password;
    }

    /**
     * ì•„ì´ë””/ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°ìš© ì´ë©”ì¼ ìœ íš¨ì„± ê²€ì‚¬
     * @param email ê²€ì‚¬í•  ì´ë©”ì¼
     * @return ê²€ì¦ëœ ì´ë©”ì¼
     * @throws InvalidFormatException ìœ íš¨ì„± ê²€ì‚¬ ì‹¤íŒ¨ ì‹œ
     */
    public String validateFindEmail(String email) throws InvalidFormatException {
        if (email == null || email.trim().isEmpty()) {
            throw new InvalidFormatException("ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”.");
        }
        if (!email.matches("^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$")) {
            throw new InvalidFormatException("ì˜¬ë°”ë¥¸ ì´ë©”ì¼ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤.");
        }
        return email.trim();
    }

    /**
     * ì•„ì´ë”” ì°¾ê¸°ìš© íœ´ëŒ€í° ë²ˆí˜¸ ìœ íš¨ì„± ê²€ì‚¬
     * @param phone ê²€ì‚¬í•  íœ´ëŒ€í° ë²ˆí˜¸
     * @return ê²€ì¦ëœ íœ´ëŒ€í° ë²ˆí˜¸
     * @throws InvalidFormatException ìœ íš¨ì„± ê²€ì‚¬ ì‹¤íŒ¨ ì‹œ
     */
    public String validateFindPhone(String phone) throws InvalidFormatException {
        if (phone == null || phone.trim().isEmpty()) {
            throw new InvalidFormatException("íœ´ëŒ€í° ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.");
        }
        // 010-1234-5678, 01012345678 ë“± í—ˆìš©
        if (!phone.matches("^(\\d{2,3}-?\\d{3,4}-?\\d{4})$")) {
            throw new InvalidFormatException("ì˜¬ë°”ë¥¸ íœ´ëŒ€í° ë²ˆí˜¸ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤. (ì˜ˆ: 010-1234-5678 ë˜ëŠ” 01012345678)");
        }
        return phone.trim();
    }

    /**
     * ì•„ì´ë”” ì°¾ê¸°ìš© ì´ë¦„ ìœ íš¨ì„± ê²€ì‚¬
     * @param name ê²€ì‚¬í•  ì´ë¦„
     * @return ê²€ì¦ëœ ì´ë¦„
     * @throws InvalidFormatException ìœ íš¨ì„± ê²€ì‚¬ ì‹¤íŒ¨ ì‹œ
     */
    public String validateFindName(String name) throws InvalidFormatException {
        if (name == null || name.trim().isEmpty()) {
            throw new InvalidFormatException("ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”.");
        }
        return name.trim();
    }
}
```

### ğŸ“Œ 0-7. ê¸°ì¡´ì— ì´ ì£¼ë¬¸ëŸ‰ì„ userì—ì„œ ê³„ì‚°í•˜ë˜ ê²ƒì„ order mapperë¥¼ í†µí•´ ê³„ì‚°
- ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ì„œë¹„ìŠ¤ì˜ ì—­í• ì´ë¼ê³  ìƒê°í–ˆë˜ ë¡œì§ì„ ë‹¤ ê°€ì ¸ê°€ë‹ˆê¹Œ ì„œë¹„ìŠ¤ì˜ ì¼ì´ ë‹¨ì¼ ë§¤í¼í˜¸ì¶œì´ ë˜ì–´ë²„ë ¸ë‹¤. ê·¸ëŸ¬ë‹¤ë³´ë‹ˆ ì„œë¹„ìŠ¤ê°€ ë‹¨ì¼ ë§¤í¼ë¥¼ í˜¸ì¶œí•  ë°”ì—” ë§¤í¼ì˜ sqlì„ ì¤„ì´ê³  ë‹¤ì–‘í•œ mapperë“¤ì„ ê¸ì–´ì™€ì„œ ì‚¬ìš©í•˜ëŠ”ê²Œ ì„œë¹„ìŠ¤ì˜ ì†Œì–‘ì„ ë‹¤í•œë‹¤ëŠ” ëŠë‚Œì´ ë“¤ì—ˆë‹¤.
- ê·¸ë˜ì„œ ê¸°ì¡´ ë§¤í¼ë¥¼ ë‹¨ìˆœí™”í•˜ê³  ë‹¤ì–‘í•œ ê³³ì˜ mapperë“¤ì„ ëŒì–´ì™€ì„œ ì„œë¹„ìŠ¤ì—ì„œ ì‚¬ìš©í•˜ë„ë¡ í•˜ì—¬ sqlë¬¸ì„ ë‹¨ìˆœí™”í•˜ëŠ” ì‘ì—…ì„ ì§„í–‰í•˜ì˜€ë‹¤.
- ì•„ë˜ëŠ” ê¸°ì¡´ì— orders í…Œì´ë¸”ì„ ì¡°ì¸í•˜ì—¬ ì²˜ë¦¬í•˜ë˜ ê²ƒì´ë©° ê²°êµ­ì—” ì´ë¥¼ ë¶„ë¦¬í•˜ì—¬ ìš°ì„  userë§Œ ì „ì²´ë¥¼ ê°€ì ¸ì˜¤ê³  order totalì€ ë”°ë¡œ ê°€ì ¸ì˜¤ë„ë¡ ì •ë¦¬í•˜ì˜€ë‹¤.
```java
/**
     * ìœ ì €ì˜ ì •ë³´ì™€ ìœ ì €ì˜ ì£¼ë¬¸ ì •ë³´ë¥¼ ì¡°ì¸í•˜ì—¬ ì¡°íšŒ
     * ìœ ì €ê°€ ì£¼ë¬¸í•œ ì´ ê¸ˆì•¡ì´ ì—†ì–´ë„ left joinì„ ì‚¬ìš©í•˜ì—¬ ìœ ì € ì •ë³´ë¥¼ ê°€ì ¸ì™€ì„œ ì£¼ë¬¸ ì •ë³´ë¥¼ 0ìœ¼ë¡œ ë„ì›Œì¤Œ
     * @param input ì„¸ì…˜ì—ì„œ ê°€ì ¸ì˜¨ User ì•„ì´ë””ê°€ í¬í•¨ëœ User ê°ì²´
     * @return User ê°ì²´ (ìœ ì € ì •ë³´ì™€ ëˆ„ì  êµ¬ë§¤ ê¸ˆì•¡ í¬í•¨)          
     * @throws Exception
     */
    @Select(
        "SELECT " +
        "u.user_id, u.user_email, u.user_password, u.user_name, u.user_gender, u.user_phone, " +
        "u.user_birthdate, u.user_postcode, u.user_address, u.user_specific_address, u.user_profile_img, " +
        "u.required_term, u.sms_term, u.email_term, u.is_out, u.reg_date, u.edit_date, " +
        "IFNULL(SUM(o.order_price), 0) AS order_total_price " +
        "FROM users u " +
        "LEFT JOIN orders o ON u.user_id = o.user_id " +
        "WHERE u.user_id = #{userId} " +
        "GROUP BY u.user_id"
    )
    @ResultMap("UserMap")
    User selectUserWithOrderTotalPrice(User input) throws Exception;
```
- ì•„ë˜ì²˜ëŸ¼ ì£¼ë¬¸ì´ì•¡ì„ ë”°ë¡œ ì¡°íšŒí•´ì„œ userê°ì²´ì— ì¶”ê°€í•˜ëŠ” ì‹ìœ¼ë¡œ í•˜ì—¬ êµ¬ì„±í•˜ì˜€ë‹¤.
```java
Override
    public User getUserInfo(User user) throws Exception {
        // ì„¸ì…˜ì—ì„œ ê°€ì ¸ì˜¨ User ì•„ì´ë””ë¡œ ìœ ì € ì •ë³´ ì¡°íšŒ
        user = userMapper.selectOne(user);
        if (user == null) {
            throw new UnauthorizedException("ì‚¬ìš©ì ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤. ë¡œê·¸ì¸ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
        }
        
        // ë³„ë„ë¡œ ì£¼ë¬¸ ì´ì•¡ ì¡°íšŒ
        Order orderInput = new Order();
        orderInput.setUserId(user.getUserId());
        int totalOrderPrice = orderMapper.selectTotalOrderPriceByUserId(orderInput);
        user.setOrderTotalPrice(totalOrderPrice);
        
        return user;
    }
```

### ğŸ“Œ 0-8. mapper, controller ì •ë¦¬
- ê¸°ì¡´ì— ë‚´ê°€ ë§Œë“¤ì—ˆë˜ login, edit_profileê³¼ íŒ€ì›ì´ ë§Œë“¤ì—ˆë˜ join ê¸°ëŠ¥ì„ ë‹´ë‹¹í•˜ëŠ” mapperì™€ controllerë¥¼ user mapperì™€ user controllerë¡œ í•©ì³¤ë‹¤.
- í•©ì¹˜ëŠ”ê²Œ ê·¸ë ‡ê²Œ ì˜¤ë˜ ê±¸ë¦¬ì§€ ì•Šì•˜ê³  ë‹¤ìŒì— ì „ì²´ì ì¸ êµ¬ì¡°ë¥¼ ì„¤ê³„í• ë•Œ ë„ì›€ì´ ë˜ëŠ” ê²½í—˜ì„ í•œ ê²ƒ ê°™ë‹¤.

