# 📌 0. 데이터 분석을 위한 데이터 시각화
### 📌 0-1. countplot()
- seaborn 패키지의 분석 툴이다.
- countplot은 해당 범주에 있는 데이터의 개수를 카운트해주는 시각화 코드이므로 범주형 변수 하나만 지정해주는 것이 좋다.
- 즉 x축이 범주형 변수, y축이 개수(연속형 변수 중 특히)가 된다. 
- data 속성으로 데이터 프레임 변수를 제공해준다.
- 만약 y축에만 데이터를 넣으면 축이 뒤집힌 그래프가 그려진다.
```py
import seaborn as sns

data = pd.read_csv("/content/health_2016.csv")

# 1) countplot(): 범주형 -> 개수 카운트
sns.countplot(x="성별코드", data=data)
```

### 📌 0-2. matplot 일반적인 사용
- 아무 것도 안 하고 sns.countplot(...)만 실행할 때
- seaborn은 내부에서 ax = plt.gca()를 불러서 "현재 활성화된 Axes"를 가져오려고 한다.
- 근데 아직 Figure/Axes가 없으니까 matplotlib이 자동으로 plt.figure()를 **기본값(default size, 보통 6.4 x 4.8 인치)**로 하나 만든다.
- 그 Figure 안에 기본 Axes(좌표 영역)를 하나 추가한다.
- seaborn이 그 Axes에다 countplot을 그린다.
- 만약 캔버스를 내가 새로 그리고 싶다면 아래처럼 하면된다.
- plt.figure(figsize=(10,2)) → 새로운 Figure 객체를 만든다.
- Figure는 전체 그림 캔버스(하얀 도화지)에 해당하고, 그 안에 여러 개의 Axes(좌표축)을 가질 수 있다. figsize=(10,2)는 이 도화지의 크기를 인치 단위로 지정하는 것이다.
- sns.countplot은 내부에서 plt.gca() (get current axes)를 불러서 현재 활성화된 Axes에 그림을 올린다.
```py
import matplotlib.pyplot as plt

# 사이즈 크기 (픽셀단위 가로 세로)
plt.figure(figsize=(10,2))
sns.countplot(x="성별코드", data=data)
```
- text, title(제목), 라벨 등 디테일한 값들을 아래 옵션들을 통해 상세하게 설정할 수 있다.
```py
# 글자, 텍스트 표시 (인덱스, 높이, 글자)
plt.text(0,300,"글자표시", fontsize=15, color='white')

# 타이틀 표시 (상단 제목 표시)
plt.title("시각화 제목 연습", fontsize=20)

# x, y 축 axis에서 label -> 기본값은 칼럼 이름
plt.xlabel("x축 라벨", fontsize = 15)
plt.ylabel("y축 라벨", fontsize = 15)  

# x, y 축 axis에서 ticks(눈금)
plt.xticks([0,1],["남성","여성"], fontsize=15, color='red', rotation=45)
plt.yticks([0,100,300,500,700], fontsize=15, color='red', rotation=45)

# y축 스케일 잡기
plt.ylim(0,1000)

# 정리해서 깔끔하게 캔버스만 제시해줌
plt.show()
```
- 영어 hue = "색조, 빛깔" 이라는 뜻으로 데이터의 또 다른 범주를 색깔로 구분하는 기능이라 그대로 단어를 가져다 쓴 것이다. 이는 성별코드로 나눠진 범주 안에서 시도코드로 세분화하여 막대그래프를 그래준다.
- dodge = "옆으로 비키다, 피하다" : 같은 x 범주 안에서 여러 hue 막대들이 겹치지 않도록 옆으로 비켜 서게 만든다는 뜻으로 이를 true로 주면 겹치지 않고 나란히 비켜서게 된다.
```py
plt.figure(figsize=(10,2))
sns.countplot(x="성별코드", data=data, hue='시도코드', dodge=True)
```
- order는 정렬 옵션으로 정렬 기준을 제시해주면 되는데 원래 [41,22,33] 이런식으로 인덱스 순서를 리스트로 제공해야하는데 value_counts가 기본값이 내림차순이고 이렇게 정렬된 상태에서 index를 주면 인덱스를 그 순서로 뽑아서 리스트로 돌려주므로 이걸 바로 값으로 주어도 된다.
```py
sns.countplot(data=data, x='시도코드', order=data['시도코드'].value_counts().index)
```

### 📌 0-3. barplot(), lineplot(), pointplot()
- barplot은 범주형 - 연속형 변수를 나타낼 때 사용한다.
- estimator는 연속형 변수의 대표값을 나타낼 때 어떻게 집계할지를 나타내는 값으로 기본값은 mean이고 min, max, medianm, sum, count같은 값을 쓸 수 있다.
- ci = Confidence Interval의 줄임말로 신뢰구간을 의미한다.
- 현재 데이터의 값은 표본평균이므로 실제 모평균이 포함될 수 있는 범위를 신뢰구간으로 표시해주어야한다. 하여 이 ci 옵션을 걸면 막대의 끝 부분에 95% 신뢰구간의 범위를 나타내는 라인이 같이 그려진다.
```py
### 📌 barplot(): 범주형(범주가 연속형으로 집계할때 기본값은 평균이다.) + 연속형
plt.figure(figsize=(10, 3))
sns.barplot(data=data, x='연령대코드(5세단위)', y='수축기혈압', ci=95 , estimator='mean')
```
- 위의 막대 그래프는 시작점이 0이지만 이 선 그래프는 시작점이 데이터를 표현하기 적합한 위치이다.
- lineplot은 같은 매개변수를 가지고 선그래프를 그려주는 함수이다.
```py
plt.figure(figsize=(10, 3))
sns.lineplot(data=data, x='연령대코드(5세단위)', y='수축기혈압', ci=95 , estimator='mean') 
```
- 이는 라인에 점으로 포인트를 찍고 이를 연결한 형태의 그래프를 그려준다.
```py
plt.figure(figsize=(10, 3))
sns.pointplot(data=data, x='연령대코드(5세단위)', y='수축기혈압', ci=95 , estimator='mean') 
```

### 📌 0-4. distplot(), histplot(), displot(), kdeplot()
- distplot = distribution plot의 줄임말이다.
- distplot()은 보통 왜도를 시각화할때 사용한다. -> kde 옵션만 주면 된다.
- pandas의 skew함수를 통해서도 왜도값을 바로 얻을 수 있기는 하다.
```py
data["허리둘레"].skew()
```
- kde=True는 히스토그램 막대 위에 데이터의 확률 밀도 함수 형태를 추정해서 곡선으로 같이 보여준다는 뜻이다.
- 아래 함수를 이용하여 수축기 혈압의 밀도 그래프를 그린다.
- 근데 이제 distplot은 지원하지 않을 예정이다.
```py
plt.figure(figsize=(10, 3))
sns.distplot(data['수축기혈압'], kde=True)  
plt.show()
```
- histplot은 히스토그램을 보여주는 plot이다.
- kdeplot은 히스토그램말고 kde선만 보여준다.
- Kernel Density Estimation으로 이는 데이터의 확률밀도함수형태를 추정해서 곡선으로 같이 보여준다는 의미이다.
- displot() = 매니저 (figure 전체를 관리하면서 histplot이나 kdeplot을 여러 subplot에 배치할 수 있게한다.).
```py
# histplot()
plt.figure(figsize=(10, 3))
sns.histplot(data['수축기혈압'])  
plt.show()

# kdeplot()
plt.figure(figsize=(10, 3))
sns.kdeplot(data['수축기혈압'])  
plt.show()
```
- distplot은 아래처럼 여러개의 분포를 한번에 보여줄 때 사용한다. 종별로 분포 그림을 따로따로 그린 모습이다.
```PY

# 예시 데이터: 펭귄 데이터셋
penguins = sns.load_dataset("penguins")

# 연속형 변수(몸무게) 분포를 '섬(species)' 별로 나눠서 출력
sns.displot(
    data=penguins,
    x="body_mass_g",
    col="species",   # 종(species) 별로 열 방향 분리
    kde=True         # KDE 곡선 추가
)

plt.show()
```

### 📌 0-5. boxplot()
- 연속형,연속형 + 범주형을 표현할때 사용한다.
- 그 boxplot을 그려준다. 이때 아래는 범주별로 수축기 혈압의 분포를 각각 그려서 비교할 수 있게 보여준다.
```py
plt.figure(figsize=(10, 3))
sns.boxplot(data=data, x="연령대코드(5세단위)", y="수축기혈압")  
plt.show()
```

### 📌 0-6. scatterplot()
- 산점도를 그리는 함수이다. 이 또한 x축의 값과 y축의 값을 제공하면 산점도를 그려준다.
```py
plt.figure(figsize=(9, 5))
sns.scatterplot(data=data, x='식전혈당(공복혈당)', y='수축기혈압')   # 400 넘는 이상치 값이 확인되어 제거하기로 함
```

### 📌 0-7. subplot()
- 화면을 분할하여 여러개의 그래프를 보여주는 방법이다.
- plt.subplot(2,2,1)을 하면: Figure 안에 2x2 = 4개의 칸짜리 그리드가 만들어짐.
- 그 중 **첫 번째 칸(위-왼쪽)**을 활성화(Axes 객체 선택)한다. 이렇게 활성화 해두고 seaborn으로 그림을 그리면 내부적으로 plt.gca() (= get current axes)를 불러와서 현재 활성화된 Axes에 그림을 그린다. 즉 활성화 -> 그림그리기로 특정 위치에 특정 그래프를 넣는 것이 가능해지는 것이다.
```py
# 화면 분할 후 시각화를 표현하는 방법
plt.figure(figsize=(4,4))

plt.subplot(2,2,1)  # row, column, position 
sns.kdeplot(data['수축기혈압']) 

plt.subplot(2,2,4)  # row, column, position -> 이렇게 두개를 쓰면 1번 그래프와 4번 그래프가 둘개가 써진다.
sns.scatterplot(data=data, x='식전혈당(공복혈당)', y='수축기혈압') 
```