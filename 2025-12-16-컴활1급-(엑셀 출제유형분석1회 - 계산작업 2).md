# 📌 1. 엑셀 출제유형분석1회 - 계산작업 2
## 1-1. 배열수식으로 sum, if 활용
- 배열수식에서의 수식 조건에 사용되는 대상 범위는 절대화를 한다.
- 또 배열 수식은 함수 마법사를 쓰는 것보다 그냥 식을 입력하는 것이 편하다.
- 식을 입력할때 ctrl + shift + enter를 사용한다.
- =SUM(IF($C$4:$C$12=$A15,$D$4:$D$12))
- 이런 식으로 배열 수식 조건범위는 절대화한다.

## 1-2. 사용자 정의함수로 총매출 계산하기
- 우선 VBA를 사용하기 위해 alt + f11을 눌러서 들어간다.
- 또 vba는 연산자 양옆에 띄어쓰기가 있어야하고 값을 리턴할때는 함수명에 리턴할 값을 대입하여 리턴한다.
```vba
Public Function fn총매출(단가, 할인율, 판매량)

fn총매출 = 단가 * (1 - 할인율) * 판매량

End Function
```
- 이처럼 코드를 입력한 후에 함수 마법사의 사용자 정의 함수에서 해당 함수를 선택하여 일반 함수처럼 사용하면 된다.