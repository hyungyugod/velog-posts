# ğŸ“Œ 0. ëŒ€í™”
### ğŸ“Œ 0-1. mapperì—ì„œ ì–´ë–»ê²Œ ìë™ìœ¼ë¡œ ë°ì´í„° íƒ€ì…ì— ì•Œë§ê²Œ ë¦¬í„´ë˜ëŠ”ê°€?
- MyBatisëŠ” ë©”ì„œë“œì˜ ë¦¬í„´ íƒ€ì…ì„ ë³´ê³ , SQL ì‹¤í–‰ ê²°ê³¼ë¥¼ ê·¸ íƒ€ì…ì— ìë™ìœ¼ë¡œ ë§¤í•‘í•´ì¤€ë‹¤.
- ë‚´ë¶€ì ìœ¼ë¡œ í•œ í–‰ì¸ì§€ ì—¬ëŸ¬ í–‰ì¸ì§€ ResultSetHandlerë¼ëŠ” ë‚´ë¶€ ì»´í¬ë„ŒíŠ¸ê°€ íŒë‹¨í•´ì„œ sql ì‹¤í–‰ê²°ê³¼ì¸ ResultSetì„ ê¸°ì¤€ìœ¼ë¡œ íŒë‹¨í•œ í›„ ì»¬ëŸ¼ëª…ê³¼ í´ë˜ìŠ¤ì˜ í•„ë“œëª…ì„ ë§¤í•‘í•˜ì—¬ ê°’ì„ ì •ë¦¬í•œë‹¤.

| ë¦¬í„´ íƒ€ì…                       | SQL ê²°ê³¼   | MyBatis ë™ì‘ ì„¤ëª…                                      |
|------------------------------|------------|-------------------------------------------------------|
| `int`, `long`, `boolean`     | ìˆ«ì 1ê°œ   | `SELECT COUNT(*)` ë˜ëŠ” `UPDATE`, `DELETE` ìˆ˜í–‰ ê²°ê³¼     |
| `String`, `Date`, `Double`   | ì»¬ëŸ¼ 1ê°œ   | ì²« ë²ˆì§¸ í–‰ì˜ ì²« ë²ˆì§¸ ì»¬ëŸ¼ ê°’ì„ ê°€ì ¸ì™€ì„œ ë¦¬í„´             |
| `Department` ê°™ì€ VO ê°ì²´     | í–‰ 1ê°œ     | ì»¬ëŸ¼ ì´ë¦„ê³¼ í•„ë“œëª…ì„ ë§¤í•‘í•˜ì—¬ ê°ì²´ ìƒì„±                  |
| `List<Department>`           | ì—¬ëŸ¬ í–‰    | ê° í–‰ì„ ê°ì²´ë¡œ ë§Œë“¤ì–´ ë¦¬ìŠ¤íŠ¸ë¡œ ë¦¬í„´                      |
| `Map<String, Object>`        | í–‰ 1ê°œ     | ì»¬ëŸ¼ ì´ë¦„ì„ í‚¤ë¡œ í•´ì„œ Mapìœ¼ë¡œ ë¦¬í„´                      |
| `List<Map<String, Object>>`  | ì—¬ëŸ¬ í–‰    | ê° í–‰ì„ Mapìœ¼ë¡œ ë§Œë“¤ì–´ ë¦¬ìŠ¤íŠ¸ë¡œ ë¦¬í„´                    |

### ğŸ“Œ 0-2. DTO/VO/DAO

| ìš©ì–´ | ì•½ì                  | ì˜ë¯¸               |
|------|-----------------------|--------------------|
| DTO  | Data Transfer Object | ë°ì´í„° ì „ë‹¬ ê°ì²´   |
| VO   | Value Object         | ê°’(ì •ë³´) ê°ì²´      |
| DAO  | Data Access Object   | ë°ì´í„° ì ‘ê·¼ ê°ì²´   |

### ğŸ“Œ 0-3. 3ê³„ì¸µ êµ¬ì¡°

| ê³„ì¸µ ì´ë¦„                              | í•µì‹¬ ì—­í•                                       | ì˜ˆì‹œ í´ë˜ìŠ¤ (ì§€ê¸ˆê¹Œì§€ ë§Œë“  ì½”ë“œ ê¸°ì¤€)               |
|----------------------------------------|-----------------------------------------------|---------------------------------------------------|
| **í”„ë ˆì  í…Œì´ì…˜ ê³„ì¸µ**<br>(Presentation Layer)     | ì‚¬ìš©ìì˜ ì…ë ¥ì„ ë°›ê³  ì‘ë‹µì„ ëŒë ¤ì¤Œ (UI, Controller) | ì›¹ì´ë¼ë©´ `Controller`, ì½˜ì†”ì´ë©´ `main()`           |
| **ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ê³„ì¸µ**<br>(Service Layer)         | ë¡œì§ ì²˜ë¦¬, íë¦„ ì œì–´, ì˜ˆì™¸ ì²˜ë¦¬ ë“± ì¤‘ê°„ ê´€ë¦¬ì ì—­í•     | `DepartmentService`, `DepartmentServiceImpl`     |
| **ë°ì´í„° ì ‘ê·¼ ê³„ì¸µ**<br>(DAO Layer / Persistence Layer) | ì‹¤ì œë¡œ DBì™€ ì§ì ‘ í†µì‹                              | `DepartmentMapper` (MyBatis ì‚¬ìš©)                |


# ğŸ“Œ 1. í•™ê³¼ ì„œë¹„ìŠ¤ í‹€ êµ¬í˜„í•˜ê¸°

| ê³„ì¸µ(Layer)                  | í´ë˜ìŠ¤/ì¸í„°í˜ì´ìŠ¤               | ì—­í•  ë° ì„¤ëª… |
|-----------------------------|-------------------------------|-------------|
| **1. Model (DTO/VO)**       | `Department`                 | - DB í…Œì´ë¸”ê³¼ 1:1 ë§¤í•‘<br>- `id`, `dname`, `loc` ë“±ì˜ í•„ë“œ ë³´ìœ <br>- Lombok `@Data` ì‚¬ìš©ìœ¼ë¡œ getter/setter ìë™ ìƒì„± |
| **2. Persistence Layer**    | `DepartmentMapper`           | - `@Select`, `@Insert` ë“± SQL ì •ì˜<br>- MyBatisê°€ **í”„ë¡ì‹œë¡œ êµ¬í˜„ì²´ ìƒì„±**<br>- ì‹¤ì œ DB ì ‘ê·¼ ìˆ˜í–‰ (DAO ì—­í• )<br>ğŸ“Œ **Proxy + DAO íŒ¨í„´** ì ìš© |
| **3. Service Layer (ì¸í„°í˜ì´ìŠ¤)** | `DepartmentService`           | - ê¸°ëŠ¥ ì •ì˜ìš© ì¸í„°í˜ì´ìŠ¤<br>- `getList`, `getItem`, `addItem` ë“± ë©”ì„œë“œ ì„ ì–¸ |
| **3. Service Layer (êµ¬í˜„ì²´)** | `DepartmentServiceImpl`       | - `DepartmentService` êµ¬í˜„<br>- ë‚´ë¶€ì—ì„œ `DepartmentMapper` í˜¸ì¶œ<br>- `SqlSession` ì£¼ì…ë°›ì•„ mapper ê°ì²´ ìƒì„±<br>ğŸ“Œ DAOë¥¼ ìœ„ì„ë°›ì•„ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ìˆ˜í–‰ |
| **4. Connection Layer**     | `MyBatisConnectionFactory`   | - `config.xml` ê¸°ë°˜ìœ¼ë¡œ `SqlSessionFactory` ìƒì„±<br>- DB ì—°ê²°ì„ ìœ„í•œ ì„¸ì…˜ ì œê³µ (`openSession()`) -> main classì—ì„œ ì„¸ì…˜ì„ ì—´ ë•Œ |
| **4. Exception Layer**      | `ServiceNoResultException`   | - ì¡°íšŒ/ìˆ˜ì •/ì‚­ì œ ê²°ê³¼ ì—†ì„ ë•Œ ë°œìƒ<br>- ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ íë¦„ê³¼ ì˜ˆì™¸ íë¦„ì„ ë¶„ë¦¬ |

### ğŸ“Œ 1-1. ServiceNoResultException
- ì„œë¹„ìŠ¤ ìƒì—ì„œ í”„ë¡œê·¸ë¨ì„ ë”ì´ìƒ ì§„í–‰ì‹œí‚¤ì§€ ë§ì•„ì•¼í•  ì—ëŸ¬ë¥¼ ë°œìƒì‹œí‚´.
```java
public class ServiceNoResultException extends Exception{ // ì„œë¹„ìŠ¤ ìƒ ë°œìƒí•˜ëŠ” ì—ëŸ¬ë¥¼ ëŒ€ì²˜í•˜ê¸° ìœ„í•œ í´ë˜ìŠ¤ í˜•ì„±
    public ServiceNoResultException(String message) {
        super(message);
    }
}
```

### ğŸ“Œ 1-2. ì„œë¹„ìŠ¤ì˜ êµ¬í˜„ì²´ë“¤ì´ ê°€ì§€ê³  ìˆì–´ì•¼ í•˜ëŠ” ê¸°ë³¸ì ì¸ ê¸°ëŠ¥ì„ ì¸í„°í˜ì´ìŠ¤ë¡œ ì •ì˜
```java
public interface DepartmentService {
    /**
     * <í•™ê³¼ì˜ ëª©ë¡ì„ ì¡°íšŒ>
     * 
     * @param input - ì¡°íšŒí•  í•™ê³¼ì˜ ê²€ìƒ‰ì–´ë¥¼ ë‹´ê³ ìˆëŠ” beans
     * @return - List<Department> ì¡°íšŒëœ ë°ì´í„°
     * @throws ServiceNoResultException - ì¡°íšŒëœ ë°ì´í„°ê°€ ì—†ëŠ” ê²½ìš°
     * @throws Exception - sql ì²˜ë¦¬ì— ì‹¤íŒ¨í•œ ê²½ìš° (í”„ë¡œê·¸ë¨ì ì¸ ì—ëŸ¬)
     */
    public List<Department> getList(Department input) throws ServiceNoResultException, Exception;

    /**
     * <í•™ê³¼ì˜ ìƒì„¸ì •ë³´ë¥¼ ì¡°íšŒ>
     * 
     * @param input - ì¡°íšŒí•  í•™ê³¼ì˜ ì¼ë ¨ë²ˆí˜¸ë¥¼ ë‹´ê³ ìˆëŠ” beans 
     * @return - ì¡°íšŒëœ ë°ì´í„°
     * @throws ServiceNoResultException - ì¡°íšŒëœ ë°ì´í„°ê°€ ì—†ëŠ” ê²½ìš°
     * @throws Exception - sqlì²˜ë¦¬ì— ì‹¤íŒ¨í•œ ê²½ìš°
     */
    public Department getItem(Department input) throws ServiceNoResultException, Exception;

    /**
     * <í•™ê³¼ ë°ì´í„°ë¥¼ ì¶”ê°€í•˜ê³  ì €ì¥ëœ ì •ë³´ë¥¼ ë°”ë¡œ ë¦¬í„´í•˜ì—¬ í™•ì¸ì‹œí‚´>
     * 
     * @param input - ì €ì¥í•  ì •ë³´ë¥¼ ë‹´ê³ ìˆëŠ” beans
     * @return - ì¡°íšŒëœ ë°ì´í„°
     * @throws ServiceNoResultException - ì €ì¥ëœ ë°ì´í„°ê°€ ì—†ëŠ”ê²½ìš°
     * @throws Exception - sql ì²˜ë¦¬ì— ì‹¤íŒ¨í•œ ê²½ìš° (í”„ë¡œê·¸ë¨ì ì¸ ì—ëŸ¬)
     */
    public Department addItem(Department input) throws ServiceNoResultException, Exception;

    /**
     * <í•™ê³¼ ì •ë³´ë¥¼ ìˆ˜ì •í•˜ê³  ìˆ˜ì •í•œ ë‚´ì—­ì„ ë¦¬í„´í•œë‹¤.>
     * 
     * @param input - ìˆ˜ì •í•  ì •ë³´ë¥¼ ë‹´ê³  ìˆëŠ” beans
     * @return - ìˆ˜ì •ëœ ë°ì´í„°
     * @throws ServiceNoResultException - ìˆ˜ì •ëœ ë°ì´í„°ê°€ ì—†ëŠ” ê²½ìš°
     * @throws Exception  - sqlë¬¸ì´ ì²˜ë¦¬ë˜ì§€ ì•Šì•˜ì„ ê²½ìš°
     */
    public Department editItem(Department input) throws ServiceNoResultException, Exception;

    /**
     * <í•™ê³¼ ì •ë³´ë¥¼ ì‚­ì œí•œë‹¤.>
     * 
     * @param input - ì‚­ì œí•  ì •ë³´ê°€ ë‹´ê²¨ìˆëŠ” beans
     * @return - ì‚­ì œí•œ ì •ë³´ì˜ ìˆ˜
     * @throws ServiceNoResultException - ì‚­ì œëœ ë°ì´í„°ê°€ ì—†ëŠ” ê²½ìš°
     * @throws Exception - sqlë¬¸ì´ ì •ìƒ ì²˜ë¦¬ë˜ì§€ ì•Šì€ ê²½ìš°
     */
    public int deleteItem(Department input) throws ServiceNoResultException, Exception;
} 
```

### ğŸ“Œ 1-3. í•™ì  ê´€ë¦¬ì— ëŒ€í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ìœ„ë¥¼ ìƒì†ë°›ì•„ êµ¬í˜„í•˜ëŠ” í´ë˜ìŠ¤
- ì¸í„°í˜ì´ìŠ¤ë¥¼ ìƒì„¸í•˜ê²Œ êµ¬ì„±í•œë‹¤.
- ì˜¤ë²„ë¼ì´ë“œ í•œ í›„ì— ìµœìš°ì„ ì ìœ¼ë¡œ ê° ë©”ì„œë“œì˜ ë¦¬í„´ê°’ì„ ì¤€ë¹„í•œë‹¤.
- ì•„ë˜ëŠ” êµ¬í˜„ì²´ì˜ ê¸°ë³¸ ì„¸íŒ…ì´ë‹¤. (ìš°ì„  ì•„ë˜ì™€ ê°™ì´ êµ¬ì„±í•œë‹¤.)
- ì£¼ ëª©ì ì€ mapper ìƒì„±, sql ê²°ê³¼ì˜ ë°˜í™˜ì„ ëŒ€í–‰í•œë‹¤.
- ë‹¨ì¼í–‰ ì¡°íšŒëŠ” ëª©ë¡ì¡°íšŒë¥¼ ë³´í†µ íƒ€ê³  ë“¤ì–´ê°€ë¯€ë¡œ ì—†ëŠ” ê°’ì´ ë‚˜ì˜¬ ê²½ìš°ëŠ” ì—ëŸ¬ì²˜ë¦¬ë¥¼ í•´ì¤˜ì•¼í•œë‹¤. (ì—†ëŠ”ê²Œ ë§ì´ ì•ˆë¨ -> ë³´í†µ ì‚¬ìš©ìê°€ ì¡°ì‘í•œ ê°’ì„ ì˜ë¯¸í•œë‹¤.)
- openëœ ì„¸ì…˜ì„ ë°›ì•„ì„œ mapper ì„¸íŒ…ì„ ëŒ€í–‰í•´ì¤€ë‹¤. mapperê°€ ì •ì˜í•œ sqlì˜ ê¸°ëŠ¥ì€ ê³ ìœ í•˜ê¸° ë•Œë¬¸ì— mapperê°€ ì¤‘ì‹¬ì´ê³  í´ë˜ìŠ¤ê°€ êµ¬í˜„ì²´ì¸ê²Œ ë§ë‹¤.
- import your.package.Subject; ì´ëŸ° ê±° ìë™ìœ¼ë¡œ importë˜ì–´ìˆëŠ”ì§€ í™•ì¸í•˜ê³  í´ë˜ìŠ¤ ì´ë¦„ì€ ë¬´ì¡°ê±´ ì²«ê¸€ì ëŒ€ë¬¸ìì¸ì§€ í™•ì¸í•˜ê¸°
```java
public class DepartmentServiceImpl implements DepartmentService{ // mapper ë°˜í™˜ ëŒ€í–‰
    private DepartmentMapper mapper; 
    private EnrollmentMapper enrollmentMapper;
    private ProfessorMapper professorMapper;
    private StudentMapper studentMapper;
    private SubjectMapper subjectMapper;

    public DepartmentServiceImpl (SqlSession sqlSession){    // openëœ ì„¸ì…˜ì„ ë°›ì•„ì„œ mapper ì„¸íŒ…ì„ ëŒ€í–‰í•´ì¤€ë‹¤. mapperê°€ ì •ì˜í•œ sqlì˜ ê¸°ëŠ¥ì€ ê³ ìœ í•˜ê¸° ë•Œë¬¸ì— mapperê°€ ì¤‘ì‹¬ì´ê³  í´ë˜ìŠ¤ê°€ êµ¬í˜„ì²´ì¸ê²Œ ë§ë‹¤.
        this.mapper = sqlSession.getMapper(DepartmentMapper.class); // ì—´ë¦° ì„¸ì…˜ì„ ë°›ì•„ì„œ í”„ë¡ì‹œ ê°ì²´ ìƒì„± -> í•˜ë‚˜ì˜ ì„¸ì…˜ì—ì„œ ì—¬ëŸ¬ê°œì˜ mapperë¥¼ ë™ì‹œì— ìƒì„±
        this.enrollmentMapper = sqlSession.getMapper(EnrollmentMapper.class);
        this.professorMapper = sqlSession.getMapper(ProfessorMapper.class);
        this.studentMapper = sqlSession.getMapper(StudentMapper.class);
        this.subjectMapper = sqlSession.getMapper(SubjectMapper.class);

    }

    @Override
    public List<Department> getList(Department input) throws ServiceNoResultException, Exception {
        List<Department> output = null;
        output = mapper.selectList(input);
        return output;
    }

    @Override
    public Department getItem(Department input) throws ServiceNoResultException, Exception {
        Department output = null;
        output = mapper.selectOne(input);

        if (output == null){ // ë‹¨ì¼í–‰ ì¡°íšŒëŠ” ê°’ì´ ì—†ëŠ” ê²ƒì„ ë”°ë¡œ ì—ëŸ¬ë¡œ ì²˜ë¦¬í•´ ì£¼ì–´ì•¼ í•œë‹¤.
            throw new ServiceNoResultException("ì¡°íšŒê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.");
        }
        return output;
    }

    @Override
    public Department addItem(Department input) throws ServiceNoResultException, Exception {
        Department output = null;

        int row = mapper.insert(input); // ë„£ì€ í–‰ì˜ ê°œìˆ˜ ë°˜í™˜

        if (row == 0){
            throw new ServiceNoResultException("ì €ì¥ëœ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.");
        }

        output = mapper.selectOne(input); // inputì— ì €ì¥ëœ pkë¥¼ ì´ìš©í•´ì„œ ë‹¤ì‹œ select

        return output;
    }

    @Override
    public Department editItem(Department input) throws ServiceNoResultException, Exception {
        Department output = null;

        int row = mapper.update(input); // ìˆ˜ì •í•œ í–‰ì˜ ê°œìˆ˜ ë°˜í™˜

        if (row == 0){
            throw new ServiceNoResultException("ì €ì¥ëœ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.");
        }

        output = mapper.selectOne(input); // inputì— ì €ì¥ëœ pkë¥¼ ì´ìš©í•´ì„œ ë‹¤ì‹œ select

        return output;
    }

    @Override
    public int deleteItem(Department input) throws ServiceNoResultException, Exception {
        int output = 0;

        // í•™ê³¼ ì‚­ì œë¥¼ ìœ„í•œ ë°ì´í„° ì²˜ë¦¬ ìˆœì„œ
        // 1) ìˆ˜ê°• ë‚´ì—­ ì‚­ì œ
        Student student = new Student();
        student.setDepartmentId(input.getId());

        enrollmentMapper.deleteByStudentId(student);

        // 2) í•™ìƒ ì¼ê´„ ì‚­ì œ
        studentMapper.deleteByDepartmentId(student);

        // 3) ê³¼ëª© ì¼ê´„ ì‚­ì œ
        Subject subject = new Subject();
        subject.setDepartmentId(input.getId());
        subjectMapper.deleteByProfessorId(subject);

        // 4) êµìˆ˜ ì¼ê´„ ì‚­ì œ
        Professor professor = new Professor();
        professor.setDepartmentId(input.getId());
        professorMapper.deleteByDepartmentId(professor);

        // 5) í•™ê³¼ ì‚­ì œ
        output = mapper.delete(input);

        if (output == 0) {
            throw new ServiceNoResultException("ì‚­ì œëœ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.");
        }


        return output;
    }
}
``` 

### ğŸ“Œ 1-4. DepartmentService ê°ì²´ë¥¼ í™œìš©í•´ mapperë¥¼ ì§ì ‘ ì‚¬ìš©í•˜ì§€ ì•Šê³  ë‹¨ì¼í–‰ ì¡°íšŒ
- try-catchì•ˆì—ì„œ ë³€ìˆ˜ë¥¼ ìƒì„±í•˜ë©´ ì•ˆì—ì„œ ë°–ì— ëª»ì“°ë¯€ë¡œ ë°–ì—ë„ í•˜ë‚˜ ë§Œë“¤ì–´ì¤˜ì•¼í•œë‹¤.
- í”„ë¡œê·¸ë¨ì´ ì‹œì‘í•˜ëŠ” mainì—ì„œ ì„¸ì…˜ì„ ì—´ì–´ì£¼ê³  ì—° ì„¸ì…˜ì„ í†µí•´ ì„œë¹„ìŠ¤ë¥¼ í™œì„±í™”í•˜ëŠ”ê²Œ ë§ë‹¤.
- ì„œë¹„ìŠ¤ëŠ” ë‚´ë¶€ì ìœ¼ë¡œ mapperë¥¼ ì´ìš©í•´ ì‘ì—…ì„ ì‹¤í–‰í•˜ì—¬ ìë°”ì— ì¹œìˆ™í•œ ë°ì´í„° íƒ€ì…ìœ¼ë¡œ ë¦¬í„´í•´ì¤€ë‹¤.
```java
@Slf4j
public class App11 {
    public static void main(String[] args) {
        SqlSession openSqlSession = MyBatisConnectionFactory.getSqlSession(); // sql ì„¸ì…˜ì„ ì—¶.

        DepartmentService departmentService = new DepartmentServiceImpl(openSqlSession);

        Department input = new Department();
        input.setId(101);

        Department output = null; // try-catch ë¡œì»¬ë³€ìˆ˜ ë¬¸ì œ ë•Œë¬¸ì— ë°–ì— í•˜ë‚˜ ë§Œë“¤ì–´ë‘¬ì•¼í•œë‹¤.
        try {
            output = departmentService.getItem(input);
        } catch (ServiceNoResultException e) {
            log.error("ì²˜ë¦¬ëœ ë°ì´í„° ì—†ìŒ >> whereì ˆì„ í™•ì¸í•˜ì„¸ìš”", e);
        } catch (Exception e) {
            log.error("ë°ì´í„° ì²˜ë¦¬ ì‹¤íŒ¨ >> sqlë¬¸ì„ í™•ì¸í•˜ì„¸ìš”", e);
        }

        if (output != null){
            log.debug("ì¡°íšŒê²°ê³¼ ---> " + output.toString());
        }

        openSqlSession.close(); // ì—´ì—ˆìœ¼ë©´ ë‹«ì•„ì•¼í•˜ê³  ë°ì´í„°ê°€ ë°”ë€ê²Œ ì•„ë‹ˆë¯€ë¡œ commit ì²˜ë¦¬ëŠ” í•˜ì§€ ì•ŠëŠ”ë‹¤.
    }
}
```

### ğŸ“Œ 1-5. DepartmentService ê°ì²´ë¥¼ í™œìš©í•´ mapperë¥¼ ì§ì ‘ ì‚¬ìš©í•˜ì§€ ì•Šê³  ì „ì²´í–‰ ì¡°íšŒ
```java
@Slf4j
public class App10 {
    public static void main(String[] args) {
        SqlSession openSqlSession = MyBatisConnectionFactory.getSqlSession(); // sql ì„¸ì…˜ì„ ì—¶.

        DepartmentService departmentService = new DepartmentServiceImpl(openSqlSession);

        List<Department> output = null; // try-catch ë¡œì»¬ë³€ìˆ˜ ë¬¸ì œ ë•Œë¬¸ì— ë°–ì— í•˜ë‚˜ ë§Œë“¤ì–´ë‘¬ì•¼í•œë‹¤.

        try {
            output = departmentService.getList(null);
        } catch (ServiceNoResultException e) {
            log.error("ì²˜ë¦¬ëœ ë°ì´í„° ì—†ìŒ >> whereì ˆì„ í™•ì¸í•˜ì„¸ìš”", e);
        } catch (Exception e) {
            log.error("ë°ì´í„° ì²˜ë¦¬ ì‹¤íŒ¨ >> sqlë¬¸ì„ í™•ì¸í•˜ì„¸ìš”", e);
        }

        if (output != null){
            log.debug("ì¡°íšŒê²°ê³¼ ---> " + output.toString());
        }

        openSqlSession.close(); // ì—´ì—ˆìœ¼ë©´ ë‹«ì•„ì•¼í•˜ê³  ë°ì´í„°ê°€ ë°”ë€ê²Œ ì•„ë‹ˆë¯€ë¡œ commit ì²˜ë¦¬ëŠ” í•˜ì§€ ì•ŠëŠ”ë‹¤.
    }
}
```
### ğŸ“Œ 1-6. DepartmentService ê°ì²´ë¥¼ í™œìš©í•´ mapperë¥¼ ì§ì ‘ ì‚¬ìš©í•˜ì§€ ì•Šê³  ì‚½ì…
```java
@Slf4j
public class App12 {
    public static void main(String[] args) {
        SqlSession openSqlSession = MyBatisConnectionFactory.getSqlSession();
        DepartmentService departmentService = new DepartmentServiceImpl(openSqlSession);

        Department input = new Department();
        input.setDname("ìë°”í•™ê³¼");
        input.setLoc("ê³µí•™ê´€");
        input.setPhone("02-234-5678");
        input.setEmail("java@myschool.ac.kr");
        input.setHomepage("https://java@myschool.ac.kr");
        input.setEstablished(2025);

        Department output = null;

        try {
            output = departmentService.addItem(input);
        } catch (ServiceNoResultException e) {
            log.error("ì²˜ë¦¬ëœ ë°ì´í„° ì—†ìŒ >> whereì ˆì„ í™•ì¸í•˜ì„¸ìš”", e);
            openSqlSession.rollback(); // í•´ë‹¹ ì„¸ì…˜ì—ì„œ ì§€ê¸ˆê¹Œì§€ ì‹¤í–‰ëœ ëª¨ë“  íŠ¸ëœì­ì…˜ ì‘ì—…ì„ ë¡¤ë°±(ì·¨ì†Œ)**í•˜ëŠ” ëª…ë ¹
        } catch (Exception e) {
            log.error("ë°ì´í„° ì²˜ë¦¬ ì‹¤íŒ¨ >> sqlë¬¸ì„ í™•ì¸í•˜ì„¸ìš”", e);
            openSqlSession.rollback(); // í•´ë‹¹ ì„¸ì…˜ì—ì„œ ì§€ê¸ˆê¹Œì§€ ì‹¤í–‰ëœ ëª¨ë“  íŠ¸ëœì­ì…˜ ì‘ì—…ì„ ë¡¤ë°±(ì·¨ì†Œ)**í•˜ëŠ” ëª…ë ¹
        } 

        if (output != null ){
            log.debug("ìˆ˜ì •ê²°ê³¼ ---> " + output.toString());
        }

        openSqlSession.commit();
        openSqlSession.close();
    }
}
```

### ğŸ“Œ 1-7. DepartmentService ê°ì²´ë¥¼ í™œìš©í•´ mapperë¥¼ ì§ì ‘ ì‚¬ìš©í•˜ì§€ ì•Šê³  ìˆ˜ì •
```java
@Slf4j
public class App13 {
    public static void main(String[] args) {
        SqlSession openSqlSession = MyBatisConnectionFactory.getSqlSession();
        DepartmentService departmentService = new DepartmentServiceImpl(openSqlSession);

        Department input = new Department();
        input.setId(514);
        input.setDname("ìë°”í•™ê³¼(ìˆ˜ì •)");
        input.setLoc("ê³µí•™ê´€(ìˆ˜ì •)");
        input.setPhone("02-234-5678");
        input.setEmail("java@myschool.ac.kr");
        input.setHomepage("https://java@myschool.ac.kr");
        input.setEstablished(2025);

        Department output = null;

        try {
            output = departmentService.editItem(input);
        } catch (ServiceNoResultException e) {
            log.error("ì²˜ë¦¬ëœ ë°ì´í„° ì—†ìŒ >> whereì ˆì„ í™•ì¸í•˜ì„¸ìš”", e);
            openSqlSession.rollback(); // í•´ë‹¹ ì„¸ì…˜ì—ì„œ ì§€ê¸ˆê¹Œì§€ ì‹¤í–‰ëœ ëª¨ë“  íŠ¸ëœì­ì…˜ ì‘ì—…ì„ ë¡¤ë°±(ì·¨ì†Œ)**í•˜ëŠ” ëª…ë ¹
        } catch (Exception e) {
            log.error("ë°ì´í„° ì²˜ë¦¬ ì‹¤íŒ¨ >> sqlë¬¸ì„ í™•ì¸í•˜ì„¸ìš”", e);
            openSqlSession.rollback(); // í•´ë‹¹ ì„¸ì…˜ì—ì„œ ì§€ê¸ˆê¹Œì§€ ì‹¤í–‰ëœ ëª¨ë“  íŠ¸ëœì­ì…˜ ì‘ì—…ì„ ë¡¤ë°±(ì·¨ì†Œ)**í•˜ëŠ” ëª…ë ¹
        } 

        if (output != null ){
            log.debug("ìˆ˜ì •ê²°ê³¼ ---> " + output.toString());
        }

        openSqlSession.commit();
        openSqlSession.close();
    }
}
```

### ğŸ“Œ 1-8. DepartmentService ê°ì²´ë¥¼ í™œìš©í•´ mapperë¥¼ ì§ì ‘ ì‚¬ìš©í•˜ì§€ ì•Šê³  ì‚­ì œ
- ì‚­ì œë¥¼ ìœ„í•´ ë‹¤ì–‘í•œ mapperì™€ ëª¨ë¸ í´ë˜ìŠ¤ë¥¼ ë¨¼ì € ì •ì˜í–ˆë‹¤. (ì°¸ì¡°ê´€ê³„ë¡œ ì–½í˜€ìˆëŠ” ê²ƒë“¤ë¶€í„° ì‚­ì œí•´ì•¼í•˜ë¯€ë¡œ)
- FROM ì˜¤íƒ€ë¥¼ ë„ˆë¬´ ë§ì´ ë‚´ê³  í…Œì´ë¸” ì´ë¦„ì— S ë¹¼ë¨¹ê³  Subject ì²˜ìŒì— ëŒ€ë¬¸ì ì•ˆì¨ì„œ ë‹¤ë¥¸ íŒ¨í‚¤ì§€ë¥¼ ì˜ëª» ì„í¬íŠ¸ í•œê±° ë•Œë¬¸ì— í•œì°¸ ë””ë²„ê·¸í–ˆë‹¤.
```java
@Slf4j
public class App14 {
    public static void main(String[] args) {
        SqlSession openSqlSession = MyBatisConnectionFactory.getSqlSession();
        DepartmentService departmentService = new DepartmentServiceImpl(openSqlSession);

        Department input = new Department();
        input.setId(102);
        int output = 0;

        try {
            output = departmentService.deleteItem(input);
        } catch (ServiceNoResultException e) {
            log.error("ì²˜ë¦¬ëœ ë°ì´í„° ì—†ìŒ >> whereì ˆì„ í™•ì¸í•˜ì„¸ìš”", e);
            openSqlSession.rollback(); // í•´ë‹¹ ì„¸ì…˜ì—ì„œ ì§€ê¸ˆê¹Œì§€ ì‹¤í–‰ëœ ëª¨ë“  íŠ¸ëœì­ì…˜ ì‘ì—…ì„ ë¡¤ë°±(ì·¨ì†Œ)**í•˜ëŠ” ëª…ë ¹
        } catch (Exception e) {
            log.error("ë°ì´í„° ì²˜ë¦¬ ì‹¤íŒ¨ >> sqlë¬¸ì„ í™•ì¸í•˜ì„¸ìš”", e);
            openSqlSession.rollback(); // í•´ë‹¹ ì„¸ì…˜ì—ì„œ ì§€ê¸ˆê¹Œì§€ ì‹¤í–‰ëœ ëª¨ë“  íŠ¸ëœì­ì…˜ ì‘ì—…ì„ ë¡¤ë°±(ì·¨ì†Œ)**í•˜ëŠ” ëª…ë ¹
        } 

            log.debug("ì‚­ì œëœ ë°ì´í„° ìˆ˜ ---> " + output);

        openSqlSession.commit();
        openSqlSession.close();
    }
}
```

### ğŸ“Œ 1-9 ì‚­ì œí•˜ê¸° ìœ„í•´ ì¶”ê°€í•œ mapperë“¤
- ê°ê° í•™ê³¼ë¥¼ ì‚­ì œí•˜ê¸° ìœ„í•œ sqlë¬¸ì´ ìœ ê¸°ì ìœ¼ë¡œ ì—°ê²°ë˜ì–´ìˆë‹¤.
- enrollment mapper
```java
@Mapper
public interface EnrollmentMapper{

    /**
     *  íŠ¹ì • í•™ê³¼ì— ì†Œì†ëœ í•™ìƒ í˜¹ì€ íŠ¹ì • í•™ê³¼ì˜ êµìˆ˜ì—ê²Œ ì§€ë„ë¥¼ ë°›ëŠ” í•™ìƒ ì´ê±°ë‚˜ ìˆ˜ê°•ì‹ ì²­ ê³¼ëª©ì„ ê°€ë¥´ì¹˜ëŠ” êµìˆ˜ê°€ ì‚­ì œí•˜ë ¤ëŠ” í•™ê³¼ êµìˆ˜ì˜€ë˜ ê²½ìš° ì‹ ì²­í•œ ìˆ˜ê°• ë‚´ì—­ì„ ì‚­ì œ
     * @param input - ì‚­ì œí•˜ë ¤ëŠ” í•™ê³¼ ë²ˆí˜¸ê°€ ì €ì¥ëœ student í´ë˜ìŠ¤ì˜ ê°ì²´
     * @return - ì‚­ì œëœ ë°ì´í„°ì˜ ìˆ˜
     */
    @Delete("DELETE FROM enrollments WHERE student_id IN (" +
            "   SELECT id FROM students " +
            "   WHERE department_id=#{departmentId} OR " +
            "         professor_id IN (" +
            "           SELECT id FROM professors WHERE department_id=#{departmentId}" +
            "         )" +
            ") OR subject_id IN (" +
            "   SELECT id FROM subjects WHERE professor_id IN (" +
            "       SELECT id FROM professors WHERE department_id=#{departmentId}" +
            "   )"+
            ")")
    public int deleteByStudentId(Student input);
}
```

- professor mapper
```java
@Mapper
public interface ProfessorMapper {

    /**
     *  íŠ¹ì • í•™ê³¼ì— ì†Œì† ë˜ì–´ ìˆëŠ” êµìˆ˜ ì¼ê´„ ì‚­ì œ
     * @param input - í•™ê³¼ ë²ˆí˜¸ë¥¼ ì €ì¥í•˜ê³  ìˆëŠ” Professor ê°ì²´
     * @return - ì‚­ì œëœ ë°ì´í„° ìˆ˜
     */
    @Delete("DELETE FROM professors WHERE department_id = #{departmentId}")
    public int deleteByDepartmentId(Professor input);
} 
```

- student mapper
```java
@Mapper
public interface StudentMapper {

    /**
     *  íŠ¹ì • í•™ê³¼ì— ì†Œì†ë˜ì–´ ìˆê±°ë‚˜ íŠ¹ì • í•™ê³¼ì— ì†Œì†ëœ êµìˆ˜ì˜ ì§€ë„ í•™ìƒì¸ í•™ìƒì„ ì‚­ì œ
     * @param input - í•™ê³¼ ë²ˆí˜¸ë¥¼ ì €ì¥í•˜ê³  ìˆëŠ” student ê°ì²´
     * @return - ì‚­ì œëœ ë°ì´í„°ì˜ ìˆ˜
     */
    @Delete("DELETE FROM students WHERE department_id = #{departmentId} OR "
    + "PROFESSOR_ID IN (SELECT ID FROM PROFESSORS WHERE department_id = #{departmentId})")
    public int deleteByDepartmentId(Student input);
}
```

- subject mapper
```java
@Mapper
public interface SubjectMapper {

    /**
     * íŠ¹ì • í•™ê³¼ì—ì„œ ê°œì„¤ëœ ê³¼ëª©ì´ê±°ë‚˜, íŠ¹ì •í•™ê³¼ì— ì†Œì†ëœ êµìˆ˜ê°€ ë‹´ë‹¹í•˜ëŠ” 'ê³¼ëª© ì¼ê´„ ì‚­ì œ'
     * @param subject - í•™ê³¼ ë²ˆí˜¸ë¥¼ ì €ì¥í•˜ê³  ìˆëŠ” subject ê°ì²´ 
     * @return - ì‚­ì œëœ ë°ì´í„°ì˜ ìˆ˜
     */
    @Delete ("DELETE FROM subjects WHERE department_id = #{departmentId} OR professor_id IN "
    + " (SELECT id FROM professors WHERE department_id = #{departmentId})")
    public int deleteByProfessorId(Subject subject);
    }
```

# ğŸ“Œ 2. enrollments mapper -> ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ êµ¬í˜„í•´ë³´ê¸°
### ğŸ“Œ 2-1. enrollmentMapper
- mapperì—ì„œ selectì—ëŠ” ì§„ì§œ dbì— ì €ì¥ëœ ì—´ ì´ë¦„ì„ ë„£ê³  ëŒ€ì…í•  ê³³ì—ëŠ” ê°ì²´ì˜ ë©¤ë²„ë³€ìˆ˜ ëª…ì„ ë„£ëŠ” ê²ƒì„ì„ ìŠìœ¼ë©´ ì•ˆëœë‹¤. -> ê¼¼ê¼¼íˆ í•˜ê¸°
- ì—…ë°ì´íŠ¸í• ë•Œ WHEREë¡œ PRIMARY í‚¤ ì„¤ì •í•˜ê³  ë°”ê¿€ ê°’ì€ SETì—ì„œ ë°”ê¿ˆ. SETì— PRIMARY KEY ì„¤ì • ã„´ã„´
- ë³µí•©í‚¤ì¸ ê²½ìš°ì—ëŠ” insertì˜ optionsê°€ í•„ìš”ê°€ ì—†ë‹¤. í‚¤ë¥¼ 2ê°œ ì§€ì •í•  ìˆ˜ë„ ì—†ë‹¤. ê·¸ë˜ì„œ ë‹¤ì‹œ ë„£ì„ ê°ì²´ì— í‚¤ê°€ 2ê°œ ë¬´ì¡°ê±´ ì¡´ì¬í•˜ë„ë¡ ë³´ì¥í•˜ê±°ë‚˜ í‚¤ë¥¼ ì¤‘ê°„ì— getterë¡œ ë¹¼ì„œ ë”°ë¡œ ë³´ê´€í•´ë’€ë‹¤ê°€ ì‚¬ìš©í•´ì•¼í•œë‹¤.
```java
@Mapper
public interface EnrollmentMapper{

        /**
     *  íŠ¹ì • í•™ê³¼ì— ì†Œì†ëœ í•™ìƒ í˜¹ì€ íŠ¹ì • í•™ê³¼ì˜ êµìˆ˜ì—ê²Œ ì§€ë„ë¥¼ ë°›ëŠ” í•™ìƒ ì´ê±°ë‚˜ ìˆ˜ê°•ì‹ ì²­ ê³¼ëª©ì„ ê°€ë¥´ì¹˜ëŠ” êµìˆ˜ê°€ ì‚­ì œí•˜ë ¤ëŠ” í•™ê³¼ êµìˆ˜ì˜€ë˜ ê²½ìš° ì‹ ì²­í•œ ìˆ˜ê°• ë‚´ì—­ì„ ì‚­ì œ
     * @param input - ì‚­ì œí•˜ë ¤ëŠ” í•™ê³¼ ë²ˆí˜¸ê°€ ì €ì¥ëœ student í´ë˜ìŠ¤ì˜ ê°ì²´
     * @return - ì‚­ì œëœ ë°ì´í„°ì˜ ìˆ˜
     */
        @Delete("DELETE FROM enrollments WHERE student_id IN (" +
                "   SELECT id FROM students " +
                "   WHERE department_id=#{departmentId} OR " +
                "         professor_id IN (" +
                "           SELECT id FROM professors WHERE department_id=#{departmentId}" +
                "         )" +
                ") OR subject_id IN (" +
                "   SELECT id FROM subjects WHERE professor_id IN (" +
                "       SELECT id FROM professors WHERE department_id=#{departmentId}" +
                "   )"+
                ")")
        public int deleteByStudentId(Student input);

        /**
     *  ëª¨ë“  ëª©ë¡ ì¡°íšŒ
     * @param enrollment - null
     * @return - ëª¨ë“  ìˆ˜ê°•ì‹ ì²­ ëª©ë¡
     */
        @Select("select student_id, subject_id, enroll_date, score from enrollments")
        public List<Enrollment> selectList (Enrollment enrollment);

        /**
     *  íŠ¹ì • í•™ìƒì˜ ëª¨ë“  ëª©ë¡ ì¡°íšŒ
     * @param enrollment - null
     * @return - ëª¨ë“  ìˆ˜ê°•ì‹ ì²­ ëª©ë¡
     */
        @Select("select student_id, subject_id, enroll_date, score from enrollments where student_id = #{id}")
        public List<Enrollment> selectListByOne (Student student);


        /**
        * ìƒì„¸ ì¡°íšŒ
        * @param enrollment - íŠ¹ì • ëª©ë¡ ì •ë³´
        * @return - ìˆ˜ê°•ì‹ ì²­ ëª©ë¡
        */
        @Select("select student_id, subject_id, enroll_date, score from enrollments where student_id = #{student_id} and subject_id = #{subjectId}")
        public Enrollment selectOne (Enrollment enrollment);

        /**
        * ìˆ˜ê°•ì‹ ì²­ ë‚´ì—­ ë“±ë¡í•˜ê¸°
        * @param enrollment - ìˆ˜ê°•ì‹ ì²­ ë‚´ì—­ì˜ ì •ë³´
        * @return - ì¶”ê°€ëœ ë‚´ì—­ì˜ ê±´ìˆ˜
        */
        @Insert("INSERT INTO enrollments (student_id, subject_id, enroll_date, score) VALUES (#{student_id}, #{subjectId}, #{enrollDate}, #{score})")
        public int insert (Enrollment enrollment);


        /**
      * ìˆ˜ê°•ì‹ ì²­ ë‚´ì—­ ì •ë³´ë¥¼ ìˆ˜ì •í•œë‹¤.
      * 
      * @param input - ìˆ˜ì •í•  ë°ì´í„°ì— ëŒ€í•œ ì •ë³´ë¥¼ ë‹´ê³  ìˆëŠ” ê°ì²´
      * @return ìˆ˜ì •ëœ ë°ì´í„°ì˜ ê±´ìˆ˜
      */
        @Update("UPDATE enrollments SET " +
                "enroll_date=#{enrollDate}, score=#{score} "
                + "where student_id=#{student_id} AND subject_id=#{subjectId}")
        public int update(Enrollment enrollment);

        /**
      * ìˆ˜ê°•ì‹ ì²­ ë‚´ì—­ ì •ë³´ë¥¼ ì‚­ì œí•œë‹¤.
      * 
      * @param input - ì‚­ì œí•  ëŒ€ìƒì˜ ì •ë³´ë¥¼ ë‹´ê³  ìˆëŠ” ê°ì²´
      * @return ì‚­ì œëœ ë°ì´í„°ì˜ ê±´ìˆ˜
      */
        @Delete("DELETE FROM enrollments WHERE student_id = #{student_id} and subject_id = #{subjectId}")
        public int delete(Enrollment enrollment);

        /**
      * í•œ í•™ìƒì˜ìˆ˜ê°•ì‹ ì²­ ë‚´ì—­ ì •ë³´ë¥¼ ì‚­ì œí•œë‹¤.
      * 
      * @param input - ì‚­ì œí•  í•œ í•™ìƒì˜ ì •ë³´ë¥¼ ë‹´ê³  ìˆëŠ” ê°ì²´
      * @return ì‚­ì œëœ ë°ì´í„°ì˜ ê±´ìˆ˜
      */
        @Delete("DELETE FROM enrollments WHERE student_id = #{id}")
        public int deleteByOne(Student student);


}
```

### ğŸ“Œ 2-2. EnrollmentService ì¸í„°í˜ì´ìŠ¤
- íŠ¹ì • ë©”ì„œë“œëŠ” í•™ìƒì •ë³´ë§Œ ë°›ì•„ì„œ enrollment í…Œì´ë¸”ì˜ ì •ë³´ì— ê°œì…í•œë‹¤.
```java
public interface EnrollmentService {
    /**
     * <ëª¨ë“  í•™ìƒì˜ ìˆ˜ê°• ë‚´ì—­ì˜ ëª©ë¡ì„ ì¡°íšŒ>
     * 
     * @param input - ì¡°íšŒí•  ìˆ˜ê°• ë‚´ì—­ì˜ ê²€ìƒ‰ì–´ë¥¼ ë‹´ê³ ìˆëŠ” beans
     * @return - ì¡°íšŒëœ ë°ì´í„°
     * @throws ServiceNoResultException - ì¡°íšŒëœ ë°ì´í„°ê°€ ì—†ëŠ” ê²½ìš°
     * @throws Exception - sql ì²˜ë¦¬ì— ì‹¤íŒ¨í•œ ê²½ìš° (í”„ë¡œê·¸ë¨ì ì¸ ì—ëŸ¬)
     */
    public List<Enrollment> getList(Enrollment enrollment) throws ServiceNoResultException, Exception;

    /**
     * <íŠ¹ì • í•™ìƒì´ ì‹ ì²­í•œ ëª¨ë“  ìˆ˜ê°• ë‚´ì—­ì˜ ëª©ë¡ì„ ì¡°íšŒ>
     * 
     * @param input - ì¡°íšŒí•  ìˆ˜ê°• ë‚´ì—­ì˜ ê²€ìƒ‰ì–´ë¥¼ ë‹´ê³ ìˆëŠ” beans
     * @return - ì¡°íšŒëœ ë°ì´í„°
     * @throws ServiceNoResultException - ì¡°íšŒëœ ë°ì´í„°ê°€ ì—†ëŠ” ê²½ìš°
     * @throws Exception - sql ì²˜ë¦¬ì— ì‹¤íŒ¨í•œ ê²½ìš° (í”„ë¡œê·¸ë¨ì ì¸ ì—ëŸ¬)
     */
    public List<Enrollment> getListByStudentId(Student student) throws ServiceNoResultException, Exception;

    /**
     * <ìˆ˜ê°• ë‚´ì—­ì˜ ìƒì„¸ì •ë³´ë¥¼ ì¡°íšŒ>
     * 
     * @param input - ì¡°íšŒí•  ìˆ˜ê°• ë‚´ì—­ì˜ ì¼ë ¨ë²ˆí˜¸ë¥¼ ë‹´ê³ ìˆëŠ” beans 
     * @return - ì¡°íšŒëœ ë°ì´í„°
     * @throws ServiceNoResultException - ì¡°íšŒëœ ë°ì´í„°ê°€ ì—†ëŠ” ê²½ìš°
     * @throws Exception - sqlì²˜ë¦¬ì— ì‹¤íŒ¨í•œ ê²½ìš°
     */
    public Enrollment getItem(Enrollment enrollment) throws ServiceNoResultException, Exception;

    /**
     * <ìˆ˜ê°• ë‚´ì—­ ë°ì´í„°ë¥¼ ì¶”ê°€í•˜ê³  ì €ì¥ëœ ì •ë³´ë¥¼ ë°”ë¡œ ë¦¬í„´í•˜ì—¬ í™•ì¸ì‹œí‚´>
     * 
     * @param input - ì €ì¥í•  ì •ë³´ë¥¼ ë‹´ê³ ìˆëŠ” beans
     * @return - ì¡°íšŒëœ ë°ì´í„°
     * @throws ServiceNoResultException - ì €ì¥ëœ ë°ì´í„°ê°€ ì—†ëŠ”ê²½ìš°
     * @throws Exception - sql ì²˜ë¦¬ì— ì‹¤íŒ¨í•œ ê²½ìš° (í”„ë¡œê·¸ë¨ì ì¸ ì—ëŸ¬)
     */
    public Enrollment addItem(Enrollment enrollment) throws ServiceNoResultException, Exception;

    /**
     * <ìˆ˜ê°• ë‚´ì—­ ì •ë³´ë¥¼ ìˆ˜ì •í•˜ê³  ìˆ˜ì •í•œ ë‚´ì—­ì„ ë¦¬í„´í•œë‹¤.>
     * 
     * @param input - ìˆ˜ì •í•  ì •ë³´ë¥¼ ë‹´ê³  ìˆëŠ” beans
     * @return - ìˆ˜ì •ëœ ë°ì´í„°
     * @throws ServiceNoResultException - ìˆ˜ì •ëœ ë°ì´í„°ê°€ ì—†ëŠ” ê²½ìš°
     * @throws Exception  - sqlë¬¸ì´ ì²˜ë¦¬ë˜ì§€ ì•Šì•˜ì„ ê²½ìš°
     */
    public Enrollment editItem(Enrollment enrollment) throws ServiceNoResultException, Exception;

    /**
     * <ìˆ˜ê°• ë‚´ì—­ ì •ë³´ë¥¼ ì‚­ì œí•œë‹¤.>
     * 
     * @param input - ì‚­ì œí•  ì •ë³´ê°€ ë‹´ê²¨ìˆëŠ” beans
     * @return - ì‚­ì œí•œ ì •ë³´ì˜ ìˆ˜
     * @throws ServiceNoResultException - ì‚­ì œëœ ë°ì´í„°ê°€ ì—†ëŠ” ê²½ìš°
     * @throws Exception - sqlë¬¸ì´ ì •ìƒ ì²˜ë¦¬ë˜ì§€ ì•Šì€ ê²½ìš°
     */
    public int deleteItem(Enrollment enrollment) throws ServiceNoResultException, Exception;

    /**
     * <íŠ¹ì • í•™ìƒì´ ì‹ ì²­í•œ ëª¨ë“  ìˆ˜ê°• ë‚´ì—­ ì •ë³´ë¥¼ ì‚­ì œí•œë‹¤.>
     * 
     * @param input - ì‚­ì œí•  ì •ë³´ê°€ ë‹´ê²¨ìˆëŠ” beans
     * @return - ì‚­ì œí•œ ì •ë³´ì˜ ìˆ˜
     * @throws ServiceNoResultException - ì‚­ì œëœ ë°ì´í„°ê°€ ì—†ëŠ” ê²½ìš°
     * @throws Exception - sqlë¬¸ì´ ì •ìƒ ì²˜ë¦¬ë˜ì§€ ì•Šì€ ê²½ìš°
     */
    public int deleteItemByStudentId (Student student) throws ServiceNoResultException, Exception;
} 
```

### ğŸ“Œ 2-3. EnrollmentService ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„ì²´
- ë‹¨ì¼ í–‰ ì¡°íšŒëŠ” ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê°’ì…ë‹ˆë‹¤ ë¼ê³  ì˜ˆì™¸ì²˜ë¦¬ ê¼­ í•´ì£¼ëŠ” ê±° ìŠì§€ ë§ê¸°
- ì‚½ì…ê³¼ ìˆ˜ì •ì€ ë°ì´í„°ë¥¼ ìˆ˜ì •í•œ í›„ì— ìˆ˜ì •í• ë•Œ ì¸ìë¡œ ë„£ì—ˆë˜ ê°ì²´ì— ì €ì¥ëœ primary keyë¥¼ ì´ìš©í•˜ì—¬ ë‹¤ì‹œ ê°’ì„ ì¡°íšŒí•˜ëŠ” ê³¼ì •ê¹Œì§€ ê±°ì³ì¤€ë‹¤.
- ì´ë•Œ ìˆ˜ì •, ì‚½ì…ì˜ ë°˜í™˜ê°’ì€ ìˆ˜ì •ëœ ê°’ì´ ì—†ë‹¤ëŠ” ì˜¤ë¥˜ë¥¼ ë„ì¶œí•˜ëŠ” ê¸°ì¤€ì´ ë˜ê³  ì¡°íšŒëœ ê°’ì€ ë¦¬í„´ê°’ì´ ëœë‹¤.
- ì´ë²ˆ ì¼€ì´ìŠ¤ì—ëŠ” primary keyê°€ 2ê°œ ì—¬ì„œ optionìœ¼ë¡œ ë‹¤ì‹œ ë°›ì„ ìˆ˜ ì—†ì§€ë§Œ ì •ì±… ìƒ ê°ì²´ì— í•´ë‹¹ ê°’ë“¤ì„ ê¼­ í¬í•¨ì‹œì¼°ê³  ê°™ì€ ê°ì²´ì— ì´ë¯¸ ì´ 2 ê°’ì´ ë“¤ì–´ìˆìœ¼ë¯€ë¡œ ë”°ë¡œ ë³´ì¡´í•˜ì§€ ì•Šì•„ë„ ì§„í–‰ë˜ì—ˆë‹¤.
- í•˜ì§€ë§Œ ê°•ì œí•˜ê±°ë‚˜ ë³´ì¡´í•˜ëŠ” ì •ì±…ì„ ë”°ë¡œ ì„¸ìš´ê²Œ ì•„ë‹ˆë¼ ì´ ë¶€ë¶„ì€ ë³´ì™„í•´ì•¼ í•  ê²ƒ ê°™ë‹¤.
```java
public class EnrollmentServiceImpl implements EnrollmentService{ // mapper ë°˜í™˜ ëŒ€í–‰
    private DepartmentMapper mapper; 
    private EnrollmentMapper enrollmentMapper;
    private ProfessorMapper professorMapper;
    private StudentMapper studentMapper;
    private SubjectMapper subjectMapper;

    public EnrollmentServiceImpl (SqlSession sqlSession){  
        this.mapper = sqlSession.getMapper(DepartmentMapper.class); 
        this.enrollmentMapper = sqlSession.getMapper(EnrollmentMapper.class);
        this.professorMapper = sqlSession.getMapper(ProfessorMapper.class);
        this.studentMapper = sqlSession.getMapper(StudentMapper.class);
        this.subjectMapper = sqlSession.getMapper(SubjectMapper.class);
    }

    @Override
    public List<Enrollment> getList(Enrollment enrollment) throws ServiceNoResultException, Exception {
        List<Enrollment> output = null;
        output = enrollmentMapper.selectList(enrollment);
        return output;
    }

    @Override
    public List<Enrollment> getListByStudentId(Student student) throws ServiceNoResultException, Exception {
        List<Enrollment> output = null;
        output = enrollmentMapper.selectListByOne(student);
        return output;
    }

    @Override
    public Enrollment getItem(Enrollment enrollment) throws ServiceNoResultException, Exception {
        Enrollment output = null;
        output = enrollmentMapper.selectOne(enrollment);

        if (output == null){ // ë‹¨ì¼í–‰ ì¡°íšŒëŠ” ê°’ì´ ì—†ëŠ” ê²ƒì„ ë”°ë¡œ ì—ëŸ¬ë¡œ ì²˜ë¦¬í•´ ì£¼ì–´ì•¼ í•œë‹¤.
            throw new ServiceNoResultException("ì¡°íšŒê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.");
        }
        return output;
    }

    @Override
    public Enrollment addItem(Enrollment enrollment) throws ServiceNoResultException, Exception {
        Enrollment output = null;

        int row = enrollmentMapper.insert(enrollment);

        if (row == 0){
            throw new ServiceNoResultException("ì €ì¥ëœ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.");
        }

        output = enrollmentMapper.selectOne(enrollment);

        return output;
    }

    @Override
    public Enrollment editItem(Enrollment enrollment) throws ServiceNoResultException, Exception {
        Enrollment output = null;

        int row = enrollmentMapper.update(enrollment);

        if (row == 0){
            throw new ServiceNoResultException("ì €ì¥ëœ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.");
        }

        output = enrollmentMapper.selectOne(enrollment);

        return output;
    }

    @Override
    public int deleteItem(Enrollment enrollment) throws ServiceNoResultException, Exception {
        int output = enrollmentMapper.delete(enrollment);

        if (output == 0) {
            throw new ServiceNoResultException("ì‚­ì œëœ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.");
        }

        return output;
    }

    @Override
    public int deleteItemByStudentId(Student student) throws ServiceNoResultException, Exception {
        int output = enrollmentMapper.deleteByOne(student);

        if (output == 0) {
            throw new ServiceNoResultException("ì‚­ì œëœ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.");
        }

        return output;
    }
}
```

### ğŸ“Œ 2-4. enrollment ê¸°ëŠ¥ ì‹œí—˜
- openëœ ì„¸ì…˜ì„ enrollmentserviceì™€ ì—°ê²°í•´ì¤€ë‹¤.
- í”„ë¡œê·¸ë¨ì  ì˜ˆì™¸(Exception)ëŠ” ì»´íŒŒì¼ ë‹¹ì‹œ ë°”ë¡œ í™•ì¸í•  ìˆ˜ ì—†ëŠ” ë¬¸ìì—´ë¡œ ì‘ì„±ëœ sql ì—ëŸ¬ê°€ 99%ë‹¤.
- ì„œë¹„ìŠ¤ìƒ ë°œìƒí•˜ëŠ” ì—ëŸ¬ëŠ” where ì ˆì— ì¡°ê±´ì„ ì˜ëª»ì¤¬ì„ ë•Œì— ëŒ€ë¶€ë¶„ í•´ë‹¹í•œë‹¤.
- ê°ì²´ëŠ” toStringìœ¼ë¡œ ì‹œê°í™”í•œë‹¤.

### ğŸ“Œ# 1. ëª¨ë“  í•™ìƒì˜ ìˆ˜ê°•ì‹ ì²­ ëª©ë¡ ì¡°íšŒ
```java
@Slf4j
public class Appproblem1get {

    public static void main(String[] args) {
        SqlSession openSqlSession = MyBatisConnectionFactory.getSqlSession(); // ì„¸ì…˜ ì˜¤í”ˆ
        EnrollmentService enrollmentService = new EnrollmentServiceImpl(openSqlSession); // mapper í”„ë¡ì‹œ ì „ë¶€ ìƒì„±, ë©”ì„œë“œ ì¤€ë¹„

    // 1. ëª¨ë“  í•™ìƒì˜ ìˆ˜ê°•ì‹ ì²­ ëª©ë¡ ì¡°íšŒ
    List <Enrollment> output = null;

    try {
        output = enrollmentService.getList(null);
    } catch (ServiceNoResultException e) {
        log.error("ì²˜ë¦¬ëœ ë°ì´í„° ì—†ìŒ >> whereì ˆì„ í™•ì¸í•˜ì„¸ìš”", e);
    } catch (Exception e) {
        log.error("ë°ì´í„° ì²˜ë¦¬ ì‹¤íŒ¨ >> sqlë¬¸ì„ í™•ì¸í•˜ì„¸ìš”", e);
    }

    if (output != null){
        log.debug("ì¡°íšŒê²°ê³¼ ---> " + output.toString());
    }
    openSqlSession.close();
    }
}
```

### ğŸ“Œ# 2. í•œ í•™ìƒì˜ ìˆ˜ê°•ì‹ ì²­ ëª©ë¡ ì¡°íšŒ
```java
@Slf4j
public class Appproblem2getby {

    public static void main(String[] args) {
        SqlSession openSqlSession = MyBatisConnectionFactory.getSqlSession(); // ì„¸ì…˜ ì˜¤í”ˆ
    EnrollmentService enrollmentService = new EnrollmentServiceImpl(openSqlSession); // mapper í”„ë¡ì‹œ ì „ë¶€ ìƒì„±, ë©”ì„œë“œ ì¤€ë¹„

    // 2. í•œ í•™ìƒì˜ ìˆ˜ê°•ì‹ ì²­ ëª©ë¡ ì¡°íšŒ
    List <Enrollment> output = null;
    Student student = new Student();
    student.setId(10102);

    try {
        output = enrollmentService.getListByStudentId(student);
    } catch (ServiceNoResultException e) {
        log.error("ì²˜ë¦¬ëœ ë°ì´í„° ì—†ìŒ >> whereì ˆì„ í™•ì¸í•˜ì„¸ìš”", e);
    } catch (Exception e) {
        log.error("ë°ì´í„° ì²˜ë¦¬ ì‹¤íŒ¨ >> sqlë¬¸ì„ í™•ì¸í•˜ì„¸ìš”", e);
    }

    if (output != null){
        log.debug("ì¡°íšŒê²°ê³¼ ---> " + output.toString());
    }
    openSqlSession.close();
    }
    
}
```

### ğŸ“Œ# 3. íŠ¹ì • í•™ìƒ, íŠ¹ì • í•™ê³¼ì˜ ìˆ˜ê°•ì‹ ì²­ ëª©ë¡ ì¡°íšŒ
```java
@Slf4j
public class Appproblem3 {

    public static void main(String[] args) {
        SqlSession openSqlSession = MyBatisConnectionFactory.getSqlSession(); // ì„¸ì…˜ ì˜¤í”ˆ
    EnrollmentService enrollmentService = new EnrollmentServiceImpl(openSqlSession); // mapper í”„ë¡ì‹œ ì „ë¶€ ìƒì„±, ë©”ì„œë“œ ì¤€ë¹„

    // 3. íŠ¹ì • í•™ìƒ, íŠ¹ì • í•™ê³¼ì˜ ìˆ˜ê°•ì‹ ì²­ ëª©ë¡ ì¡°íšŒ
    Enrollment output = null;
    Enrollment enrollment = new Enrollment();
    enrollment.setStudent_id(10102);
    enrollment.setSubjectId(1005);
    

    try {
        output = enrollmentService.getItem(enrollment);
    } catch (ServiceNoResultException e) {
        log.error("ì²˜ë¦¬ëœ ë°ì´í„° ì—†ìŒ >> whereì ˆì„ í™•ì¸í•˜ì„¸ìš”", e);
    } catch (Exception e) {
        log.error("ë°ì´í„° ì²˜ë¦¬ ì‹¤íŒ¨ >> sqlë¬¸ì„ í™•ì¸í•˜ì„¸ìš”", e);
    }

    if (output != null){
        log.debug("ì¡°íšŒê²°ê³¼ ---> " + output.toString());
    }
    openSqlSession.close();
    }
}
```

### ğŸ“Œ# 4. ìƒˆë¡œìš´ ìˆ˜ê°•ì‹ ì²­ ëª©ë¡ ìƒì„± 
- ì§ì ‘ì ìœ¼ë¡œ ë°ì´í„° ë² ì´ìŠ¤ë¥¼ ê±´ë“œë¦¬ë©´ ë‚˜ì¤‘ì— ê¼­ commitì„ í•´ì„œ íŠ¸ëœì ì…˜ì„ ì‹¤í–‰í•´ì•¼í•œë‹¤.
```java
@Slf4j
public class Appproblem4 {

    public static void main(String[] args) {
        SqlSession openSqlSession = MyBatisConnectionFactory.getSqlSession(); // ì„¸ì…˜ ì˜¤í”ˆ
    EnrollmentService enrollmentService = new EnrollmentServiceImpl(openSqlSession); // mapper í”„ë¡ì‹œ ì „ë¶€ ìƒì„±, ë©”ì„œë“œ ì¤€ë¹„

    // 4. ìƒˆë¡œìš´ ìˆ˜ê°•ì‹ ì²­ ëª©ë¡ ìƒì„±
    Enrollment output = null;
    Enrollment enrollment = new Enrollment();
    enrollment.setStudent_id(10104  );
    enrollment.setSubjectId(1005);
    enrollment.setEnrollDate("2025-04-22");
    enrollment.setScore(90);
    

    try {
        output = enrollmentService.addItem(enrollment);
    } catch (ServiceNoResultException e) {
        log.error("ì²˜ë¦¬ëœ ë°ì´í„° ì—†ìŒ >> whereì ˆì„ í™•ì¸í•˜ì„¸ìš”", e);
        openSqlSession.rollback();
    } catch (Exception e) {
        log.error("ë°ì´í„° ì²˜ë¦¬ ì‹¤íŒ¨ >> sqlë¬¸ì„ í™•ì¸í•˜ì„¸ìš”", e);
        openSqlSession.rollback();
    }

    if (output != null ){
        log.debug("ìˆ˜ì •ê²°ê³¼ ---> " + output.toString());
    }

    openSqlSession.commit();
    openSqlSession.close();
    }
}
```

### ğŸ“Œ# 5. ìˆ˜ê°•ì‹ ì²­ ëª©ë¡ ìˆ˜ì •
```java
@Slf4j
public class Appproblem5 {

    public static void main(String[] args) {
        SqlSession openSqlSession = MyBatisConnectionFactory.getSqlSession(); // ì„¸ì…˜ ì˜¤í”ˆ
    EnrollmentService enrollmentService = new EnrollmentServiceImpl(openSqlSession); // mapper í”„ë¡ì‹œ ì „ë¶€ ìƒì„±, ë©”ì„œë“œ ì¤€ë¹„

    // 5. ìˆ˜ê°•ì‹ ì²­ ëª©ë¡ ìˆ˜ì •
    Enrollment output = null;
    Enrollment enrollment = new Enrollment();
    enrollment.setStudent_id(10104);
    enrollment.setSubjectId(1005);
    enrollment.setEnrollDate("2024-04-12");
    enrollment.setScore(60);
    

    try {
        output = enrollmentService.editItem(enrollment);
    } catch (ServiceNoResultException e) {
        log.error("ì²˜ë¦¬ëœ ë°ì´í„° ì—†ìŒ >> whereì ˆì„ í™•ì¸í•˜ì„¸ìš”", e);
        openSqlSession.rollback();
    } catch (Exception e) {
        log.error("ë°ì´í„° ì²˜ë¦¬ ì‹¤íŒ¨ >> sqlë¬¸ì„ í™•ì¸í•˜ì„¸ìš”", e);
        openSqlSession.rollback();
    }

    if (output != null ){
        log.debug("ìˆ˜ì •ê²°ê³¼ ---> " + output.toString());
    }

    openSqlSession.commit();
    openSqlSession.close();
    }
}
```

### ğŸ“Œ# 6. íŠ¹ì • í•™ìƒì— ëŒ€í•œ ëª©ë¡ ì‚­ì œ
- ë§ˆì§€ë§‰ í•˜ë‚˜ëŠ” ë‚ ì•„ê°”ëŠ”ë° ì–´ì§œí”¼ ì´ê²ƒê³¼ ë¹„ìŠ·í•˜ë‹¤.
```java
@Slf4j
public class Appproblem56 {

    public static void main(String[] args) {
        SqlSession openSqlSession = MyBatisConnectionFactory.getSqlSession(); // ì„¸ì…˜ ì˜¤í”ˆ
    EnrollmentService enrollmentService = new EnrollmentServiceImpl(openSqlSession); // mapper í”„ë¡ì‹œ ì „ë¶€ ìƒì„±, ë©”ì„œë“œ ì¤€ë¹„

    // 6. íŠ¹ì • í•™ìƒì— ëŒ€í•œ ëª©ë¡ ì‚­ì œ
    int output = 0;
    Student student = new Student();
    student.setId(10102);
    

    

    try {
        output = enrollmentService.deleteItemByStudentId(student);
    } catch (ServiceNoResultException e) {
        log.error("ì²˜ë¦¬ëœ ë°ì´í„° ì—†ìŒ >> whereì ˆì„ í™•ì¸í•˜ì„¸ìš”", e);
        openSqlSession.rollback();
    } catch (Exception e) {
        log.error("ë°ì´í„° ì²˜ë¦¬ ì‹¤íŒ¨ >> sqlë¬¸ì„ í™•ì¸í•˜ì„¸ìš”", e);
        openSqlSession.rollback();
    }

    log.debug("ì‚­ì œëœ ë°ì´í„° ìˆ˜ ---> " + output);

    openSqlSession.commit();
    openSqlSession.close();
    }
}
```













