# 1. ë‹¤ì´ë‚˜ë¯¹ sql ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ì ì…ë ¥ ë°›ê¸°
- ì‚¬ìš©ìì—ê²Œ ì…ë ¥ì„ ë°›ì„ ë•Œ nullì´ë‚˜ ë¹ˆ ë¬¸ìì—´ì´ ë°œìƒí•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì´ë¥¼ ìœ„í•œ ì˜ˆì™¸ì²˜ë¦¬ë¥¼ í•´ì¤€ë‹¤.

### 1-1. mapper ìˆ˜ì •
- ì•„ë˜ <>ì˜ íƒœê·¸ëŠ” xml íƒœê·¸ì²˜ëŸ¼ ë³´ì´ì§€ë§Œ mybatisì˜ ì „ìš© íƒœê·¸ì´ë‹¤.
- ë‹¤ì´ë‚˜ë¯¹ sqlì—ì„œ and ì—°ì‚° ê°™ì€ ê²ƒì€ ìƒí™©ì— ë”°ë¼ì„œ êµ¬ë¬¸ì´ ì•ˆë§ìœ¼ë©´ mybatisê°€ ì‚­ì œí•´ì¤€ë‹¤.

| íƒœê·¸ | ì„¤ëª… | ì‚¬ìš© ì˜ˆì‹œ |
|------|------|-----------|
| `<script>` | ë™ì  SQLì„ ì–´ë…¸í…Œì´ì…˜ì—ì„œ ì‚¬ìš©í•  ë•ŒëŠ” ë°˜ë“œì‹œ `<script>`ë¡œ ê°ì‹¸ì•¼ í•¨ | `@Select("<script> ... </script>")` |
| `<if test="ì¡°ê±´">` | ì¡°ê±´ì— ë”°ë¼ SQL ë¬¸ì¥ì„ ì¶”ê°€ | `<if test="name != null">AND name = #{name}</if>` |
| `<where>` | ë‚´ë¶€ì— ì¡°ê±´ë¬¸ì´ í•˜ë‚˜ë¼ë„ ìˆìœ¼ë©´ ìë™ìœ¼ë¡œ `WHERE` í‚¤ì›Œë“œ ì¶”ê°€. AND/OR ìë™ ì²˜ë¦¬ | `<where> <if test="...">...</if> </where>` |
| `<set>` | `UPDATE`ë¬¸ì—ì„œ SET êµ¬ë¬¸ì„ ìë™ ì •ë¦¬ (ì‰¼í‘œ ì œê±° ë“±) | `<set> <if test="...">col = #{val},</if> </set>` |
| `<choose>` | Javaì˜ `switch`ì²˜ëŸ¼ ì—¬ëŸ¬ ì¡°ê±´ ì¤‘ í•˜ë‚˜ë§Œ ì ìš© | `<choose> <when test="...">...</when> <otherwise>...</otherwise> </choose>` |
| `<foreach>` | ë¦¬ìŠ¤íŠ¸ë‚˜ ë°°ì—´ ë“±ì„ ë°˜ë³µí•˜ì—¬ SQL ì¡°ê° ìƒì„± (`IN`ì ˆ ë“±ì—ì„œ ì‚¬ìš©) | `<foreach collection="ids" item="id" separator="," open="(" close=")">#{id}</foreach>` |
| `<trim>` | ì•ë’¤ ë¶ˆí•„ìš”í•œ êµ¬ë¬¸ ì œê±°, prefix/suffix ì œì–´ | `<trim prefix="WHERE" prefixOverrides="AND|OR">...</trim>` |

#### ğŸ”¥ ì£¼ì˜í•  ì 
- `<script>` ì•ˆì—ì„œëŠ” ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬ ì£¼ì˜  
  - ìë°” ë¬¸ìì—´ ë‚´ `"` â†’ `\"`  
  - ìë°” ì½”ë“œìƒì—ì„œëŠ” `\\\"`ì²˜ëŸ¼ ì´ì¤‘ ì´ìŠ¤ì¼€ì´í”„
- XMLê³¼ ë‹¤ë¥´ê²Œ ìë°” ì–´ë…¸í…Œì´ì…˜ì—ì„œëŠ” `"`, `\` ë¬¸ë²• ì£¼ì˜ê°€ ë” í•„ìš”í•¨

```java
/**
      * ë¶€ì„œ ì •ë³´ ëª©ë¡ ì¡°íšŒ (ë‹¤ê±´)
      * 
      * @param input - ì‚¬ìš©ìì—ê²Œ ì…ë ¥ë°›ì€ ì¡°íšŒ ì¡°ê±´ì„ ë‹´ê³  ìˆëŠ” ê°ì²´
      * @return ì¡°íšŒëœ ë°ì´í„° ëª©ë¡
      */
    @Select("<script>" 
            + "select id, dname, loc, phone, email, established, homepage "
            + "from departments "
            + "<where>"
            + "<if test = \"dname != null and dname != '' \">dname like concat ('%', #{dname}, '%')</if>"
            + "<if test = \"loc != null and loc != '' \">and loc like concat ('%', #{loc}, '%')</if>"
            + "</where>"
            + "</script>"
        )
    public List<Department> selectList(Department input);
```
- ê²€ìƒ‰ ì¡°ê±´ì— ë”°ë¥¸ í–‰ì˜ ìˆ˜
```java
/**
      * ê²€ìƒ‰ ì¡°ê±´ì— ë”°ë¥¸ ë°ì´í„° ê¸°ë¡ ì¡°íšŒ
      * 
      * @param input - ì‚¬ìš©ìì—ê²Œ ì…ë ¥ë°›ì€ ì¡°íšŒ ì¡°ê±´ì„ ë‹´ê³  ìˆëŠ” ê°ì²´
      * @return ì¡°íšŒëœ ë°ì´í„°ì˜ ìˆ˜
      */
      @Select("<script>" 
      + "select count(*) "
      + "from departments "
      + "<where>"
      + "<if test = \"dname != null and dname != '' \">dname like concat ('%', #{dname}, '%')</if>"
      + "<if test = \"loc != null and loc != '' \">and loc like concat ('%', #{loc}, '%')</if>"
      + "</where>"
      + "</script>"
  )
    public int selectCount(Department input);
```

### 1-2. 1-1 ìˆ˜ì •ì— ë”°ë¥¸ ì„œë¹„ìŠ¤ ê³„ì¸µ ì¶”ê°€
- ì¸í„°í˜ì´ìŠ¤ ìˆ˜ì •
```java
/**
     * <í•™ê³¼ì˜ ëª©ë¡ì„ ì¡°íšŒ>
     * 
     * @param input - ì¡°íšŒí•  í•™ê³¼ì˜ ê²€ìƒ‰ì–´ë¥¼ ë‹´ê³ ìˆëŠ” beans
     * @return - int ê²€ìƒ‰ ì¡°ê±´ì— ë§ëŠ” ë°ì´í„°ì˜ ìˆ˜
     * @throws ServiceNoResultException - ì¡°íšŒëœ ë°ì´í„°ê°€ ì—†ëŠ” ê²½ìš°
     * @throws Exception - sql ì²˜ë¦¬ì— ì‹¤íŒ¨í•œ ê²½ìš° (í”„ë¡œê·¸ë¨ì ì¸ ì—ëŸ¬)
     */
    public int getCount(Department input) throws ServiceNoResultException, Exception;
```
- ì„œë¹„ìŠ¤ êµ¬í˜„ê°ì²´ ìˆ˜ì •
```java
@Override
    public int getCount(Department input) throws ServiceNoResultException, Exception {
        int output = 0;
        output = mapper.selectCount(input);
        return output;
    }
```

### 1-3. í”„ë ˆì  í…Œì´ì…˜ ê³„ì¸µì—ì„œ ì…ë ¥ ë°›ì•„ë³´ê¸°
- ì—ëŸ¬: ìš”ì†Œ ìœ í˜• "if"ê³¼(ì™€) ì—°ê´€ëœ "test" ì†ì„±ì—ëŠ” ì—¬ëŠ” ë”°ì˜´í‘œê°€ í•„ìš”í•©ë‹ˆë‹¤.
- ì›ì¸: <if test = \\\"loc != null and loc != '' \\\">loc like concat ('%', #{loc}, '%')</if> ì´ë ‡ê²Œ ///ë¥¼ ì—¬ëŸ¬ê°œ ì¨ë†¨ì—ˆë‹¤.
- ì—ëŸ¬: ìš”ì†Œ ì½˜í…ì¸ ëŠ” ì˜¬ë°”ë¥¸ í˜•ì‹ì˜ ë¬¸ì ë°ì´í„° ë˜ëŠ” ë§ˆí¬ì—…ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.
- ì›ì¸: </script> ë‹«ëŠ” íƒœê·¸ëŠ” ì •ë°©í–¥ ìŠ¬ë˜ì‹œë¡œ ì‘ì„±í•´ ì£¼ì–´ì•¼ í•œë‹¤.
- ì—ëŸ¬: sql ì—ëŸ¬
- where ì ˆ ì•ˆì˜ ë‘ ì¡°ê±´ì„ ì—°ê²°í•˜ëŠ”ë° andë¥¼ ë¹¼ë¨¹ì—ˆë‹¤.
```java
@Slf4j
public class App05 {
    public static void main(String[] args) {
        // mybatis ì„¤ì • íŒŒì¼ì˜ ë‚´ìš©ì„ ë¡œë“œí•˜ëŠ” ì ‘ì† ìƒˆì…˜ ìƒì„± ë° Mapperë¡œë“œ
        SqlSession sqlSession = MyBatisConnectionFactory.getSqlSession(); // ì‹±ê¸€í„´ ì„¸ì…˜ ê°ì²´ë¥¼ ë¦¬í„´í•˜ëŠ” ë©”ì„œë“œ í˜¸ì¶œ
        DepartmentMapper departmentMapper = sqlSession.getMapper(DepartmentMapper.class); // ì¸í„°í˜ì´ìŠ¤ë„ í´ë˜ìŠ¤ì˜ ì¼ì¢… í•˜ì—¬ ì´ì™€ ê°™ì€ ë°©ì‹ìœ¼ë¡œ í´ë˜ìŠ¤ ì •ë³´ë¥¼ ë„˜ê¸´ë‹¤.

        Department test = new Department();
        Scanner scanner = new Scanner(System.in);
        System.out.print("ê²€ìƒ‰í•  í•™ê³¼ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”: ");
        String dname = scanner.nextLine(); 
        test.setDname(dname);

        System.out.print("ê²€ìƒ‰í•  ê°•ì˜ì‹¤ ì¥ì†Œ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”: ");
        String loc = scanner.nextLine(); 
        test.setLoc(loc);

        
        // ì „ë¶€ ì¡°íšŒí•  ê²ƒì´ë¯€ë¡œ ê°ì²´ë¥¼ ë”°ë¡œ ì¤€ë¹„í•  í•„ìš”ê°€ ì—†ìŒ.

        // Mapperì— êµ¬í˜„ë˜ì–´ìˆëŠ” ë§¤ì„œë“œë¥¼ í˜¸ì¶œí•˜ì—¬ SQLë¬¸ì„ ì‹¤í–‰
        List <Department> output = departmentMapper.selectList(test); // mapperì— ì •ì˜ëœ deleteë¬¸ ì‚¬ìš©
        int count = departmentMapper.selectCount(test);

        // ê²°ê³¼ 
        log.debug("ì¡°íšŒê²°ê³¼ " + output.toString());
        log.debug("ì¡°íšŒëœ ê²°ê³¼ì˜ ìˆ˜ " + count + "ê°œ");

        // ë°ì´í„° ë² ì´ìŠ¤ ì ‘ì† í•´ì œ
        sqlSession.close(); // ì„¸ì…˜ì˜ ì—°ê²°ì„ ê¼­ ë‹«ì•„ì£¼ì–´ì•¼í•¨.
    }   
}
```

# 2. animail_ins í…Œì´ë¸” ë§Œë“¤ê¸°
### 2-1. animal_ins models
- datetimeì€ ì¼ë°˜ì ìœ¼ë¡œ localdatetimeìœ¼ë¡œ beansì—ì„œ ë°›ì•„ì£¼ëŠ” ê²ƒì´ ì¼ë°˜ì ì´ë‹¤.
```java
@Data
public class Animal_ins {
    private String animalId; // primary key
    private String animalType;
    private LocalDateTime dateTime;
    private String intakeCondition;
    private String name;
    private String sexUponIntake;
}
```

### 2-2. AnimalInsMapper
- ì•„ë˜ì²˜ëŸ¼ resultì™€ resultmapì„ ì´ìš©í•  ìˆ˜ ìˆëŠ”ë° ì´ëŠ” ìë™ë§¤í•‘ì´ ì•ˆë  ê²½ìš°ì— ì—´ì´ë¦„ê³¼ í•„ë“œê°’ì´ í™•ì‹¤íˆ ë§¤í•‘ë  ìˆ˜ ìˆë„ë¡ í•´ì£¼ëŠ” ì—­í• ì„ í•œë‹¤.
- ìë™ ë§¤í•‘ì€ ì»¬ëŸ¼ëª…ê³¼ ìë°” í•„ë“œëª…ì´ ì™„ì „íˆ ì¼ì¹˜í•˜ê±°ë‚˜ ì¹´ë©œì¼€ì´ìŠ¤ â†” ìŠ¤ë„¤ì´í¬ ì¼€ì´ìŠ¤ ìë™ ë³€í™˜ì´ ì¼œì ¸ ìˆì„ ë•Œ ì‘ë™í•œë‹¤.
```java
@Results(id = "animalMap", value = {
    @Result(column = "animal_id", property = "animalId"),
    @Result(column = "animal_type", property = "animalType"),
    @Result(column = "datetime", property = "dateTime"),
    @Result(column = "intake_condition", property = "intakeCondition"),
    @Result(column = "name", property = "name"),
    @Result(column = "sex_upon_intake", property = "sexUponIntake")
})
@Select("SELECT * FROM animal_ins")
List<Animal_ins> selectList(Animal_ins input);

@Select("SELECT * FROM animal_ins WHERE animal_id = #{animalId}")
@ResultMap("animalMap")
Animal_ins selectOne(Animal_ins input);
```
- sqlë¬¸ ì‘ì„±ì— ì¢€ ë” ì‹ ì¤‘ì„ ê¸°í•´ì•¼í•œë‹¤.
```java
@Mapper
public interface AnimalInsMapper {
    /**
     * <ëª¨ë“  í…Œì´ë¸”ì˜ ì •ë³´ë¥¼ ë¦¬ìŠ¤íŠ¸ë¡œ ë°›ìŒ>
     * @param input - Animal_ins ê°ì²´
     * @return - ì—´ ê°’ì´ ì €ì¥ëœ ë¦¬ìŠ¤íŠ¸ 
     */
    @Select (
            "select animal_id, animal_type, datetime, intake_condition, name, sex_upon_intake "
            + "from animal_ins"
    )
    public List<Animal_ins> selectList (Animal_ins input);


    /**
     * <ê³ ìœ í•œ ì•„ì´ë””ë¥¼ ì…ë ¥í•˜ì—¬ í•´ë‹¹ í–‰ì„ ì „ë‹¬ë°›ìŒ.>
     * @param input - ì•„ì´ë””ê°€ í¬í•¨ëœ Animal_ins ê°ì²´
     * @return - ì •ë³´ë¥¼ ë‹´ì€ Animal_ins ê°ì²´
     */
    @Select ( 
                "select animal_id, animal_type, datetime, intake_condition, name, sex_upon_intake "
                + "from animal_ins "
                + "where animal_id = #{animalId}"
    )
    public Animal_ins selectOne (Animal_ins input);


    /**
     * <ê°ì²´ë¥¼ ì´ìš©í•˜ì—¬ í•´ë‹¹ ë°ì´í„°ë¥¼ ì‚½ì…í•¨>
     * @param input - ë„£ì€ ìë£Œì˜ ê°’ì´ ë“¤ì–´ìˆëŠ” Animal_ins ê°ì²´
     * @return - ì¶”ê°€ëœ ì •ë³´ì˜ ê°œìˆ˜
     */
    @Insert( "insert into animal_ins (animal_id, animal_type, datetime, intake_condition, name, sex_upon_intake) "
            + "values (#{animalId}, #{animalType}, #{dateTime}, #{intakeCondition}, #{name}, #{sexUponIntake})"
    )
    public int insert (Animal_ins input);

    /**
     * <ê°ì²´ë¥¼ ì´ìš©í•˜ì—¬ ì •ë³´ë¥¼ ìˆ˜ì •í•¨>
     * @param input - ìˆ˜ì •í•  ì •ë³´ê°€ ë‹´ê¸´ animal_ins ê°ì²´
     * @return - ìˆ˜ì •í•œ ì •ë³´ì˜ ìˆ˜ê°€ ë‹´ê¸´ ë°ì´í„°
     */
    @Update( "update animal_ins set animal_type = #{animalType}, datetime = #{dateTime}, intake_condition = #{intakeCondition}, "
            + "name = #{name}, sex_upon_intake = #{sexUponIntake} "
            + "where animal_id = #{animalId}"
    )
    public int update(Animal_ins input);

    /**
     * <íŠ¹ì • ì•„ì´ë””ì˜ ì •ë³´ë¥¼ ì‚­ì œí•¨>
     * @param input - ì‚­ì œí•  ì•„ì´ë””ê°€ í¬í•¨ëœ ê°ì²´
     * @return - ì²˜ë¦¬ëœ ì‚­ì œì˜ ìˆ˜
     */
    @Delete( "delete from animal_ins where animal_id = #{animalId}"
    )
    public int delete(Animal_ins input);
} 
```

### 2-3. AnimalInsConnectionFactory
- ê°™ì€ ì´ë¦„ ë‹¤ë¥¸ ê²½ë¡œê°€ ì„í¬íŠ¸ë˜ì§€ ì•Šë„ë¡ ì¡°ì‹¬í•˜ê¸°
```java
public class AnimalInsConnectionFactory {
    private static SqlSessionFactory sqlsessionFactory;

    static {
        try {
            Reader reader = Resources.getResourceAsReader("config.xml");

            if (sqlsessionFactory == null){
                sqlsessionFactory = new SqlSessionFactoryBuilder().build(reader);
            }
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    public static SqlSession getSqlSession(){
        return sqlsessionFactory.openSession();
    }
}
```

### 2-4. AnimalInsService
- ì„œë¹„ìŠ¤ ì¸í„°í˜ì´ìŠ¤ëŠ” ê¸°ëŠ¥ì„ ìš°ì„  ì •ì˜í•´ë‘ëŠ” ì¼ì„ í•œë‹¤.
```java
public interface AnimalInsService {
/**
     * <ëª©ë¡ ì¡°íšŒ>
     * 
     * @param input - ì¡°íšŒí•  ë™ë¬¼ì˜ ê²€ìƒ‰ì–´ë¥¼ ë‹´ê³ ìˆëŠ” beans
     * @return - List<Department> ì¡°íšŒëœ ë°ì´í„°
     * @throws ServiceNoResultException - ì¡°íšŒëœ ë°ì´í„°ê°€ ì—†ëŠ” ê²½ìš°
     * @throws Exception - sql ì²˜ë¦¬ì— ì‹¤íŒ¨í•œ ê²½ìš° (í”„ë¡œê·¸ë¨ì ì¸ ì—ëŸ¬)
     */
    public List<Animal_ins> getList(Animal_ins input) throws ServiceNoResultException, Exception;

    /**
     * <ìƒì„¸ì •ë³´ ì¡°íšŒ>
     * 
     * @param input - ì¡°íšŒí•  ë™ë¬¼ì˜ ì¼ë ¨ë²ˆí˜¸ë¥¼ ë‹´ê³ ìˆëŠ” beans 
     * @return - ì¡°íšŒëœ ë°ì´í„°
     * @throws ServiceNoResultException - ì¡°íšŒëœ ë°ì´í„°ê°€ ì—†ëŠ” ê²½ìš°
     * @throws Exception - sqlì²˜ë¦¬ì— ì‹¤íŒ¨í•œ ê²½ìš°
     */
    public Animal_ins getItem(Animal_ins input) throws ServiceNoResultException, Exception;

    /**
     * <ë™ë¬¼ ë°ì´í„°ë¥¼ ì¶”ê°€í•˜ê³  ì €ì¥ëœ ì •ë³´ë¥¼ ë°”ë¡œ ë¦¬í„´í•˜ì—¬ í™•ì¸ì‹œí‚´>
     * 
     * @param input - ì €ì¥í•  ì •ë³´ë¥¼ ë‹´ê³ ìˆëŠ” beans
     * @return - ì¡°íšŒëœ ë°ì´í„°
     * @throws ServiceNoResultException - ì €ì¥ëœ ë°ì´í„°ê°€ ì—†ëŠ”ê²½ìš°
     * @throws Exception - sql ì²˜ë¦¬ì— ì‹¤íŒ¨í•œ ê²½ìš° (í”„ë¡œê·¸ë¨ì ì¸ ì—ëŸ¬)
     */
    public Animal_ins addItem(Animal_ins input) throws ServiceNoResultException, Exception;

    /**
     * <ë™ë¬¼ ì •ë³´ë¥¼ ìˆ˜ì •í•˜ê³  ìˆ˜ì •í•œ ë‚´ì—­ì„ ë¦¬í„´í•œë‹¤.>
     * 
     * @param input - ìˆ˜ì •í•  ì •ë³´ë¥¼ ë‹´ê³  ìˆëŠ” beans
     * @return - ìˆ˜ì •ëœ ë°ì´í„°
     * @throws ServiceNoResultException - ìˆ˜ì •ëœ ë°ì´í„°ê°€ ì—†ëŠ” ê²½ìš°
     * @throws Exception  - sqlë¬¸ì´ ì²˜ë¦¬ë˜ì§€ ì•Šì•˜ì„ ê²½ìš°
     */
    public Animal_ins editItem(Animal_ins input) throws ServiceNoResultException, Exception;

    /**
     * <ë™ë¬¼ ì •ë³´ë¥¼ ì‚­ì œí•œë‹¤.>
     * 
     * @param input - ì‚­ì œí•  ì •ë³´ê°€ ë‹´ê²¨ìˆëŠ” beans
     * @return - ì‚­ì œí•œ ì •ë³´ì˜ ìˆ˜
     * @throws ServiceNoResultException - ì‚­ì œëœ ë°ì´í„°ê°€ ì—†ëŠ” ê²½ìš°
     * @throws Exception - sqlë¬¸ì´ ì •ìƒ ì²˜ë¦¬ë˜ì§€ ì•Šì€ ê²½ìš°
     */
    public int deleteItem(Animal_ins input) throws ServiceNoResultException, Exception;
}
```

### 2-6. ServiceNoResultException
- ìƒˆë¡œìš´ ì˜ˆì™¸ë¥¼ ìƒì„±í• ë•ŒëŠ” exeptionì„ ìƒì† ë°›ì•„ì„œ ì§„í–‰í•œë‹¤.
```java
public class ServiceNoResultException extends Exception{
    public ServiceNoResultException(String message) {
        super(message);
    }
}
```

### 2-5. AnimalInsServiceImpl 
- í…Œì´ë¸”ì„ ë³€ê²½í•˜ë©´ ìˆ˜ì •ëœ ê²°ê³¼ë¥¼ ë‹¤ì‹œ ê°™ì€ ê°ì²´ë¥¼ ì´ìš©í•´ì„œ ë°˜í™˜í•˜ëŠ” êµ¬ì¡°ë¥¼ ìµíˆëŠ” ê²ƒì´ ì¤‘ìš”í•œ ê²ƒ ê°™ë‹¤.
```java
public class AnimalInsServiceImpl implements AnimalInsService{
    AnimalInsMapper mapper = null;

    public AnimalInsServiceImpl(SqlSession sqlSession){
        mapper = sqlSession.getMapper(AnimalInsMapper.class);
    }

    @Override
    public Animal_ins addItem(Animal_ins input) throws ServiceNoResultException, Exception {
        int cnt = 0;
        Animal_ins output = null;

        cnt = mapper.insert(input);

        if (cnt == 0){
            throw new ServiceNoResultException("ì…ë ¥ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.");
        }

        output = mapper.selectOne(input);

        return output;
    }

    @Override
    public int deleteItem(Animal_ins input) throws ServiceNoResultException, Exception {
        int output = 0;

        output = mapper.delete(input);

        if (output == 0){
            throw new ServiceNoResultException("ì‚­ì œ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.");
        }
        return output;
    }

    @Override
    public Animal_ins editItem(Animal_ins input) throws ServiceNoResultException, Exception {
        int cnt = 0;
        Animal_ins output = null;

        cnt = mapper.update(input);

        if (cnt == 0){
            throw new ServiceNoResultException("ìˆ˜ì • ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.");
        }

        output = mapper.selectOne(input);

        return output;
    }

    @Override
    public Animal_ins getItem(Animal_ins input) throws ServiceNoResultException, Exception {
        Animal_ins output = null;
        output = mapper.selectOne(input);

        if (output == null){
            throw new ServiceNoResultException("ì˜ëª»ëœ ê°’ì„ ì¡°íšŒí•˜ì˜€ìŠµë‹ˆë‹¤.");
        }

        return output;
    }

    @Override
    public List<Animal_ins> getList(Animal_ins input) throws ServiceNoResultException, Exception {
        List<Animal_ins> output = null;
        output = mapper.selectList(input);
        return output;
    }
    
}
```

### 2-6. í”„ë ˆì  í…Œì´ì…˜ ê³„ì¸µì—ì„œ ì‚¬ìš©í•´ë³´ê¸°
- ì‚¬ì‹¤ ë‹¤ë¥¸ ì¼€ì´ìŠ¤ë“¤ì€ ì¼ë°˜ì ì´ë¼ ê·¸ëƒ¥ ì„¸ì…˜, ì„œë¹„ìŠ¤ ë¡œë”©í•˜ê³  ì‚¬ìš©í•˜ë©´ ë˜ëŠ”ë° datetimeì„ inputí• ë•Œì˜ ì¼€ì´ìŠ¤ë§Œ íŠ¹ì´í•´ì„œ ë”°ë¡œ ì •ë¦¬í•œë‹¤.
- ë°ì´íŠ¸ íƒ€ì„ì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ì„œëŠ” ìš°ì„  formatterë¥¼ í†µí•´ ë°ì´í„° í¬ë©§ì„ ì •ì˜í•˜ê³  localtime ê°ì²´ì— parseë¥¼ í†µí•´ ë¬¸ìì—´ì„ ë°”ë¡œ localdateë¡œ í¬ë©§í•œë‹¤.
- ê·¸ëƒ¥ stringìœ¼ë¡œ íƒ€ì… ë§ì¶°ì„œ ë„£ìœ¼ë©´ ë¬¸ì œê°€ ì—†ë‹¤ê³  í•œë‹¤.
- ê·¸ ì™¸ì— setterë¥¼ í†µí•´ ê°’ì„ ì„¸íŒ…í• ë•Œ ê°™ì€ ê°’ì„ ì—¬ëŸ¬ ë²ˆ ì“´ë‹¤ê±°ë‚˜ ë³µì‚¬, ë¶™ì—¬ë„£ê¸° í•˜ëŠ” ê³¼ì •ì—ì„œ ì‹¤ìˆ˜ë§Œ ë”ë¸”ì²´í¬í•˜ë©´ ì¢‹ì„ ê²ƒ ê°™ë‹¤.
```java 
@Slf4j
public class Mainc3 {
    public static void main(String[] args) {
        SqlSession openSession = AnimalInsConnectionFactory.getSqlSession(); // ì„¸ì…˜ìƒì„±
        AnimalInsService animalInsService = new AnimalInsServiceImpl(openSession); // ì„œë¹„ìŠ¤ ìƒì„±

        DateTimeFormatter formatter = DateTimeFormatter.ofPattern("yyyy-MM-dd HH:mm:ss");
        LocalDateTime dateTime = LocalDateTime.parse("2017-03-06 15:01:00", formatter);


        Animal_ins input = new Animal_ins();
        input.setAnimalId("A999999");
        input.setAnimalType("ê³ ì–‘ì´");
        input.setDateTime(dateTime);
        input.setIntakeCondition("Normal");
        input.setName("cute");
        input.setSexUponIntake("Neutered Male");


        Animal_ins output = null;
        try {
            output = animalInsService.addItem(input);
        } catch (ServiceNoResultException e) {
            log.error("where í™•ì¸í•˜ì„¸ìš”", e);
        } catch (Exception e) {
            log.error("sql í™•ì¸í•˜ì„¸ìš”", e);
            e.printStackTrace();
        }

        log.debug(output.toString());

        openSession.commit();
        openSession.close();
    }
}
```

# 3. Book í…Œì´ë¸” ë§Œë“¤ê¸°
- ì„¤ê³„êµ¬ì¡°ê°€ ì•„ë˜ì²˜ëŸ¼ ë˜ëŠ”ê²Œ ì¼ë°˜ì ìœ¼ë¡œ ì¢‹ë‹¤ê³  í•˜ì—¬ ì´ ìˆœì„œì— ë”°ë¼ ë§Œë“¤ì–´ë³´ë„ë¡ í•  ê²ƒì´ë‹¤.

| ìˆœì„œ | ì„¤ëª… |
|------|------|
| ğŸŸ¢ **Model** | ë°ì´í„° ë¼ˆëŒ€ ë¨¼ì € ì •ì˜ (Entity, DTO ë“±) |
| ğŸŸ¡ **Service Interface** | ì–´ë–¤ ê¸°ëŠ¥(ì¡°íšŒ, ë“±ë¡ ë“±)ì„ ì œê³µí• ì§€ ì •ì˜ |
| ğŸŸ  **Mapper** | ì„œë¹„ìŠ¤ê°€ í•„ìš”ë¡œ í•˜ëŠ” SQL ì¿¼ë¦¬ ì •ì˜ |
| ğŸ”µ **ServiceImpl** | ì„œë¹„ìŠ¤ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì‹¤ì œë¡œ êµ¬í˜„ (ë§¤í¼ í˜¸ì¶œ ë“±) |

### 3-1. Book models
- dataí•˜ëŠ”ê±° ê¹Œë¨¹ì§€ ë§ê³  ë°”ë¡œë°”ë¡œ í•˜ê¸° getter, setter í—ˆì „í•˜ìë…€~
```java
@Data
public class Book {
    private int bookId; // ì±…ì˜ ê³ ìœ  ì‹ë³„ë²ˆí˜¸
    private String category; // ì±…ì˜ ì¹´í…Œê³ ë¦¬
    private int authorId; // ì±… ì €ìì˜ ì‹ë³„ë²ˆí˜¸
    private int price; // ì±…ì˜ ê°€ê²©
    private String publishedDate; // ì±…ì´ ì¶œíŒëœ ë‚ ì§œ
}
```

### 3-2. BookService
```java
public interface BookService {

    /** ì „ì²´ ì¡°íšŒ
     * 
     * @param input - ì±… ë°ì´í„° ë³´í†µì€ null
     * @return - ì „ì²´ ì±…ì˜ ë¦¬ìŠ¤íŠ¸
     */ 
    public List<Book> getBookList(Book input) throws ServiceNoResultException, Exception;
    
    /** ë‹¨ì¼ ì¡°íšŒ
     * 
     * @param input - ì•Œê³  ì‹¶ì€ ì±…ì˜ ì •ë³´
     * @return - í•´ë‹¹ ì±…ì˜ ë°ì´í„°
     */
    public Book getBook(Book input) throws ServiceNoResultException, Exception;

    /** ë°ì´í„° ì¶”ê°€
     * 
     * @param input - ì¶”ê°€í•˜ê³  ì‹¶ì€ ì±…ì˜ ëª¨ë“  ì •ë³´
     * @return - ì¶”ê°€ëœ ê²°ê³¼ë¥¼ ë³´ì—¬ì£¼ëŠ” ë°ì´í„°
     */
    public Book addBook(Book input) throws ServiceNoResultException, Exception;

    /** ë°ì´í„° ìˆ˜ì •
     * 
     * @param input - ìˆ˜ì •í•˜ê³  ì‹¶ì€ ì±…ì˜ ìˆ˜ì •í•˜ê³  ì‹¶ì€ ì •ë³´
     * @return - ìˆ˜ì •ëœ ê²°ê³¼ë¥¼ ë³´ì—¬ì£¼ëŠ” ë°ì´í„°
     */
    public Book updateBook(Book input) throws ServiceNoResultException, Exception;

    /** ë°ì´í„° ì‚­ì œ
     * 
     * @param input - ì‚­ì œí•˜ê³  ì‹¶ì€ ì±…ì˜ ì •ë³´
     * @return - ì‚­ì œê°€ ì˜ ë˜ì—ˆëŠ”ì§€ ì•Œë ¤ì£¼ëŠ” ë°ì´í„°
     */
    public int deleteBook(Book input) throws ServiceNoResultException, Exception;
} 
```

### 3-3. BookServiceMapper
- results ì•ˆì— result, ê·¸ë¦¬ê³  resultmapìœ¼ë¡œ ë°˜ë³µ
```java
@Mapper
public interface BookServiceMapper {

    // ì „ì²´ì¡°íšŒ
    @Results ( id = "BookMap", value = {
        @Result (property = "bookId", column = "book_id"),
        @Result (property = "category", column = "category"),
        @Result (property = "authorId", column = "author_id"),
        @Result (property = "price", column = "price"),
        @Result (property = "publishedDate", column = "published_date"),
    }
    )
    @Select ( "select book_id, category, author_id, price, published_date "
            + "from book" 
    )
    public List<Book> selectBookList(Book input);

    // ë‹¨ì¼ì¡°íšŒ
    
    @Select ("<script>"
            + "select book_id, category, author_id, price, published_date "
            + "from book "
            + "<where>"
            + "<if test = \" bookId != null and bookId != '' \"> book_id = #{bookId} </if>"
            + "</where>"
            + "</script>"
    )
    @ResultMap ("BookMap")
    public Book selectBook(Book input);

    // ì¶”ê°€
    @Insert ( "insert into book (book_id, category, author_id, price, published_date)"
            + "values (#{bookId}, #{category}, #{authorId}, #{price}, #{publishedDate})"
    )
    @ResultMap ("BookMap")
    public int insertBook(Book input);
    
    // ìˆ˜ì •
    @Update ( "<script>"
            + "update book set category = #{category}, author_id = #{authorId}, price = #{price}, published_date = #{publishedDate}"
            + "<where>"
            + "<if test = \" bookId != null and bookId != '' \"> book_id = #{bookId} </if>"
            + "</where>"
            + "</script>")
    @ResultMap ("BookMap")
    public int updateBook(Book input);

    // ì‚­ì œ
    @Delete ( "<script>"
            + "delete from book" 
            + "<where>"
            + "<if test = \" bookId != null and bookId != '' \"> book_id = #{bookId} </if>"
            + "</where>"
            + "</script>"
    )
    @ResultMap ("bookMap")
    public int deleteBook(Book input);
} 
```

### 3-4. BookserviceImpl
- ì—ëŸ¬ë„ ì„œë¹„ìŠ¤ ì¸í„°í˜ì´ìŠ¤ì—ì„œ ë‹¤ ì •ì˜í•´ì„œ ê°™ì´ ë‚´ë ¤ì™€ì•¼í•œë‹¤.
- presentation layerëŠ” ë˜‘ê°™ìœ¼ë¯€ë¡œ ìƒëµí•œë‹¤.
- ë‚´ë¶€ ê¸°ëŠ¥ì„ ì¢€ ë” ì»´íŒ©íŠ¸í•˜ê²Œ ìˆ˜ì •í•˜ì˜€ë‹¤.
```java
public class BookserviceImpl implements BookService {
    private BookServiceMapper mapper = null;


    public BookserviceImpl(SqlSession sqlSession){
        mapper = sqlSession.getMapper(BookServiceMapper.class);
    }

    @Override
    public Book addBook(Book input) throws ServiceNoResultException, Exception{
        if(mapper.insertBook(input) == 0){
            throw new ServiceNoResultException("ì…ë ¥ ê²°ê³¼ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
        }
        return mapper.selectBook(input);
    }

    @Override
    public int deleteBook(Book input) throws ServiceNoResultException, Exception{
        int output = mapper.deleteBook(input);
        if (output == 0){
            throw new ServiceNoResultException("ì‚­ì œëœ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.");
        }
        return output;
    }

    @Override
    public Book getBook(Book input) throws ServiceNoResultException, Exception{
        Book output = mapper.selectBook(input);
        if (output == null){
            throw new ServiceNoResultException("ì„ íƒëœ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.");
        }
        return output;
    }

    @Override
    public List<Book> getBookList(Book input) throws ServiceNoResultException, Exception{
        List<Book> output = mapper.selectBookList(input);
        return output;
    }

    @Override
    public Book updateBook(Book input) throws ServiceNoResultException, Exception{
        if(mapper.updateBook(input) == 0){
            throw new ServiceNoResultException("ìˆ˜ì • ê²°ê³¼ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
        } 
        return mapper.selectBook(input);
    }
}
```

### 4. student mapper, service
- @optionsê³¼ @resultmap ì¤‘ @optionsê°€ ì‹¤í–‰ ì „ ì„¤ì •ì„ ì˜ë¯¸í•˜ë¯€ë¡œ ì•ì„œì•¼ í•œë‹¤.
- <if test='...'>: í•´ë‹¹ ê°’ì´ nullì´ ì•„ë‹ ê²½ìš°ì—ë§Œ í•´ë‹¹ í•­ëª©ì„ ì—…ë°ì´íŠ¸í•œë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.
- <where>: WHERE ì¡°ê±´ì ˆì„ ìœ ë™ì ìœ¼ë¡œ êµ¬ì„±í•˜ë©´ì„œ, ì¡°ê±´ì´ ìˆëŠ” ê²½ìš°ì—ë§Œ WHERE í‚¤ì›Œë“œë¥¼ ìë™ìœ¼ë¡œ ë¶™ì—¬ì£¼ê³ , ì•ì— ë¶™ì€ AND, ORë„ ìë™ìœ¼ë¡œ ì •ë¦¬í•´ì£¼ëŠ” ê¸°ëŠ¥
- <set> : UPDATE ë¬¸ì—ì„œ ì—¬ëŸ¬ í•„ë“œë¥¼ ì¡°ê±´ë¶€ë¡œ ìˆ˜ì •í•  ë•Œ, ìë™ìœ¼ë¡œ ë§ˆì§€ë§‰ ì‰¼í‘œ(,)ë¥¼ ì œê±°í•´ì£¼ê³ , SET í‚¤ì›Œë“œë¥¼ ìë™ìœ¼ë¡œ ì¶”ê°€í•´ì£¼ëŠ” ê¸°ëŠ¥
- @ResultMapì€ SELECT ê²°ê³¼ ë§¤í•‘ì—ë§Œ ì‚¬ìš©ë¨ ì¦‰ @Delete, @Insert, @UpdateëŠ” ê²°ê³¼ ë§¤í•‘ì´ ì—†ê¸° ë•Œë¬¸ì— ë¶™ì¼ í•„ìš” ì—†ìŒ
- @Options(useGeneratedKeys = true)ëŠ” id ê°€ auto_incrementì—¬ì•¼ ì‹¤íš¨ì„±ì´ ìˆìŒ.
- ì—¬ê¸°ì„œëŠ” idê°€ auto_incrementì´ë¯€ë¡œ ì‹¤íš¨ì„± ìˆìŒ.
- ì¤‘ê°„ì— ì—ëŸ¬ê°€ ë„ˆë¬´ ë§ìœ¼ë©´ í•©ë¦¬ì ì´ì§€ ì•Šì€ ì—ëŸ¬ê°€ ë°œìƒí•˜ê¸°ë„ í•œë‹¤.

#### ì°¸ì¡°ê´€ê³„ ì°¾ê¸° (INFORMATION_SCHEMA.KEY_COLUMN_USAGE: ì°¸ì¡°ê´€ê³„ í…Œì´ë¸” í™œìš©)
```sql
SELECT 
    TABLE_NAME, 
    COLUMN_NAME, 
    CONSTRAINT_NAME, 
    REFERENCED_TABLE_NAME, 
    REFERENCED_COLUMN_NAME
FROM 
    INFORMATION_SCHEMA.KEY_COLUMN_USAGE
WHERE 
    REFERENCED_TABLE_NAME = 'students';
```

### 4-1. studentMapper
```java
@Mapper
public interface StudentMapper {

    /**
     *  íŠ¹ì • í•™ê³¼ì— ì†Œì†ë˜ì–´ ìˆê±°ë‚˜ íŠ¹ì • í•™ê³¼ì— ì†Œì†ëœ êµìˆ˜ì˜ ì§€ë„ í•™ìƒì¸ í•™ìƒì„ ì‚­ì œ
     * @param input - í•™ê³¼ ë²ˆí˜¸ë¥¼ ì €ì¥í•˜ê³  ìˆëŠ” student ê°ì²´
     * @return - ì‚­ì œëœ ë°ì´í„°ì˜ ìˆ˜
     */
    
    @Delete("DELETE FROM students WHERE department_id = #{departmentId} OR "
    + "PROFESSOR_ID IN (SELECT ID FROM PROFESSORS WHERE department_id = #{departmentId})")
    public int deleteByDepartmentId(Student input);

    /**
     * <ëª¨ë“  í…Œì´ë¸”ì˜ ì •ë³´ë¥¼ ë¦¬ìŠ¤íŠ¸ë¡œ ë°›ìŒ>
     * @param input - Student ê°ì²´
     * @return - ì—´ ê°’ì´ ì €ì¥ëœ ë¦¬ìŠ¤íŠ¸ 
     */
    @Results ( id = "StudentMap", value = {
        @Result (column = "id", property = "id" ),
        @Result (column = "name", property = "name"),
        @Result (column = "user_id", property = "userId"),
        @Result (column = "grade", property = "grade"),
        @Result (column = "idnum", property = "idnum"),
        @Result (column = "birthdate", property = "birthdate"),
        @Result (column = "phone", property = "phone"),
        @Result (column = "height", property = "height"),
        @Result (column = "weight", property = "weight" ),
        @Result (column = "email", property = "email"),
        @Result (column = "gender", property = "gender"),
        @Result (column = "status", property = "status"),
        @Result (column = "photo_url", property = "photoUrl"),
        @Result (column = "admission_date", property = "admissionDate"),
        @Result (column = "graduation_date", property = "graduationDate"),
        @Result (column = "department_id", property = "departmentId"),
        @Result (column = "professor_id", property = "professorId")
    })
    @Select (
            "select id, name, user_id, grade, idnum, birthdate, phone, height, weight, email, "
            + "gender, status, photo_url, admission_date, graduation_date, department_id, professor_id "
            + "from students"
    )
    @ResultMap ("StudentMap")
    public List<Student> selectList (Student input);


    /**
     * <ê³ ìœ í•œ ì•„ì´ë””ë¥¼ ì…ë ¥í•˜ì—¬ í•´ë‹¹ í–‰ì„ ì „ë‹¬ë°›ìŒ.>
     * @param input - ì•„ì´ë””ê°€ í¬í•¨ëœ Student ê°ì²´
     * @return - ì •ë³´ë¥¼ ë‹´ì€ Student ê°ì²´
     */
    @Select ( "<script>"
                + "select id, name, user_id, grade, idnum, birthdate, phone, height, weight, email, "
                + "gender, status, photo_url, admission_date, graduation_date, department_id, professor_id "
                + "from students"
                + "<where>"
                + "<if test = \"id != null and id = ''\"> id = #{id} </if>" 
                + "</where>"
                + "</script>"
    )
    @ResultMap ("StudentMap")
    public Student selectOne (Student input);


    /**
     * <ê°ì²´ë¥¼ ì´ìš©í•˜ì—¬ í•´ë‹¹ ë°ì´í„°ë¥¼ ì‚½ì…í•¨>
     * @param input - ë„£ì€ ìë£Œì˜ ê°’ì´ ë“¤ì–´ìˆëŠ” Student ê°ì²´
     * @return - ì¶”ê°€ëœ ì •ë³´ì˜ ê°œìˆ˜
     */
    @Insert( "insert into Student (id, name, user_id, grade, idnum, birthdate, phone, height, weight, email,"
            + "gender, status, photo_url, admission_date, graduation_date, department_id, professor_id) "
            + "values (#{id}, #{name}, #{userId}, #{grade}, #{idnum}, #{birthdate}, #{phone}, #{height}, #{weight}, #{email}, #{gender}, #{status}, #{photoUrl}, #{admissionDate}, #{graduationDate}, #{departmentId}, #{professorId})"
    )
    @Options(useGeneratedKeys = true, keyProperty = "id", keyColumn = "id")
    public int insert (Student input);

    /**
     * <ê°ì²´ë¥¼ ì´ìš©í•˜ì—¬ ì •ë³´ë¥¼ ìˆ˜ì •í•¨>
     * @param input - ìˆ˜ì •í•  ì •ë³´ê°€ ë‹´ê¸´ Student ê°ì²´
     * @return - ìˆ˜ì •í•œ ì •ë³´ì˜ ìˆ˜ê°€ ë‹´ê¸´ ë°ì´í„°
     */
    @Update("<script>"
        + "UPDATE students "
        + "<set>"
        + "<if test='name != null'>name = #{name},</if>"
        + "<if test='userId != null'>user_id = #{userId},</if>"
        + "<if test='grade != null'>grade = #{grade},</if>"
        + "<if test='idnum != null'>idnum = #{idnum},</if>"
        + "<if test='birthdate != null'>birthdate = #{birthdate},</if>"
        + "<if test='phone != null'>phone = #{phone},</if>"
        + "<if test='height != null'>height = #{height},</if>"
        + "<if test='weight != null'>weight = #{weight},</if>"
        + "<if test='email != null'>email = #{email},</if>"
        + "<if test='gender != null'>gender = #{gender},</if>"
        + "<if test='status != null'>status = #{status},</if>"
        + "<if test='photoUrl != null'>photo_url = #{photoUrl},</if>"
        + "<if test='admissionDate != null'>admission_date = #{admissionDate},</if>"
        + "<if test='graduationDate != null'>graduation_date = #{graduationDate},</if>"
        + "<if test='departmentId != null'>department_id = #{departmentId},</if>"
        + "<if test='professorId != null'>professor_id = #{professorId},</if>"
        + "</set> "
        + "WHERE id = #{id}"
        + "</script>")
        @Options (useGeneratedKeys = true, keyProperty = "id", keyColumn = "id")
    public int update(Student input);

    /**
     * <íŠ¹ì • ì•„ì´ë””ì˜ ì •ë³´ë¥¼ ì‚­ì œí•¨>
     * @param input - ì‚­ì œí•  ì•„ì´ë””ê°€ í¬í•¨ëœ ê°ì²´
     * @return - ì²˜ë¦¬ëœ ì‚­ì œì˜ ìˆ˜
     */
    @Delete( "<script>"
            + "delete from Student"
            + "<where>"
            + "<if test = \" id != null and id != ''\"> id = #{id} </if>"
            + "</where>"
            + "</script>"
    )
    public int delete(Student input);
}
```

### 4-2. syudentserviceImpl
```java
public class StudentServiceImpl implements StudentService{
    StudentMapper studentMapper = null;
    EnrollmentMapper enrollmentMapper = null;

    public StudentServiceImpl(SqlSession sqlSession){
        studentMapper = sqlSession.getMapper(StudentMapper.class);
        enrollmentMapper = sqlSession.getMapper(EnrollmentMapper.class);
    }

    @Override
    public Student addItem(Student student) throws ServiceNoResultException, Exception {
        if (studentMapper.insert(student) == 0){
            throw new ServiceNoResultException("ì¡°íšŒê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.");
        }
        return studentMapper.selectOne(student);
    }

    @Override
    public Student getItem(Student student) throws ServiceNoResultException, Exception {
        Student output = studentMapper.selectOne(student);
        if (output == null){
            throw new ServiceNoResultException("ì¡°íšŒê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.");
        }
        return output;
    }

    @Override
    public List<Student> getList(Student student) throws ServiceNoResultException, Exception {
        return studentMapper.selectList(student);
    }

    @Override
    public Student updateItem(Student student) throws ServiceNoResultException, Exception {
        if (studentMapper.update(student) == 0){
            throw new ServiceNoResultException("ì¡°íšŒê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.");
        }
        return studentMapper.selectOne(student);
    }

    @Override
    public int deleteItem(Student student) throws ServiceNoResultException, Exception {
        // enrollment ì‚­ì œ
        enrollmentMapper.deleteByStudentIdOnly(student);

        // student ì‚­ì œ
        int output = studentMapper.delete(student);
        return output;
    }
}
```

### 4-3. studentë¥¼ ì‚­ì œí•˜ê¸° ìœ„í•œ enrollment ì‚­ì œ mapper
```java
/**
         * í•™ìƒì„ ì‚­ì œí•˜ê¸° ìœ„í•´ì„œ ìš°ì„  ê·¸ í•™ìƒì´ ìˆ˜ê°•ì‹ ì²­í•œ ë‚´ì—­ì„ ì§€ìš°ê¸° ìœ„í•´ í•„ìš”í•œ í•¨ìˆ˜
         * @param input
         * @return
         */
        @Delete ( "<script>"
                  + "delete from enrollments"
                  + "<where>"
                  + "<if test = \" id != null and id != '' \"> student_id = #{id} </if>"
                  + "</where>"
                  + "</script>"
        )
        public int deleteByStudentIdOnly(Student input);
```

