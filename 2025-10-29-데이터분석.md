# ğŸ“Œ 1.íšŒê·€ ì•Œê³ ë¦¬ì¦˜ - kaggle ìì „ê±° ëŒ€ì—¬ ë°ì´í„°
## 1-1. íšŒê·€ ì•Œê³ ë¦¬ì¦˜ ì§ì ‘êµ¬í˜„í•˜ê¸°
- y_predict - y â†’ ì˜ˆì¸¡ê°’ê³¼ ì‹¤ì œê°’ì˜ ì°¨ì´, ì¦‰ ì˜¤ì°¨(error)
- .mean() â†’ ëª¨ë“  ë°ì´í„°ì˜ í‰ê·  ì˜¤ì°¨
- lr â†’ learning rate (í•™ìŠµë¥ )
- b â†’ bias (í¸í–¥)
- ë§Œì•½ ì˜ˆì¸¡ê°’ì´ ì „ì²´ì ìœ¼ë¡œ **ì‹¤ì œê°’ë³´ë‹¤ í¬ë‹¤(ì–‘ì˜ ì˜¤ì°¨)**ë©´, (y_predict - y).mean()ì´ ì–‘ìˆ˜ â†’ bì—ì„œ ê·¸ê±¸ ë¹¼ë‹ˆê¹Œ biasê°€ ì¤„ì–´ë“¦ â†’ ì˜ˆì¸¡ê°’ ì „ì²´ê°€ ë‚´ë ¤ê°.
- ë°˜ëŒ€ë¡œ ì˜ˆì¸¡ê°’ì´ **ì „ì²´ì ìœ¼ë¡œ ì‘ë‹¤(ìŒì˜ ì˜¤ì°¨)**ë©´, (y_predict - y).mean()ì´ ìŒìˆ˜ â†’ bì—ì„œ ìŒìˆ˜ë¥¼ ë¹¼ë‹ˆê¹Œ biasê°€ ëŠ˜ì–´ë‚¨ â†’ ì˜ˆì¸¡ê°’ ì „ì²´ê°€ ì˜¬ë¼ê°.
- ì¦‰, bëŠ” ì „ì²´ ê·¸ë˜í”„ë¥¼ ìœ„ì•„ë˜ë¡œ í‰í–‰ì´ë™ì‹œí‚¤ëŠ” ì—­í• ì„ í•œë‹¤.
- ì†ì‹¤í•¨ìˆ˜ ì „ì²´ë¥¼ wê³¼ bë¡œ ê°ê° í¸ë¯¸ë¶„í•˜ì—¬ ê¸°ìš¸ê¸°ë¥¼ êµ¬í•˜ê³  ê¸°ìš¸ê¸°ë§Œí¼ ì¡°ì •í•œë‹¤.

| ìˆ˜í•™ì‹                        | ì˜ë¯¸            | ì½”ë“œ                           |
| -------------------------- | ------------- | ---------------------------- |
| âˆ‚L/âˆ‚w = mean((yÌ‚ - y) * X) | wì— ëŒ€í•œ ë¯¸ë¶„(ê¸°ìš¸ê¸°) | ((y_predict - y) * X).mean() |
| âˆ‚L/âˆ‚b = mean(yÌ‚ - y)       | bì— ëŒ€í•œ ë¯¸ë¶„(ê¸°ìš¸ê¸°) | (y_predict - y).mean()       |

```py
y_predict = X * w + b

w = np.random.uniform(-1, 1)
b = np.random.uniform(-1, 1)

num_cnt = 100000
lr = 0.0005    # 0.0003

for i in range(num_cnt):
    y_predict = X * w + b

    b = b - lr * (y_predict - y).mean()
    w = w - lr * ((y_predict - y) * X).mean()

    if i % 10000 == 0:
        print(f"ë°˜ë³µíšŸìˆ˜ : {i}, weight : {w}, bias : {b}")
```

## 1-2. kaggleì—ì„œ ë°ì´í„° ë°›ê¸°
- ìš°ì„  kaggleì— ë¡œê·¸ì¸í•´ì„œ settings -> api í•´ì„œ kaggle.jsonìœ¼ë¡œ ì €ì¥ëœ íŒŒì¼ì„ ì½”ë© íŒŒì¼í´ë”ì— ì—…ë¡œë“œí•œë‹¤.
- í•´ë‹¹ ì¼€ê¸€ competitionì— ì°¸ê°€ ì‹ ì²­ì„ í•´ì•¼ ë‹¤ìš´ë¡œë“œ ì½”ë“œê°€ ì‘ë™í•œë‹¤.
- ì•„ë˜ì½”ë“œë¥¼ ì½”ë©ì— ì…ë ¥í•˜ë©´ ì¸ì¦ì´ ë˜ê³  ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆë‹¤.
- 4ë²ˆì´ í•´ë‹¹ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ëª…ë ¹ì–´ì´ë‹¤.
- ë§ˆì§€ë§‰ ì½”ë“œë¡œ ì¸í•´ ì••ì¶•íŒŒì¼ ë‚´ë¶€ì˜ ë°ì´í„°ë¥¼ ì••ì¶•í•´ì œí•  ìˆ˜ ìˆë‹¤.
```py
# kaggle ë¡œë¶€í„° ì§ì ‘ ë°ì´í„° ì…ìˆ˜í•˜ëŠ” ë°©ì•ˆ :

# 1) API token ë°œê¸‰ ë° ì €ì¥ : kaggle.json
# 2) kaggle ëª¨ë“ˆ ì„¤ì¹˜
!pip install kaggle --upgrade

# 3) ì¤€ë¹„ì‘ì—…
!mkdir ~/.kaggle
!cp kaggle.json ~/.kaggle/
!chmod 600 ~/.kaggle/kaggle.json

# 4) kaggle íŒŒì¼ ì˜¨ë¼ì¸ì„ í†µí•´ ë³µì‚¬/ì´ë™
!kaggle competitions download -c bike-sharing-demand

# zip íŒŒì¼ë¡œë¶€í„° ë°ì´í„° í™•ë³´ :
!unzip /content/bike-sharing-demand.zip
```

## 1-2. ë°ì´í„° selection ë° ì „ì²˜ë¦¬
- ìœ„ì—ì„œ ë°›ì•„ì˜¨ íŒŒì¼ì„ ë°ì´í„°í”„ë ˆì„ìœ¼ë¡œ ë°›ì•„ì˜¨ë‹¤.
- ê²°ì¸¡ì¹˜ê°€ ì¡´ì¬í•˜ì§€ ì•Šê³  ë°”ê¿€ ë²”ì£¼í˜• ë³€ìˆ˜ë„ ë‚ ì§œì •ë„ë°–ì— ì—†ì–´ì„œ ë‚ ì§œë§Œ ë”°ë¡œ ì²˜ë¦¬í•´ì£¼ë©´ ëœë‹¤.
```py
train = pd.read_csv("train.csv")

print(train.shape)
train.head(3)

submission = pd.read_csv("sampleSubmission.csv")

print(submission.shape)
submission.head(1)

train.isnull().sum()
train.describe().T # ê¸°ì´ˆí†µê³„ëŸ‰ í™•ì¸ -> ì „ì¹˜í•˜ë©´ ë³´ê¸° í¸í•¨
```
- ë‚ ì§œ ë°ì´í„°ëŠ” ì•„ë˜ì™€ ê°™ì´ ë¶„í•´í•˜ì—¬ ì»¬ëŸ¼ì„ ë§Œë“¤ì–´ë‘”ë‹¤.
```py
train["Y"] = pd.to_datetime(train["datetime"]).dt.year
train["M"] = pd.to_datetime(train["datetime"]).dt.month
train["D"] = pd.to_datetime(train["datetime"]).dt.day
train["h"] = pd.to_datetime(train["datetime"]).dt.hour
train["m"] = pd.to_datetime(train["datetime"]).dt.minute
train["s"] = pd.to_datetime(train["datetime"]).dt.second
train["dw"] = pd.to_datetime(train["datetime"]).dt.dayofweek # 0:Mon~6:Sunday

train.head(3)
```

## 1-3. ë°ì´í„° ë¶„ì„
- í•´ë‹¹ ë°ì´í„°ì˜ ë¶„í¬ë¥¼ í™•ì¸í•œ ê²°ê³¼ skewness > 0ì´ë¯€ë¡œ ì œê³±ê·¼ ë³€í™˜ì´ë‚˜ ë¡œê·¸ë³€í™˜ì„ í†µí•´ í° ë°ì´í„°ë¥¼ ëˆŒëŸ¬ì£¼ì–´ì•¼ í•œë‹¤.
- numpyì˜ log1pí•¨ìˆ˜ëŠ” ì™œë„ê°€ í° ë°ì´í„°ë¥¼ 1+xë¡œ ë¡œê·¸ë³€í™˜í•˜ì—¬ ì›ë˜ 0ì¸ ê°’ë„ ë¡œê·¸ì— ë„£ì„ ìˆ˜ ìˆë„ë¡ í•´ì£¼ë©´ ì •ê·œë¶„í¬ì™€ ê°€ê¹Œì›Œì§„ ê·¸ë˜í”„ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
```py
plt.figure(figsize=(10,3))
plt.subplot(1,3,1)
sns.distplot(train["count"]) #skewness > 0
train["count"].skew()
plt.subplot(1,3,2)
sns.distplot(np.log1p(train["count"]))
plt.subplot(1,3,3)
sns.distplot(np.sqrt(train["count"]))
```
- ë‹¤ë¥¸ ì—¬ëŸ¬ ê·¸ë˜í”„ë„ í•œë²ˆ ê·¸ë ¤ë³¸ë‹¤.
- ì˜¨ë„ëŠ” ì‚°ì ë„
- ì—°ë„ë³„ì€ boxplot
- ì‹œê°„ì€ pointplotìœ¼ë¡œ ì‹œê°í™”í•œë‹¤.
```py
plt.figure(figsize=(10,3))
plt.subplot(1,3,1)
sns.scatterplot(x="temp",y="count",data=train)
plt.subplot(1,3,2)
sns.boxplot(x="Y",y="count",data=train)
plt.subplot(1,3,3)
sns.pointplot(x='h', y="count", data=train)
```
- ì•„ë˜ëŠ” ìƒê´€ê³„ìˆ˜ í–‰ë ¬í˜•íƒœë¡œ dataprameì„ ë½‘ì•„ì£¼ëŠ” í•¨ìˆ˜ì´ê³  ì´ë¥¼ í†µí•´ ì„œë¡œì˜ ìƒê´€ì„ ë¶„ì„í•  ìˆ˜ ìˆë‹¤.
- ì´ë•Œ ìˆ˜ì¹˜í˜• ë³€ìˆ˜ë§Œ ìˆì–´ì•¼í•˜ë¯€ë¡œ datetimeì€ ì œê±°í•œë‹¤.
- ìƒê´€ê³„ìˆ˜ í–‰ë ¬ì€ íˆíŠ¸ë§µìœ¼ë¡œ ë³´í†µ ì‹œê°í™”í•œë‹¤.
```py
cormatrix = train.drop(columns=["datetime"]).corr()
plt.figure(figsize=(10,10))
sns.heatmap(cormatrix, annot=True, fmt=".2f", linewidths=0.5)
```