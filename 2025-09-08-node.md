# ğŸ“Œ 0. ë¡œê·¸ì²˜ë¦¬ì™€ ì‚¬ìš©
### ğŸ“Œ 0-1. ë¡œê±° ëª¨ë“ˆ ë§Œë“¤ê¸°
- dotenv.config(); .env íŒŒì¼ì„ ì½ì–´ì„œ process.envì— ì €ì¥.
- ì´ë•Œ .envëŠ” ë‹¨ìˆœí•œ í…ìŠ¤íŠ¸ íŒŒì¼ì¸ë° ì´ë¥¼ íŒŒì‹±í•˜ì—¬ Node.jsê°€ ì œê³µí•˜ëŠ” í™˜ê²½ë³€ìˆ˜ ì €ì¥ì†Œ ê°ì²´ì¸ process.envì— ì €ì¥í•´ë‘˜ í•„ìš”ê°€ ìˆë‹¤. ì´ë¥¼ dotenv ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ í•˜ëŠ” ê²ƒì´ë‹¤.
- fs.mkdirSyncë¡œ ë””ë ‰í† ë¦¬ë¥¼ ë§Œë“ ë‹¤. recursive: trueë¼ì„œ ë¶€ëª¨ ë””ë ‰í† ë¦¬ê°€ ì—†ì–´ë„ í•¨ê»˜ ìƒì„±.
- logger = winston.createLoggerë¡œ ë¡œê±° ê°ì²´ë¥¼ ë§Œë“¤ì–´ë‘ì–´ì•¼í•œë‹¤.
- level: ë¡œê·¸ ë ˆë²¨ ì„¤ì •.
- format: ë¡œê·¸ ì¶œë ¥ í˜•ì‹ ì •ì˜.
- timestamp: ë¡œê·¸ê°€ ì°íŒ ì‹œê°„ ì¶”ê°€.
- errors({ stack: true }): ì—ëŸ¬ ê°ì²´ë¥¼ ì „ë‹¬í–ˆì„ ë•Œ ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤ê¹Œì§€ í¬í•¨.
- printf: ì¶œë ¥ë˜ëŠ” ìµœì¢… ë¬¸ìì—´ì„ ì§ì ‘ ì»¤ìŠ¤í„°ë§ˆì´ì§•. ${timestamp} [LEVEL]: message {meta} í˜•ì‹.
- Transports (ì¶œë ¥ ëŒ€ìƒ)
- winston.format.colorize({ all: true })ëŠ” ìƒ‰ê¹”ì„ ì…í˜€ ê°€ë…ì„± í–¥ìƒí•œë‹¤. ê·¸ë¦¬ê³  ì•„ë˜ ë‚´ìš©ë“¤ì„ ì €ì¥í•˜ì—¬ ë¡œê·¸ê°€ ìë™ ê¸°ë¡ë˜ë„ë¡í•œë‹¤.
- DailyRotateFile(app-%DATE%.log): ëª¨ë“  ë ˆë²¨ì˜ ë¡œê·¸ë¥¼ ì¼ë³„ íŒŒì¼ë¡œ ì €ì¥.
- maxSize: '20m': íŒŒì¼ì´ 20MB ë„˜ìœ¼ë©´ ìƒˆ íŒŒì¼ ìƒì„±.
- maxFiles: '14d': ìµœëŒ€ 14ì¼ì¹˜ ë¡œê·¸ë§Œ ë³´ê´€.
- zippedArchive: true: ì˜¤ë˜ëœ ë¡œê·¸ëŠ” ìë™ìœ¼ë¡œ zip ì••ì¶•.
- DailyRotateFile(error-%DATE%.log): ì—ëŸ¬ ë ˆë²¨ë§Œ ë”°ë¡œ ì €ì¥. 30ì¼ì¹˜ ë³´ê´€.
- ì´ ë¡œê·¸ ê°ì²´ë¥¼ ì–´ë””ì„ ê°€ í˜¸ì¶œí•˜ë©´ ê·¸ëŒ€ë¡œ ì¶œë ¥ì´ ë˜ëŠ”ê²ƒ
```js
// logger.js
import dotenv from 'dotenv';
import fs from 'node:fs';
import path from 'node:path';
import winston from 'winston';
import DailyRotateFile from 'winston-daily-rotate-file';

dotenv.config();

// ë¡œê·¸ ë””ë ‰í„°ë¦¬ ì¤€ë¹„
const logDir = process.env.LOG_PATH || 'logs';
fs.mkdirSync(logDir, { recursive: true });

const logger = winston.createLogger({
  level: (process.env.LOG_LEVEL || 'debug').toLowerCase(),
  format: winston.format.combine(
    winston.format.timestamp({ format: 'YYYY-MM-DD HH:mm:ss' }),
    winston.format.errors({ stack: true }),
    winston.format.printf(({ timestamp, level, message, stack, ...meta }) => {
      const metaString = Object.keys(meta).length ? ` ${JSON.stringify(meta)}` : '';
      return `${timestamp} [${level.toUpperCase()}]: ${stack || message}${metaString}`;
    })
  ),
  transports: [
    // ì½˜ì†” ì¶œë ¥
    new winston.transports.Console({
      format: winston.format.combine(winston.format.colorize({ all: true })),
    }),

    // ì „ì²´ ë¡œê·¸ (ì¼ë³„ íšŒì „)
    new DailyRotateFile({
      filename: path.join(logDir, 'app-%DATE%.log'),
      datePattern: 'YYYY-MM-DD',
      zippedArchive: true,
      maxSize: '20m',
      maxFiles: '14d',
    }),

    // ì—ëŸ¬ ì „ìš© ë¡œê·¸ (ì¼ë³„ íšŒì „)
    new DailyRotateFile({
      level: 'error',
      filename: path.join(logDir, 'error-%DATE%.log'),
      datePattern: 'YYYY-MM-DD',
      zippedArchive: true,
      maxSize: '20m',
      maxFiles: '30d',
    }),
  ],
});

export default logger;
```

### ğŸ“Œ 0-2. ë¡œê±° ëª¨ë“ˆì˜ ì‚¬ìš©
- ìœ„ì—ì„œ ë§Œë“  ë¡œê±° ëª¨ë“ˆì„ ì•„ë˜ì™€ ê°™ì´ ì‚¬ìš©í•œë‹¤.
```js
// 1. ìƒì„±í•´ ë‘” ë¡œê·¸ í—¬í¼ ëª¨ë“ˆ ì°¸ì¡°
// -> `LogHelper.js`ì—ì„œ exportí•œ logger ê°ì²´ë¥¼ `logger`ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ë°›ëŠ”ë‹¤.
import logHelper from "../helpers/LogHelper.js";
// 2. ë¡œê·¸ ì¶œë ¥
// -> `LogHelper.js`ì— ì„¤ì •ëœ ë‚´ìš©ì— ë”°ë¼, levelì— ë§ëŠ” ë¡œê·¸ê°€
// ì½˜ì†”ê³¼ íŒŒì¼ì— ê°ê° ì¶œë ¥ëœë‹¤.
logHelper.error("ì´ê²ƒì€ ì—ëŸ¬ ë¡œê·¸ì…ë‹ˆë‹¤.");
logHelper.warn("ì´ê²ƒì€ ê²½ê³  ë¡œê·¸ì…ë‹ˆë‹¤.");
logHelper.info("ì´ê²ƒì€ ì •ë³´ ë¡œê·¸ì…ë‹ˆë‹¤.");
logHelper.debug("ì´ê²ƒì€ ë””ë²„ê·¸ ë¡œê·¸ì…ë‹ˆë‹¤.");
logHelper.verbose("ì´ê²ƒì€ Verbose ë¡œê·¸ì…ë‹ˆë‹¤.");
console.log("ë¡œê·¸ ê¸°ë¡ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.");
```

# 1. httoClient
### ğŸ“Œ 1-1. httpí´ë¼ì´ì–¸íŠ¸ ìš”ì²­
- const res = await fetch(`${API}${path}`, { method, headers, body }); ì—ì„œ ë² ì´ìŠ¤ URLê³¼ ê²½ë¡œë¥¼ í•©ì³ ìš”ì²­í•œë‹¤.
- ì˜¤ë¥˜ ì²˜ë¦¬: 2xx ì•„ë‹ˆë©´ throw â†’ í˜¸ì¶œí•œ ìª½ì—ì„œ try/catchë¡œ ë°›ê¸°.
- ì‘ë‹µ íŒŒì‹±: Content-Typeì´ JSONì´ë©´ res.json(), ì•„ë‹ˆë©´ res.text().
- ì•„ë˜ get, post, put, deleteëŠ” ê°ê° ë³´ë‚¼ ê²½ë¡œì™€ ë‚´ìš©ë“±ì„ ë°›ì•„ì„œ ìš”ì²­ í˜•ì‹ì„ ë§Œë“¤ì–´ì£¼ëŠ” í•¨ìˆ˜ë¥¼ exportí•œë‹¤.
```js
// httpClient.js
const API = 'https://jsonplaceholder.typicode.com';

async function request(path, { method = 'GET', headers, body } = {}) {
  const res = await fetch(`${API}${path}`, { method, headers, body });
  if (!res.ok) throw new Error(`HTTP ${res.status}`);
  const ct = res.headers.get('content-type') || '';
  return ct.includes('application/json') ? res.json() : res.text();
}

// GET: ë‹¨ê±´ ì¡°íšŒ
export async function getPost(id) {
  return request(`/posts/${id}`);
}

// GET: ì¿¼ë¦¬ìŠ¤íŠ¸ë§ìœ¼ë¡œ í•„í„°ë§ (URLSearchParams ì‚¬ìš©)
export async function getCommentsByPost(postId) {
  const qs = new URLSearchParams({ postId });
  return request(`/comments?${qs}`);
}

// POST: ìƒˆ ë¦¬ì†ŒìŠ¤ ìƒì„± (FormData ì‚¬ìš©)
export async function createPost({ title, body, userId }) {
  const form = new FormData();
  form.append('title', title);
  form.append('body', body);
  form.append('userId', String(userId));
  return request('/posts', { method: 'POST', body: form });
}

// PUT: ì „ì²´ ìˆ˜ì • (í•„ìš”í•œ í•„ë“œë§Œ ë„£ì–´ë„ ì˜ˆì œ APIëŠ” í—ˆìš©)
export async function updatePost(id, { title, body, userId }) {
  const form = new FormData();
  if (title !== undefined) form.append('title', title);
  if (body !== undefined) form.append('body', body);
  if (userId !== undefined) form.append('userId', String(userId));
  return request(`/posts/${id}`, { method: 'PUT', body: form });
}

// DELETE: ì‚­ì œ
export async function deletePost(id) {
  return request(`/posts/${id}`, { method: 'DELETE' });
}

/* ì‚¬ìš© ì˜ˆì‹œ (ì¶œë ¥/ë¡œê·¸ ì—†ìŒ)
(async () => {
  const post = await getPost(1);
  const comments = await getCommentsByPost(1);
  const created = await createPost({ title: 'foo', body: 'bar', userId: 1 });
  const updated = await updatePost(1, { title: 'Updated Title' });
  const deleted = await deletePost(1);
})();
*/
```

### ğŸ“Œ 1-2. header ì „ì†¡
- url: ìš”ì²­ì„ ë³´ë‚¼ ì—”ë“œí¬ì¸íŠ¸(httpbin.org/headersëŠ” ìš”ì²­ í—¤ë”ë¥¼ ê·¸ëŒ€ë¡œ ëŒë ¤ì¤Œ).
- authToken: ì¸ì¦ í† í° ì˜ˆì‹œ(ì‹¤ë¬´ì—ì„  ë¡œê·¸ì¸ ë“±ìœ¼ë¡œ ë°œê¸‰ë°›ì€ ê°’ ì‚¬ìš©, ë³´í†µ Bearer <token>).
- options.headers:
- Content-Type: GETì—” ì¼ë°˜ì ìœ¼ë¡œ ë¶ˆí•„ìš”í•˜ì§€ë§Œ, í—¤ë” ì„¤ì • ì˜ˆì‹œë¡œ í¬í•¨.
- Authorization: ì¸ì¦ ì •ë³´ ì „ë‹¬.
- X-Custom-Header: ì»¤ìŠ¤í…€ í—¤ë” ì˜ˆì‹œ.
- fetch + await: ìš”ì²­/ì‘ë‹µì„ ë¹„ë™ê¸°ì ìœ¼ë¡œ ìˆ˜í–‰.
- response.ok ê²€ì‚¬: 2xxê°€ ì•„ë‹ˆë©´ ë³¸ë¬¸ì„ ì½ì–´ ì—ëŸ¬ throw.
- response.json(): ì •ìƒì¼ ë•Œ JSON íŒŒì‹± í›„ dataë¡œ í™œìš©.
```js
// headers_echo.js
(async () => {
  const url = 'https://httpbin.org/headers';
  const authToken = 'your-super-secret-auth-token';

  const options = {
    method: 'GET',
    headers: {
      // GETì—ëŠ” ë³´í†µ Content-Typeì´ í•„ìš” ì—†ì§€ë§Œ, ì˜ˆì‹œë¡œ í¬í•¨
      'Content-Type': 'application/json',
      // ë³´í†µì€ 'Bearer <token>' í˜•íƒœ
      'Authorization': authToken,
      'X-Custom-Header': 'MyCustomValue',
    },
  };

  try {
    const response = await fetch(url, options);
    if (!response.ok) {
      const errorText = await response.text().catch(() => '');
      throw new Error(`HTTP ${response.status} ${response.statusText || ''} ${errorText}`.trim());
    }
    const data = await response.json();
    // TODO: dataë¥¼ ì—¬ê¸°ì„œ ì‚¬ìš©í•˜ì„¸ìš” (ì˜ˆ: ìƒíƒœ ì €ì¥, ë°˜í™˜ ë“±)
  } catch (err) {
    // TODO: ë„¤íŠ¸ì›Œí¬/HTTP ì—ëŸ¬ ì²˜ë¦¬ ë¡œì§
  }
})();
```

### ğŸ“Œ 1-3. ì—ëŸ¬ì²˜ë¦¬ ë©”ì„¸ì§€
- fetchëŠ” ë„¤íŠ¸ì›Œí¬ ì¥ì• ë§Œ reject(DNS ì‹¤íŒ¨, ì˜¤í”„ë¼ì¸ ë“±).
- HTTP 4xx/5xxëŠ” res.okë¡œ ì§ì ‘ ê²€ì‚¬ í›„ ì—ëŸ¬ë¥¼ ë˜ì ¸ì•¼ í•œë‹¤.
- ì—ëŸ¬ ë³¸ë¬¸ì€ JSONì´ ì•„ë‹ ìˆ˜ ìˆìœ¼ë‹ˆ .text()ë¡œ ì•ˆì „í•˜ê²Œ ìˆ˜ì§‘í•œë‹¤.
```js
// http_error_example.js
(async () => {
  const url = 'https://jsonplaceholder.typicode.com/posts/9999';

  try {
    const res = await fetch(url);

    // HTTP ì—ëŸ¬(4xx, 5xx)ëŠ” fetchê°€ rejectí•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ì§ì ‘ ê²€ì‚¬
    if (!res.ok) {
      const body = await res.text().catch(() => '');
      const err = new Error(res.statusText || 'HTTP Error');
      err.status = res.status;   // ì˜ˆ: 404, 500
      err.body = body;           // ì—ëŸ¬ ì‘ë‹µ ë³¸ë¬¸(ë¬¸ìì—´)
      throw err;
    }

    // ì •ìƒ(2xx)ì¼ ë•Œë§Œ JSON íŒŒì‹±
    const data = await res.json();
    // TODO: data ì‚¬ìš©
  } catch (e) {
    // ë„¤íŠ¸ì›Œí¬ ì¥ì• (fetch ìì²´ ì‹¤íŒ¨) ë˜ëŠ” ìœ„ì—ì„œ throwí•œ HTTP ì—ëŸ¬ê°€ ì—¬ê¸°ë¡œ ì˜´
    // e.statusê°€ ìˆìœ¼ë©´ HTTP ì—ëŸ¬, ì—†ìœ¼ë©´ ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬ë¡œ ë³¼ ìˆ˜ ìˆìŒ
    // TODO: ì—ëŸ¬ ì²˜ë¦¬ (ì˜ˆ: ìƒíƒœì½”ë“œë³„ ë¶„ê¸°, ì‚¬ìš©ì ë©”ì‹œì§€ í‘œì‹œ, ì¬ì‹œë„ ë“±)
  }
})();
```

# ğŸ“Œ 2. open api ì—°ë™
### ğŸ“Œ 2-1. chat gptì—°ë™í•˜ê¸°
- ë¨¼ì € OpenAI Platformì— ê°€ì…í•˜ê³  API Keys ë©”ë‰´ë¡œ ì´ë™í•˜ì—¬ Create new secret key ë²„íŠ¼ì„ í´ë¦­í•´ ìƒˆë¡œìš´ í‚¤ë¥¼ ìƒì„±í•œë‹¤.
- .env íŒŒì¼ì„ ìƒì„±í•˜ê³  OPENAI_API_KEY="ë°œê¸‰ë°›ì€_API_í‚¤"ë¡œ í‚¤ë¥¼ ì ì–´ë„£ëŠ”ë‹¤.
- .env â†’ OPENAI_API_KEY ì½ì–´ì„œ ì—†ìœ¼ë©´ ì¦‰ì‹œ ì—ëŸ¬.
- fetchHelper.postë¡œ Content-Type: application/json + Authorization í—¤ë” ì„¤ì •.
- ì‘ë‹µì—ì„œ choices[0].message.contentë§Œ ë½‘ì•„ ë¬¸ìì—´ë¡œ ë°˜í™˜.
- ë¡œê¹…/ì½˜ì†” ì¶œë ¥ ì—†ìŒ(í˜¸ì¶œí•œ ìª½ì—ì„œ ê²°ê³¼ë¥¼ í‘œì‹œí•˜ê±°ë‚˜ ì €ì¥).
```js
// openaiChat.js
import dotenv from 'dotenv';
import fetchHelper from '../helpers/FetchHelper.js';

dotenv.config();

const API_URL = 'https://api.openai.com/v1/chat/completions';
const API_KEY = process.env.OPENAI_API_KEY;
if (!API_KEY) throw new Error('Missing OPENAI_API_KEY');

export async function chat(prompt) {
  const params = {
    model: 'gpt-3.5-turbo',
    messages: [
      { role: 'system', content: 'You are a helpful assistant.' },
      { role: 'user', content: prompt },
    ],
    max_tokens: 1000,
    temperature: 0.7,
  };

  const headers = {
    'Content-Type': 'application/json',
    Authorization: `Bearer ${API_KEY}`,
  };

  const json = await fetchHelper.post(API_URL, params, headers);
  return json?.choices?.[0]?.message?.content ?? '';
}

/* ì‚¬ìš© ì˜ˆì‹œ
import { chat } from './openaiChat.js';
const answer = await chat('Node.jsì—ì„œ íŒŒì¼ ì‹œìŠ¤í…œì„ ë‹¤ë£¨ëŠ” ë°©ë²•ì„ ì„¤ëª…í•´ì¤˜.');
*/
```