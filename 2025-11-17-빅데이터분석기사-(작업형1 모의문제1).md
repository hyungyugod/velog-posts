# ğŸ“Œ 1. groupby, transform, unstack, pivot, melt ê°œë… ì •ë¦¬

## 1-1. groupbyì˜ ê¸°ë³¸ ì—­í• 

- `groupby`ëŠ” **ë°ì´í„°ë¥¼ ê·¸ë£¹ ë‹¨ìœ„ë¡œ ë‚˜ëˆ„ê³  ìš”ì•½(ì§‘ê³„)** í•˜ëŠ” ë„êµ¬ì´ë‹¤.
- ê¸°ë³¸ íë¦„:
  - ì–´ë–¤ ì»¬ëŸ¼(ë˜ëŠ” ì—¬ëŸ¬ ì»¬ëŸ¼)ì„ ê¸°ì¤€ìœ¼ë¡œ ê·¸ë£¹ì„ ë§Œë“ ë‹¤.
  - ê° ê·¸ë£¹ì— ëŒ€í•´ ì§‘ê³„ í•¨ìˆ˜(í•©, í‰ê· , ê°œìˆ˜ ë“±)ë¥¼ ì ìš©í•œë‹¤.
- ì˜ˆì‹œ:

```python
df.groupby("team")["score"].mean()
```

- ê²°ê³¼ëŠ” **ê·¸ë£¹ ìˆ˜ë§Œí¼ì˜ í–‰**ë§Œ ë‚¨ëŠ” ì¶•ì†Œëœ Series/DataFrameì´ë‹¤.
- ì •ë¦¬:
  - í–‰ ê°œìˆ˜ê°€ ì¤„ì–´ë“ ë‹¤.
  - ë¦¬í¬íŠ¸ìš©/ìš”ì•½ í…Œì´ë¸”ìš©ì— ì í•©í•˜ë‹¤.

## 1-2. groupby + transform ì˜ ì˜ë¯¸

- `transform`ì€ **ê·¸ë£¹ ì •ë³´ë¥¼ ì´ìš©í•´ì„œ, ì›ë˜ í–‰ ê°œìˆ˜ë¥¼ ìœ ì§€í•œ ì±„ë¡œ ê°’ì„ ë˜ëŒë ¤ ë¶™ì´ëŠ” ë„êµ¬**ì´ë‹¤.
- í•µì‹¬ íŠ¹ì§•:
  - ê·¸ë£¹ë³„ë¡œ í†µê³„ë¥¼ ê³„ì‚°í•˜ì§€ë§Œ,
  - ê²°ê³¼ë¥¼ **ë‹¤ì‹œ ê° í–‰ì— broadcast** í•´ì„œ ì›ë˜ ê¸¸ì´ ê·¸ëŒ€ë¡œ ëŒë ¤ì¤€ë‹¤.
- ì˜ˆì‹œ:

```python
df["team_mean"] = df.groupby("team")["score"].transform("mean")
```

- ì´ë ‡ê²Œ í•˜ë©´:
  - ê° í–‰ì— â€œìê¸°ê°€ ì†í•œ íŒ€ì˜ í‰ê·  ì ìˆ˜â€ê°€ ë“¤ì–´ê°„ë‹¤.
  - í–‰ ìˆ˜ëŠ” ì¤„ì§€ ì•ŠëŠ”ë‹¤.
- `agg` vs `transform`:
  - `agg` â†’ ê·¸ë£¹ë³„ë¡œ ì¤„ì–´ë“  ìš”ì•½ ê²°ê³¼ (reduce)
  - `transform` â†’ ê·¸ë£¹ë³„ ê³„ì‚° ê²°ê³¼ë¥¼ ì›ë˜ í–‰ì— ë˜ëŒë ¤ ë¶™ì¸ ê²°ê³¼ (transform)

## 1-3. transformì˜ ì „í˜•ì ì¸ í™œìš© íŒ¨í„´

1. **ê·¸ë£¹ ë‚´ í¸ì°¨ ê³„ì‚°**

```python
mean = df.groupby("team")["score"].transform("mean")
df["score_diff"] = df["score"] - mean
```

2. **ê·¸ë£¹ ë‚´ í‘œì¤€í™”(z-score)**

```python
g = df.groupby("team")["score"]
mean = g.transform("mean")
std = g.transform("std")
df["score_z"] = (df["score"] - mean) / std
```

3. **ê·¸ë£¹ë³„ í‰ê· ìœ¼ë¡œ ê²°ì¸¡ê°’ ì±„ìš°ê¸°**

```python
g = df.groupby("team")["score"]
df["score_filled"] = df["score"].fillna(g.transform("mean"))
```

- ìš”ì•½:
  - â€œê·¸ë£¹ ê¸°ë°˜ í”¼ì²˜ ì—”ì§€ë‹ˆì–´ë§â€ì— transformì´ í•µì‹¬ì ìœ¼ë¡œ ì“°ì¸ë‹¤.
  - `groupby + agg + merge` íŒ¨í„´ì„ í•œ ì¤„ë¡œ ì••ì¶•í•œ ëŠë‚Œì´ë‹¤.

---

## 1-4. meltì˜ ê°œë…ê³¼ ë§¤ê°œë³€ìˆ˜

### (1) meltì˜ ì—­í• 

- `melt`ëŠ” **wide í˜•ì‹ â†’ long í˜•ì‹**ìœ¼ë¡œ â€œë…¹ì´ëŠ”â€ í•¨ìˆ˜ì´ë‹¤.
- ì˜ˆì‹œ ì›ë³¸:

```python
df = pd.DataFrame({
    "name": ["A", "B"],
    "math": [90, 85],
    "english": [80, 88]
})
```

```python
pd.melt(df, id_vars="name", value_vars=["math", "english"])
```

- ê²°ê³¼:

| name | variable | value |
|------|----------|-------|
| A    | math     | 90    |
| A    | english  | 80    |
| B    | math     | 85    |
| B    | english  | 88    |

### (2) melt ì£¼ìš” ì¸ì

- `id_vars`
  - ë…¹ì´ì§€ ì•Šê³  ê·¸ëŒ€ë¡œ ìœ ì§€í•  ì»¬ëŸ¼ (ì‹ë³„ì ì—­í• ).
  - ì˜ˆ: `id_vars=["name"]`.

- `value_vars`
  - ë…¹ì¼ ëŒ€ìƒ ì»¬ëŸ¼ë“¤.
  - ì§€ì •í•˜ì§€ ì•Šìœ¼ë©´ `id_vars`ë¥¼ ì œì™¸í•œ ëª¨ë“  ì»¬ëŸ¼ì´ melt ëŒ€ìƒì´ ëœë‹¤.

- `var_name`
  - ë…¹ì—¬ì§„ ì»¬ëŸ¼ ì´ë¦„ë“¤ì´ ë“¤ì–´ê°ˆ ìƒˆ ì»¬ëŸ¼ ì´ë¦„.
  - ê¸°ë³¸ê°’ì€ `"variable"`.

- `value_name`
  - ë…¹ì—¬ì§„ ê°’ë“¤ì´ ë“¤ì–´ê°ˆ ìƒˆ ì»¬ëŸ¼ ì´ë¦„.
  - ê¸°ë³¸ê°’ì€ `"value"`.

- `col_level`
  - ì»¬ëŸ¼ì´ MultiIndexì¸ ê²½ìš°, ì–´ëŠ ë ˆë²¨ì„ meltí• ì§€ ì§€ì •.
  - MultiIndex ì»¬ëŸ¼ì„ ë‹¤ë£° ë•Œë§Œ ì˜ë¯¸ê°€ ìˆë‹¤.

- `ignore_index`
  - ê¸°ë³¸ê°’ `True`: ì¸ë±ìŠ¤ë¥¼ 0ë¶€í„° ë‹¤ì‹œ ë§¤ê¸´ë‹¤.
  - `False`: ê¸°ì¡´ ì¸ë±ìŠ¤ë¥¼ ìœ ì§€í•œë‹¤.

### (3) meltì˜ í•µì‹¬ êµ¬ì¡°

- ê°œë…ì ìœ¼ë¡œ:

> id_varsëŠ” ê·¸ëŒ€ë¡œ ë‘ê³   
> value_varsë¥¼ ë…¹ì—¬ì„œ  
> `var_name` / `value_name` ì»¬ëŸ¼ìœ¼ë¡œ â€œí–‰ì„ ëŠ˜ë¦°ë‹¤â€.

- long í˜•ì‹ìœ¼ë¡œ ë°”ê¾¼ ë’¤, ë‹¤ì‹œ `pivot`ì´ë‚˜ `pivot_table`ë¡œ wide í˜•ì‹ìœ¼ë¡œ ë˜ëŒë¦´ ìˆ˜ ìˆë‹¤.

---

## 1-5. groupby + unstackê³¼ pivot_table

### (1) groupby + unstack íë¦„

```python
g = df.groupby(["team", "year"])["score"].sum()
```

- ê²°ê³¼: ì¸ë±ìŠ¤ê°€ $(team, year)$ì¸ MultiIndex Series.

```python
g.unstack()
```

- yearë¥¼ ì—´ ë°©í–¥ìœ¼ë¡œ í¼ì¹œ í‘œ í˜•íƒœê°€ ëœë‹¤.
- ì´ê²ƒì€ ì‚¬ì‹¤ìƒ `pivot_table(index="team", columns="year", values="score", aggfunc="sum")`ì™€ ê°™ì€ êµ¬ì¡°ì´ë‹¤.

### (2) unstackì˜ ì—­í• 

- MultiIndexì˜ íŠ¹ì • ë ˆë²¨ì„ ì»¬ëŸ¼ ìª½ìœ¼ë¡œ ì˜¬ë ¤ì„œ **í”¼ë²—(pivot)** í•˜ëŠ” ê¸°ëŠ¥.
- ì¸ë±ìŠ¤ êµ¬ì¡°ê°€:

  - $(A, 2020)$  
  - $(A, 2021)$  
  - $(B, 2020)$ â€¦

  ì´ëŸ° í˜•íƒœì¼ ë•Œ, `unstack(level=1)`ì€ ë‘ ë²ˆì§¸ ë ˆë²¨(ì˜ˆ: year)ì„ ì—´ë¡œ ë³´ë‚¸ë‹¤.

### (3) pivot_table ë§¤ê°œë³€ìˆ˜

```python
pd.pivot_table(
    df,
    values="score",
    index="team",
    columns="year",
    aggfunc="mean",   # ë˜ëŠ” "sum", ["mean","max"], dict ë“±
    fill_value=None,
    margins=False,
    margins_name="All",
    dropna=True,
    sort=True
)
```

- `data`: ì‚¬ìš©í•  DataFrame.
- `values`: ì§‘ê³„í•  ê°’ ì»¬ëŸ¼.
- `index`: í–‰ ë°©í–¥ ê¸°ì¤€.
- `columns`: ì—´ ë°©í–¥ ê¸°ì¤€.
- `aggfunc`: ì§‘ê³„ í•¨ìˆ˜ (ê¸°ë³¸ê°’ `"mean"`).
- `fill_value`: NaNì„ ì±„ìš¸ ê°’.
- `margins`: í–‰/ì—´ í•©ê³„(ì´í•©) í‘œì‹œ ì—¬ë¶€.
- `margins_name`: í•©ê³„ ë¼ë²¨ ì´ë¦„ (ê¸°ë³¸ `"All"`).
- `dropna`: NAë§Œ ìˆëŠ” column level ì œê±° ì—¬ë¶€.
- `sort`: index/columns ì •ë ¬ ì—¬ë¶€.

### (4) pivot vs pivot_table ì°¨ì´

- `pivot`:
  - ì§‘ê³„ ì—†ìŒ.
  - $index 	imes columns$ ì¡°í•©ì´ ì¤‘ë³µë˜ë©´ ì˜¤ë¥˜.
  - ë‹¨ìˆœ êµ¬ì¡° ë³€í™˜ìš©.

- `pivot_table`:
  - ì§‘ê³„ ìˆìŒ.
  - ì¤‘ë³µ ì¡°í•© ê°€ëŠ¥ (aggfuncë¡œ ì²˜ë¦¬).
  - ì—‘ì…€ í”¼ë²— í…Œì´ë¸”ê³¼ ê°™ì€ ì—­í• .

---

# ğŸ“Œ 2. iloc, astype, selector/setter ë™ì‘ ì´í•´

## 2-1. ilocìœ¼ë¡œ ì¡°íšŒ vs ilocìœ¼ë¡œ ëŒ€ì…

- `ndf.iloc[-1]`ì˜ ë™ì‘ì€ ë‘ ìƒí™©ìœ¼ë¡œ ë‚˜ë‰œë‹¤.

1. **ì¡°íšŒë§Œ í•  ë•Œ**

```python
row = ndf.iloc[-1]
```

- `row`ëŠ” Series ë³µì‚¬ë³¸ì´ë‹¤.
- ì´ Seriesë¥¼ ìˆ˜ì •í•´ë„ ì›ë³¸ DataFrameì€ ë°”ë€Œì§€ ì•ŠëŠ”ë‹¤.

2. **ëŒ€ì…í•  ë•Œ**

```python
ndf.iloc[-1] = something
```

- ì´ ê²½ìš°ì—ëŠ” `iloc`ì´ ì„ íƒìë¡œ ë™ì‘í•˜ê³ ,
- ë‚´ë¶€ì ìœ¼ë¡œ `__setitem__` / `Indexer.setitem`ì´ í˜¸ì¶œë˜ì–´ **ì›ë³¸ DataFrameì˜ í•´ë‹¹ í–‰ì´ ì‹¤ì œë¡œ ìˆ˜ì •**ëœë‹¤.

- í•µì‹¬:
  - `ndf.iloc[-1]`ì´ í¬ì¸í„°ë¼ì„œ ìë™ìœ¼ë¡œ ë°”ë€ŒëŠ” ê²ƒì´ ì•„ë‹ˆë¼,
  - `ndf.iloc[-1] = ...`ë¼ëŠ” **ëŒ€ì… ë¬¸ë²•ì„ pandasê°€ ê°€ë¡œì±„ì„œ ì›ë³¸ì— ë°˜ì˜**í•œë‹¤.

### 2-1-1. ìŠ¤ì¹¼ë¼ vs Series

- `ndf.iloc[-1, 0]`
  - ë‹¨ì¼ ê°’(ìŠ¤ì¹¼ë¼)ì„ ë°˜í™˜.
  - `ndf.iloc[-1, 0] = int(ndf.iloc[-1, 0])` â†’ ì •ìƒ.

- `ndf.iloc[-1]`
  - í–‰ ì „ì²´ë¥¼ ë‚˜íƒ€ë‚´ëŠ” Seriesë¥¼ ë°˜í™˜.
  - `int(ndf.iloc[-1])` â†’ Series ì „ì²´ë¥¼ ì •ìˆ˜ í•˜ë‚˜ë¡œ ë°”ê¿€ ìˆ˜ ì—†ìœ¼ë¯€ë¡œ ì˜¤ë¥˜.
  - í–‰ ì „ì²´ í˜•ë³€í™˜ì„ í•˜ë ¤ë©´:

```python
ndf.iloc[-1] = ndf.iloc[-1].astype(int)
```

---

## 2-2. astypeì˜ ì—­í• 

- `astype`ì€ **Series(ë˜ëŠ” DataFrame) ì „ì²´ì— ëŒ€í•´ íƒ€ì… ë³€í™˜ì„ ì¼ê´„ ì ìš©**í•˜ëŠ” ë²¡í„° ì—°ì‚°ì´ë‹¤.

- ì˜ˆ:

```python
s = ndf.iloc[-1]       # Series
s2 = s.astype(int)     # ì‹œë¦¬ì¦ˆ ì „ì²´ë¥¼ í•œ ë²ˆì— intë¡œ ë³€í™˜
```

- íŠ¹ì§•:
  - ê° ì›ì†Œì— ì¼ì¼ì´ `int()`ë¥¼ ì ìš©í•˜ëŠ” ëŒ€ì‹ , í•œ ë²ˆì— ì „ì²´ ë³€í™˜.
  - ë‚´ë¶€ì ìœ¼ë¡œ NumPy ê¸°ë°˜ ë²¡í„°í™” ì—°ì‚°ì´ë¼ íš¨ìœ¨ì .
  - â€œì´ ì—´ì€ ì•ìœ¼ë¡œ ì´ íƒ€ì…ìœ¼ë¡œ ì“¸ ê±°ë‹¤â€ë¼ëŠ” ì„ ì–¸ì ì¸ ì˜ë¯¸ë¥¼ ê°€ì§„ë‹¤.

- `apply(int)`ì™€ì˜ ì°¨ì´:
  - `apply(int)`ëŠ” íŒŒì´ì¬ ë ˆë²¨ ë£¨í”„ì— ê°€ê¹ê³  ëŠë¦´ ìˆ˜ ìˆë‹¤.
  - `astype(int)`ëŠ” pandas/NumPyê°€ ì˜ˆìƒí•˜ëŠ” **ì¼ê´€ëœ dtype**ì„ ê°•ì œí•˜ê³ , ë¹ ë¥´ë‹¤.

---

## 2-3. selector + setter íŒ¨í„´ì„ ë”°ë¥´ëŠ” pandas ì ‘ê·¼ ë°©ë²•ë“¤

ë‹¤ìŒê³¼ ê°™ì€ ê²ƒë“¤ì€ **ì¡°íšŒ ì‹œì—ëŠ” ë³µì‚¬ë³¸ì²˜ëŸ¼ ë³´ì´ì§€ë§Œ, ëŒ€ì… ì‹œì—ëŠ” ì›ë³¸ì„ ìˆ˜ì •**í•˜ëŠ” ì¸í„°í˜ì´ìŠ¤ë¥¼ ê°€ì§„ë‹¤.

1. `df.loc[...]`  
2. `df.iloc[...]`  
3. `df.at[...]`  
4. `df.iat[...]`  
5. `df['col'] = ...`  
6. `df[mask] = ...`  
7. `df[0:3] = ...`  

- ì¡°íšŒ:

```python
s = df["col"]          # ë³´í†µ Series ë³µì‚¬ë³¸
row = df.iloc[0]       # Series ë³µì‚¬ë³¸
val = df.at[idx, "col"]  # ìŠ¤ì¹¼ë¼
```

- ëŒ€ì…:

```python
df.loc[idx, "col"] = 10
df.iloc[0] = [1, 2, 3]
df.at[idx, "col"] = 99
df["new"] = df["a"] + df["b"]
df[df["score"] < 0] = 0
```

- ê³µí†µì :
  - â€œì¡°íšŒìš© í‘œí˜„ì‹â€ê³¼ â€œëŒ€ì…ìš© í‘œí˜„ì‹â€ì´ ë¬¸ë²•ì ìœ¼ë¡œ ê°™ì§€ë§Œ,
  - ëŒ€ì…ì´ ë“¤ì–´ì˜¬ ë•Œ pandasê°€ ì´ë¥¼ í•´ì„í•´ì„œ **ì›ë³¸ì„ ê°±ì‹ í•˜ëŠ” setterë¡œ ë™ì‘**í•˜ë„ë¡ êµ¬í˜„ë˜ì–´ ìˆë‹¤.

- ë°˜ëŒ€ë¡œ `head`, `tail`, `sort_values`, `reset_index`, `drop`(inplace=False), `rename`(inplace=False) ë“±ì€ ê¸°ë³¸ì ìœ¼ë¡œ **ì¡°íšŒ ì „ìš©**ì´ë©°, ëŒ€ì… ì—°ì‚°ì„ ì§ì ‘ ì§€ì›í•˜ì§€ ì•ŠëŠ”ë‹¤.

---

# ğŸ“Œ 3. ê²°ì¸¡ì¹˜ ì²˜ë¦¬ì™€ dropna, subset, df70 ê´€ë ¨ ê°œë…

## 3-1. dropnaì˜ ê¸°ë³¸ ë™ì‘

- `dropna()`ëŠ” **ê²°ì¸¡ê°’(NaN, None ë“±)ì´ ìˆëŠ” í–‰ ë˜ëŠ” ì—´ì„ ì œê±°**í•˜ëŠ” í•¨ìˆ˜ì´ë‹¤.

- ê¸°ë³¸ê°’:
  - `axis=0` (í–‰ ê¸°ì¤€)
  - `how='any'` (í•˜ë‚˜ë¼ë„ NaNì´ ìˆìœ¼ë©´ ì œê±°)

- ì£¼ìš” ì˜µì…˜:

1. `axis`
   - `axis=0` ë˜ëŠ” `'index'`: í–‰ ì œê±°
   - `axis=1` ë˜ëŠ” `'columns'`: ì—´ ì œê±°

2. `how`
   - `'any'`: í•˜ë‚˜ë¼ë„ NaNì´ ìˆìœ¼ë©´ ì œê±°
   - `'all'`: ëª¨ë“  ê°’ì´ NaNì¼ ë•Œë§Œ ì œê±°

3. `thresh`
   - ìœ íš¨í•œ ê°’(ë¹„-NaN) ê°œìˆ˜ê°€ ìµœì†Œ $thresh$ê°œ ì´ìƒì¸ í–‰/ì—´ë§Œ ìœ ì§€.

4. `subset`
   - íŠ¹ì • ì»¬ëŸ¼(ë¶€ë¶„ì§‘í•©)ì— ëŒ€í•´ì„œë§Œ ê²°ì¸¡ ì—¬ë¶€ë¥¼ ê²€ì‚¬.
   - `df.dropna(subset=['views'])` â†’ `views`ê°€ NaNì¸ í–‰ë§Œ ì œê±°.

5. `inplace`
   - `True`ì´ë©´ ì›ë³¸ì„ ì§ì ‘ ìˆ˜ì •, `False`ì´ë©´ ìƒˆë¡œìš´ DataFrameì„ ë°˜í™˜.

---

## 3-2. subsetì˜ ì˜ë¯¸ì™€ ì–´ì›

- `subset` = `sub` + `set`
  - `sub`: ì•„ë˜, ë¶€ë¶„
  - `set`: ì§‘í•©
  - â‡’ ì „ì²´ ì§‘í•©ì˜ â€œë¶€ë¶„ ì§‘í•©â€.

- DataFrame ê´€ì ì—ì„œ:
  - ì „ì²´ ì»¬ëŸ¼ ì§‘í•©ì—ì„œ **ì¼ë¶€ ì»¬ëŸ¼ë§Œ ê³¨ë¼ì„œ(ë¶€ë¶„ ì§‘í•©)** ê·¸ ì»¬ëŸ¼ë“¤ì— ëŒ€í•´ì„œë§Œ ê²°ì¸¡ê°’ ì—¬ë¶€ë¥¼ ê²€ì‚¬í•˜ê² ë‹¤ëŠ” ëœ».
- ì˜ˆ:

```python
df.dropna(subset=["views"])
```

- í•´ì„:
  - ì „ì²´ ì»¬ëŸ¼ì´ ì•„ë‹ˆë¼ `"views"`ë¼ëŠ” ì»¬ëŸ¼ ì§‘í•©(ë¶€ë¶„ ì§‘í•©)ì— ëŒ€í•´ì„œë§Œ NaNì„ í™•ì¸í•˜ê³ ,
  - ê·¸ ì»¬ëŸ¼ì— NaNì´ ìˆëŠ” í–‰ì„ ì œê±°í•œë‹¤.
  - ë‹¤ë¥¸ ì»¬ëŸ¼ì— NaNì´ ìˆë”ë¼ë„ `"views"`ê°€ NaNì´ ì•„ë‹ˆë©´ ê·¸ í–‰ì€ ìœ ì§€ëœë‹¤.

---

## 3-3. df["views"] = df["views"].dropna() ê°€ ì˜ë„ëŒ€ë¡œ ì‘ë™í•˜ì§€ ì•ŠëŠ” ì´ìœ 

- `df["views"].dropna()`ëŠ” ë‹¤ìŒì„ ìˆ˜í–‰í•œë‹¤.
  - `views` ì»¬ëŸ¼ì—ì„œ NaNì´ ìˆëŠ” ìœ„ì¹˜ë§Œ ì œê±°ëœ **ìƒˆë¡œìš´ Series**ë¥¼ ë°˜í™˜.
  - ì´ SeriesëŠ” ê¸¸ì´ê°€ ì¤„ì–´ ìˆìœ¼ë©°, ì¸ë±ìŠ¤ë„ â€œê²°ì¸¡ì¹˜ ìˆë˜ ìœ„ì¹˜â€ê°€ ë¹ ì§„ ìƒíƒœ.

- ì´ë¥¼ ë‹¤ì‹œ `df["views"]`ì— ëŒ€ì…í•˜ë©´:
  - pandasëŠ” ì¸ë±ìŠ¤ë¥¼ ê¸°ì¤€ìœ¼ë¡œ align(ì •ë ¬) í•˜ë ¤ê³  ì‹œë„í•œë‹¤.
  - í–‰ì„ ì‚­ì œí•œ ê²ƒì´ ì•„ë‹ˆë¼, **ê¸¸ì´ì™€ ì¸ë±ìŠ¤ê°€ ì–´ê¸‹ë‚œ Seriesë¥¼ ì–µì§€ë¡œ ë¼ì›Œ ë§ì¶”ëŠ”** ìƒí™©ì´ ëœë‹¤.
  - ê·¸ ê²°ê³¼:
    - ì˜ˆìƒê³¼ ë‹¤ë¥´ê²Œ NaNì´ ìƒê¸°ê±°ë‚˜,
    - í–‰ ìì²´ëŠ” ê·¸ëŒ€ë¡œ ìˆëŠ”ë° ê°’ë§Œ ì´ìƒí•˜ê²Œ ì •ë ¬ë˜ëŠ” ê²°ê³¼ê°€ ë‚˜ì˜¨ë‹¤.

- í–‰ ìì²´ë¥¼ ì œê±°í•˜ë ¤ë©´:

```python
df = df.dropna(subset=["views"])
```

- ì´ ì½”ë“œëŠ”:
  - `views`ê°€ NaNì¸ í–‰ì„ ì™„ì „íˆ ì œê±°í•˜ì—¬,
  - DataFrameì˜ í–‰ ê°œìˆ˜ì™€ ì¸ë±ìŠ¤ë¥¼ ì¼ê´€ë˜ê²Œ ìœ ì§€í•œë‹¤.

---

## 3-4. df70, quantile ê´€ë ¨ ê°œë…

### (1) df70["views"].quantile(.75)ê°€ ì•ˆ ë˜ëŠ” ì´ìœ 

- `df70 = df["views"].iloc[:70]`ì™€ ê°™ì´ ì •ì˜í•œ ê²½ìš°:
  - `df70`ì€ ì´ë¯¸ `"views"` ì»¬ëŸ¼ ë°ì´í„°ë§Œ ë‹´ê³  ìˆëŠ” **Series**ì´ë‹¤.
- Seriesì—ì„œ ë‹¤ì‹œ `"views"` ì»¬ëŸ¼ ì´ë¦„ìœ¼ë¡œ ì¸ë±ì‹±í•˜ë ¤ í•˜ë©´:

```python
df70["views"]
```

- SeriesëŠ” ì»¬ëŸ¼ ì´ë¦„ ê°œë…ì´ ì—†ê³ , ì¸ë±ìŠ¤ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ê°’ì— ì ‘ê·¼í•˜ê¸° ë•Œë¬¸ì— `KeyError`ê°€ ë°œìƒí•œë‹¤.
- ì˜¬ë°”ë¥¸ ì‚¬ìš©:

```python
df70.quantile(.75)
df70.quantile(.25)
```

### (2) 70% ë°ì´í„° ì„ íƒì˜ ì˜¬ë°”ë¥¸ í•´ì„

- ë¬¸ì œ ì˜ë„:
  - ì „ì²´ í–‰ì˜ $70\%$ ì§€ì ê¹Œì§€ì˜ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´, ê¸¸ì´ $	imes 0.7$ì„ **ì¸ë±ìŠ¤ë¡œ ì“°ê¸° ìœ„í•´ ì •ìˆ˜ë¡œ ë³€í™˜**í•´ì•¼ í•œë‹¤.
- ì¼ë°˜ì ì¸ íŒ¨í„´:

```python
n_70 = int(len(df) * 0.7)
df70 = df[:n_70]
```

- ì—¬ê¸°ì„œ int ë³€í™˜ì€ **ê°’ì„ intë¡œ ë§Œë“œëŠ” ê²ƒ(í˜•ë³€í™˜)** ì´ ì•„ë‹ˆë¼,
  - ìŠ¬ë¼ì´ì‹±ì— ì‚¬ìš©í•  **ìœ„ì¹˜ ì¸ë±ìŠ¤**ë¥¼ ì •ìˆ˜ë¡œ ë§Œë“œëŠ” ìš©ë„ì´ë‹¤.

---

# ğŸ“Œ 4. cond_a, ë¶ˆë¦¬ì–¸ ì¸ë±ì‹±, A/B ì»¬ëŸ¼ ì²˜ë¦¬

## 4-1. df[cond_a]ê°€ ì•ˆ ë˜ëŠ” ì´ìœ 

- `cond_a = df.isna().sum() >= 100 * 0.3` ì™€ ê°™ì´ ë§Œë“¤ë©´:
  - `df.isna().sum()`ì€ **ê° ì»¬ëŸ¼ë³„ ê²°ì¸¡ ê°œìˆ˜**ë¥¼ ì„¸ê¸° ë•Œë¬¸ì—,
  - `cond_a`ì˜ ì¸ë±ìŠ¤ëŠ” â€œì»¬ëŸ¼ ì´ë¦„â€ì´ë‹¤.
- ë°˜ë©´, `df[cond_a]`ì—ì„œ boolean ì¸ë±ì‹±ì„ ì‚¬ìš©í•  ë•Œ:
  - `cond_a`ëŠ” **í–‰ ì¸ë±ìŠ¤(index)** ì™€ ê¸¸ì´ê°€ ë™ì¼í•´ì•¼ í•œë‹¤.
- ì¦‰,
  - `cond_a`ì˜ ì¸ë±ìŠ¤: ì»¬ëŸ¼ ì´ë¦„
  - `df`ì˜ ì¸ë±ìŠ¤: í–‰ ë²ˆí˜¸
  - â‡’ ì„œë¡œ ë‹¤ë¥´ë¯€ë¡œ `IndexingError`ê°€ ë°œìƒí•œë‹¤.

- ì»¬ëŸ¼ì„ ì¡°ê±´ìœ¼ë¡œ ì„ íƒí•˜ê³  ì‹¶ë‹¤ë©´:

```python
na_ratio = df.isna().mean()
A_cols = na_ratio[na_ratio >= 0.3].index
B_cols = na_ratio[(na_ratio >= 0.2) & (na_ratio < 0.3)].index

# ì˜ˆ: Aì— í•´ë‹¹í•˜ëŠ” ì»¬ëŸ¼ ì‚­ì œ
df = df.drop(columns=A_cols)
```

- ì´ëŸ° ì‹ìœ¼ë¡œ **ì»¬ëŸ¼ ì¸ë±ìŠ¤ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì²˜ë¦¬**í•´ì•¼ í•œë‹¤.

---

## 4-2. A ì»¬ëŸ¼(f1)ì— ëŒ€í•œ ì²˜ë¦¬ ì°¨ì´

- ë¬¸ì œ ìš”êµ¬:
  - Aì— í•´ë‹¹í•˜ëŠ” ì»¬ëŸ¼ì€, **ê·¸ ì»¬ëŸ¼ì— ê²°ì¸¡ì¹˜ê°€ ìˆëŠ” í–‰ì„ ì‚­ì œ**í•œë‹¤.
- ì •ë‹µ í’€ì´:

```python
df = df.dropna(subset=['f1'])
```

- í•´ì„:
  - `f1`ì´ NaNì¸ í–‰ë§Œ ì œê±°.
  - `f1` ì»¬ëŸ¼ ìì²´ëŠ” ìœ ì§€.

- ì˜ëª»ëœ í•´ì„ ì˜ˆ:

```python
df = df.drop("f1", axis=1)
```

- ì´ëŠ” `f1` ì»¬ëŸ¼ ì „ì²´ë¥¼ ì‚­ì œí•˜ëŠ” ì½”ë“œë¡œ,
  - â€œA ì»¬ëŸ¼ì˜ ê²°ì¸¡ì¹˜ê°€ ìˆëŠ” í–‰ì„ ì œê±°í•˜ë¼â€ëŠ” ë¬¸ì œ ì˜ë„ì™€ ë‹¤ë¥´ë‹¤.

---

## 4-3. B ì»¬ëŸ¼(f3) ê²°ì¸¡ì¹˜ ì²˜ë¦¬ì—ì„œ ë†“ì¹œ ë¶€ë¶„

- ì˜ë„í•œ ì½”ë“œ:

```python
df["f3"] = df["f3"].fillna(df["f3"].mode()[0])
```

- ì˜ëª»ëœ ì½”ë“œ:

```python
df["f3"].fillna(df["f3"].mode()[0])
```

- ì°¨ì´:
  - `fillna`ì˜ ê¸°ë³¸ê°’ì€ `inplace=False`.
  - ë”°ë¼ì„œ **ìƒˆë¡œìš´ Seriesë¥¼ ë°˜í™˜**í•  ë¿, ì›ë³¸ `df["f3"]`ëŠ” ë°”ë€Œì§€ ì•ŠëŠ”ë‹¤.
  - ì˜¬ë°”ë¥´ê²Œ ì ìš©í•˜ë ¤ë©´ ë°˜í™˜ê°’ì„ ë‹¤ì‹œ ëŒ€ì…í•´ì•¼ í•œë‹¤.

- ê²°ë¡ :
  - ê²°ì¸¡ ëŒ€ì²´ í›„ ì›ë³¸ì— ë°˜ì˜í•˜ë ¤ë©´ ë°˜ë“œì‹œ **ëŒ€ì…**ì„ í•´ì•¼ í•œë‹¤.
  - ì˜ˆ: `df["col"] = df["col"].fillna(...)`.

---

# ğŸ“Œ 5. f3 ì¸ì½”ë”©ê³¼ map/replace/apply ë¹„êµ

## 5-1. apply + ì‚¬ìš©ì ì •ì˜ í•¨ìˆ˜ ë°©ì‹

- ì˜ˆì‹œ:

```python
def enc(data):
    if data == 'silver':
        return 1
    elif data == 'gold':
        return 2
    elif data == 'vip':
        return 3
    else:
        return data

df["f3"] = df["f3"].apply(enc)
```

- ì¥ì :
  - ë¡œì§ì´ ì§ê´€ì ì´ê³  í™•ì¥í•˜ê¸° ì‰½ë‹¤.
  - ì¡°ê±´ì´ ë³µì¡í•  ë•Œ êµ¬í˜„ì´ í¸í•˜ë‹¤.
- ë‹¨ì :
  - íŒŒì´ì¬ ë ˆë²¨ for-loopì— ê°€ê¹Œì›Œ ëŠë¦´ ìˆ˜ ìˆë‹¤.
  - ë²¡í„°í™”ëœ ì—°ì‚°(map, replace)ì— ë¹„í•´ ì„±ëŠ¥ì´ ë–¨ì–´ì§ˆ ìˆ˜ ìˆë‹¤.

---

## 5-2. replace / map ì´ìš©í•œ ë²¡í„°í™” ì¸ì½”ë”©

### (1) replace ì²´ì¸ ë°©ì‹

```python
import numpy as np

df["f3"] = (
    df["f3"]
      .replace(np.nan, 0)
      .replace("silver", 1)
      .replace("gold", 2)
      .replace("vip", 3)
)
```

- í•œ ì¤„ë¡œ ê²°ì¸¡ì¹˜ì™€ ë¬¸ìì—´ì„ ëª¨ë‘ ìˆ«ìë¡œ ì¹˜í™˜.
- ê°€ë…ì„±ì´ ë‚˜ì˜ì§€ ì•Šê³ , íŒë‹¤ìŠ¤ìŠ¤ëŸ¬ìš´ í‘œí˜„.

### (2) dict + map ë°©ì‹

```python
import numpy as np

mapping = {np.nan: 0, "silver": 1, "gold": 2, "vip": 3}
df["f3"] = df["f3"].map(mapping)
```

- ì¹´í…Œê³ ë¦¬ â†’ ì½”ë“œê°’ ë§¤í•‘ì˜ ì „í˜•ì ì¸ íŒ¨í„´.
- ë¨¸ì‹ ëŸ¬ë‹ìš© í”¼ì²˜ ì¸ì½”ë”©ì—ì„œë„ ìì£¼ ì‚¬ìš©í•˜ëŠ” ìŠ¤íƒ€ì¼ì´ë‹¤.

---

## 5-3. boolean ì¹´ìš´íŠ¸ + ê°€ì¤‘ì¹˜ ë°©ì‹

```python
r1 = (df["f3"] == "silver").sum() * 1
r2 = (df["f3"] == "gold").sum()   * 2
r3 = (df["f3"] == "vip").sum()    * 3
result = r1 + r2 + r3
```

- ê° ì¹´í…Œê³ ë¦¬ë³„ ê°œìˆ˜ë¥¼ ì„¸ê³ , ê°€ì¤‘ì¹˜ë¥¼ ê³±í•´ì„œ í•©ì‚°í•˜ëŠ” ë°©ì‹.
- ì „ì²´ ì¸ì½”ë”©ëœ ê°’ì„ í•„ìš”ë¡œ í•˜ëŠ” ê²½ìš°ì—ëŠ” map/replaceê°€ ë” ì¼ë°˜ì ì´ì§€ë§Œ,
  - íŠ¹ì • í•©ê³„/ì ìˆ˜ë§Œ í•„ìš”í•  ë•ŒëŠ” ì´ ë°©ì‹ë„ ì§ê´€ì ì´ë‹¤.

---
