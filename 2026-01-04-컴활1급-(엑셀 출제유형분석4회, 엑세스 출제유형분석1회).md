# 📌 1. 엑셀 출제유형분석4회
## 1-1. 고급필터
- 문제에서 value함수가 주어지지 않았을 경우 숫자 대소비교할때 문자열끼리 비교하는 방식을 가져야 한다.
- 만약 3보다 큰 수를 구해야 할때는 3번째로 큰수보다 크거나 같다라는 것을 활용한다. 그리고 이때 어떤 수보다 크다 자체가 조건인 경우 즉 비교 대상이 없는 경우는 부등호를 문자화해서 함수와 이어줘야 한다.
- 이때 비교대상이 없는 조건이 바로 일반식이고 이때는 필드명을 위에 적어주어야한다. 이때 논리식과 일반식을 같이 사용하는 것도 가능하다.
- 그냥 대상을 첫셀로 두고 식을 쓰면 그냥 논리식이 되는 것이다.
- ####으로 나오면 맨 위 셀 탭을 더블클릭하면 딱 맞게 펼쳐진다.

## 1-2. 조건부서식
- weekday함수는 요일을 나타내는 함수로 함수마법사에 설명이 다 나와있다.
- rank.eq는 범위를 절대화하여 설정하면 선택한 셀이 범위 안에 몇위인지 나타내주는 함수이다.
- or나 and함수는 다중조건 판단도 가능하다. 

> ="or(WEEKDAY($D3,2)>=6,RANK.EQ($G$3,$G3:$G$44)<=5)" 에서 처럼 하면 안된다. 고급필터도 행을 쭉 내려가면서 평가해야하므로 절대화 잘 풀어줘야하고 수식이 문자열로 입력될 경우 따옴표를 때주어야 한다. $G$3에서 앞에 절대화를 푼다는걸 뒤의 절대화를 풀었는데 이런 실수도 하면 안된다.

## 1-3. 페이지 레이아웃 설정
- 바닥글 편집에서 홀수, 짝수 페이지 바닥글을 따로 설정하는 기능이 있고 이를 체크하고 작성하면 따로 설정해서 작성할 수 있다.
- 인쇄제목이 반복되도록 하려면 특정 행이 매 페이지마다 반복적으로 인쇄되도록 하면 된다.

## 1-4. sumproduct 이용 계산문제
- sumproduct는 대응하는 값을 곱하고 그 값들을 곱하는 함수이다.
- 이는 곱할 대상함수 범위를 지정하고 전체범위를 지정하는 방식으로 사용한다.
- 300점 이상이면 300이 나오게 하려면 min함수를 이용해서 상한치를 제한해야한다.
- 배열 수식으로 풀라고 안하면 굳이 ctrl shift enter를 할 필요가 없다.

> SUMPRODUCT($C$3:$D$3,C18:D18)처럼 배열과 배열을 곱하고 어짜피 채우기 핸들을 사용할 것이기 때문에 한 배열씩만 선택해야한다.

## 1-5. 데이터베이스 함수 활용
- dcounta는 숫자 문자 모두의 개수를 센다.
- 채우기 드래그 안하면 굳이 절대화는 필요가 없다.
- 여기서 criteria를 설정할때 조건을 선택할때도 고급필터와 같은 and, or 판단법이 적용된다.
- 숫자 뒤에 문자를 붙여넣을때 &문자나 text 함수를 사용할 수 있다. text함수는 서식을 적용하는 함수이다. 이때 text의 서식인수는 셀 서식에서 처럼 #건 이런식으로 적용하면 된다. 프로시저에서는 같은 함수가 format이다.

## 1-6. if가 있는 배열수식 함수 활용
- 배열수식은 and나 or을 반드시 *이나 +를 사용해야한다.

## 1-7. if가 없는 배열수식 함수 활용
- 도출하는 값이 두 범위의 합일 경우 그냥 두범위의 합을 계산영역에서 그냥 연산해서 함께 곱해주면된다.

> {=SUM(($D$24:$D$46=J$41)*($E$24:$E$46=$I42)*($F$24:$F$46+$G$24:$G$46))}

## 1-8. 사용자 지정 서식
- select case 인수, case is >= 숫자 나 case 문자를 사용한다.
- else에 해당하는 것은 case else이다.
- 이때 퍼센트를 적을 수 없어서 100으로 나눠서 숫자로 적어준다.
- format(0.02,#%)이렇게만 해도 백분율 변환은 충분하다.
- 아래처럼 format에서 서식은 문자열로 감싸주어야 한다.

```vba
Public Function FN할인율(월불입액)

Select Case 월불입액

Case Is < 20
    FN할인율 = Format(0.02, "#%")
    
Case Is < 30
    FN할인율 = Format(0.03, "#%")
    
Case Is < 40
    FN할인율 = Format(0.04, "#%")
    
Case Is >= 40
    FN할인율 = Format(0.05, "#%")

End Select


End Function
```

## 1-9. 피벗테이블(외부데이터 활용)
- 구분기호를 설정하거나 머리글 표시등을 텍스트 마법사에서 잘 선택해야한다. 
- 또 가져올 열들을 잘 선택한다. 보통 외부데이터를 가져올때는 데이터 모델에 데이터를 추가해야 외부데이터로 원활하게 작업을 할 수 있다.
- 카테고리별로 대표값을 선택하여 값필드를 설정할 수 있다.
> 보험코드를 보고서 필터에 넣는 것을 놓쳤다. 보고서 필터라는 영역도 있음을 인지하고 있어야한다.

## 1-10. 자동필터 활용
- 자동필터는 그냥 필터를 의미하고 사용자 지정 자동필터를 이용하여 문제에서 주어진 조건을 표현하면 된다.
- 시작문자같은 조건은 텍스트 필터에서 사용하면 된다.

## 1-11. 데이터 유효성 검사 기능 활용 목록상자 만들기
- 목록상자를 만드기 위해선 유효성 검사의 제한 사항을 목록으로 두면 된다.
- 범위를 지정하거나 원본에 직접 입력하는 두가지의 방법이 있다.
- 유효성 검사에서 모두 지우기를 통해 이를 전부 지울 수 있다.

## 1-12. 차트만들기
- 꺾은 선형 중에 중간중간 표식이 있으면 이는 표식이 있는 꺾은 선형임을 의미한다.
- 특정 계열만 선택하여 차트를 바꿀 수 있다.
- 오른쪽에 표시된 축이 보조 축이면 이는 데이터 계열 서식에서 설정할 수 있다. 최소, 최대, 주 단위도 축서식에서 설정할 수 있다.
- 가로축교차값도 축 서식에서 지정할 수 있다.
- 주 눈금선을 삭제하려면 차트요소 추가해서 선택되어있는 것을 해제해주는 방식으로 지울 수 있다.
- 그림으로 채우기는 특정 그림으로 데이터를 표현할 수 있게 해준다.

## 1-13. 메크로 작업-데이터표
- 이차원 데이터 표여도 일반적인 데이터표와 같다. 계산식을 행과 열이 만나는 지점에 위치해야 블럭설정을 효율적으로 할 수 있다.
- 행방향 -> 행 입력셀, 열방향 -> 열 입력셀
- 도형에 글씨쓰고 엔터치지 말고 밖을 클릭해야한다.
- 결과가 나와있는 상태로 제출하면 된다.

## 1-14. 메크로 작업-조건부서식
- 문제에 나온대로 셀서식을 조정하면 된다. 
- 조건부 서식은 버튼을 누를때마다 서식이 생기므로 조건부 서식에서 서식을 하나만 남겨둬야한다.

## 1-15. 프로시저
- 콤보상자 같이 하나씩 넣어야 하는경우 rowsource가 아니라 additem을 사용한다.
- 개체 이름은 대소문자를 구분하지 않는다.
- 원본자료는 절대 삭제하면 안된다.
- 선택 f4로 속성을 알 수 있다.
- 라디오 버튼같은 옵션버튼은 if문으로 입력해주어야한다.
- list와 list인덱스의 인덱스는 0부터 시작한다.
- 스핀단추는 스핀단추의 변경된 값이 옆의 텍스트 상자로 들어가도록 코딩하면 된다.
- 시트가 활성화된다는 거는 창을 연다는 것으로 activate이다. 프로시저에서 date를 쓰면 오늘 날짜가 나오고 now를 사용하면 시간까지 나온다. 엑셀에서는 today이다.
- 저장만 누르면 수험번호로 저장이 된다.

```vba
Private Sub UserForm_Initialize()

cmb수강과목.AddItem "한글"
cmb수강과목.AddItem "영어"
cmb수강과목.AddItem "수학"

list담당자.RowSource = "K5:N11"

End Sub
```
```vba
Private Sub cmd등록_Click()

입력행 = Range("b4").CurrentRegion.Rows.Count + 4
참조행 = list담당자.ListIndex

Cells(입력행, 2) = Text학생이름
Cells(입력행, 4) = cmb수강과목
Cells(입력행, 3) = Text나이

If Ob남 = True Then
    Cells(입력행, 5) = "남"
Else
    Cells(입력행, 5) = "여"

End If

Cells(입력행, 6) = list담당자.List(참조행, 0)


End Sub
```
```vba
Private Sub Spin나이_Change()
Text나이 = Spin나이
End Sub
```

# 📌 2. 엑세스 출제유형분석1회
## 2-1. 데이터베이스 구축(필드속성설정)
- 모든 편집은 디자인보기에서 한다.
- not null 설정은 필드속성에서 필수를 예로 바꾸면 된다.
- 유효성 검사 규칙도 필드속성에서 논리식으로 설정한다.
- 입력마스크도 필드속성에서 설정하며 아래 표를 암기해야한다.
- 또 입력형식; 문자저장여부; 기본값;으로 설정한다.
- 문자저장여부는 0이나 안쓰거나고 0을 쓰면 -같은 문자도 같이 저장한다. 
- 데이터가 입력될 자리에 나오는 값은 기본값이다. 기본값을 지우면서 값을 입력하게 된다.
- mm월 dd일로 하면 mm월 dd일 형식이 된다. -> 두자리 m, 두자리 d
- 최소 범주로 활용해야한다.

| 분류       | 기호    | 필수 / 선택 | 허용되는 입력            | 의미              |
| -------- | ----- | ------- | ------------------ | --------------- |
| 숫자 전용    | **0** | 필수      | 숫자만 (0~9)          | 반드시 숫자 하나 입력    |
| 숫자 전용    | **9** | 선택      | 숫자 또는 공백           | 숫자 입력 가능, 없어도 됨 |
| 문자 전용    | **L** | 필수      | 영문자, 한글            | 반드시 문자 1개       |
| 문자 전용    | **?** | 선택      | 영문자, 한글            | 문자 입력 가능, 없어도 됨 |
| 문자+숫자    | **A** | 필수      | 영문, 한글, 숫자         | 반드시 1글자         |
| 문자+숫자    | **a** | 선택      | 영문, 한글, 숫자         | 선택 1글자          |
| 문자+숫자+공백 | **&** | 필수      | 모든 문자 + 공백         | 반드시 1글자         |
| 문자+숫자+공백 | **C** | 선택      | 모든 문자 + 공백         | 선택 1글자          |
| 대소문자 변환  | **>** | 제어      | 이후 입력을 **대문자**로 강제 |                 |
| 대소문자 변환  | **<** | 제어      | 이후 입력을 **소문자**로 강제 |                 |
| 선택 요소    | **#** | 선택      | 숫자, 공백, +, -       | 전화번호·부호용        |

## 2-2. 참조테이블 만들기
- 데이터베이스 도구-관계에서 지정할 수 있다.
- 관계를 끌어다가 표시하고 여러가지 설정을 따라 해주면 된다.

## 2-3. 외부데이터로 새로운 테이블 만들기
- 첫행이 필드의 이름이면 첫 행에 열 머리글이 있음을 클릭하면된다.

## 2-4. 폼 완성하기
- 바운드는 개체에서 f4 속성시트에서 컨트롤 원본에 데이터를 연결시키면 된다.
- 폼의 빈공간에서 속성으로 들어가면 폼 자체에 대한 속성이 열리게 된다.

> 컨트롤에 함수를 바운딩할때 =Sum([금액])처럼 =부터 입력해주어야한다.

## 2-5. 하위폼 만들기
- 상위폼에 빈공간에 하위 폼을 끌어두고 연결 필드를 설정하거나 하위폼 컨트롤을 선택하여 삽입할 수 있다.

> 끌어다 놓았을때 하위폼 속성의 기본 필드영역 이나 하위필드 영역에 연결할 필드를 입력해주면 된다.

## 2-6. 폼에 조건부 서식 적용
- 조건부 서식 입력 식이 sql의 where절에 들어가는 식과 비슷하다.
- 식에서 필드는 []로 감싸주어야한다는 것만 유의하면 된다.
- 식에서 숫자를 입력할땐 , 이런거 찍지말고 그냥 입력하자

> 모든 개체에 조건부서식을 적용하기 위해서는 모든 눈금자를 클릭하거나 ctrl 클릭으로 모든 개체를 선택하고 조건부 서식을 적용해주어야한다. 또한 '필드값이'는 스스로를 바꿀때, '식이'는 전체를 바꿀때 사용하는 옵션이다. 그리고 식 옆에 조건부 서식을 작성해주면 된다.

## 2-7. 보고서 만들기 (인쇄담당개체)
- 제목을 적을때는 텍스트 상자가 아니라 레이블을 사용한다.
- 보고서 텍스트 상자에도 데이터 원본을 바운드 할 수 있다.
- 엑세스에서 평균은 avg이다.

> 보고서 머리글은 아무것도 안해도 보고서 첫번째에 한번만 표시된다.

## 2-8. 이벤트 프로시저
- 개체를 선택하고 이벤트 작성 -> 작성기 선택을 통해 작성한다.
- 변화하는 함수는 따로 떨어뜨려서 결합해야한다. 
- me는 현재 개체를 의미하고 docmd는 다른 개체이다.
- 문자열은 ""로 묶어서 필터에 넣어주어야한다.
- 필터에 넘겨주는 식은 where 조건문이다.

| 데이터형   | 조건 종류 | 문법                                          | 의미                  |
| ------ | ----- | ------------------------------------------- | ------------------- |
| 문자열    | 완전일치  | `"필드명 = '" & 컨트롤 & "'"`                     | 문자열 값이 정확히 같을 때     |
| 숫자     | 완전일치  | `"필드명 = " & 컨트롤`                            | 숫자 값이 같을 때          |
| Yes/No | 논리값   | `"필드명 = " & 컨트롤`                            | True / False 비교     |
| 날짜     | 날짜형   | `"필드명 = #" & 컨트롤 & "#"`                     | 날짜 비교 (Access 전용 #) |
| 문자열    | 부분일치  | `"필드명 LIKE '*" & 컨트롤 & "*'"`                | 포함 검색               |
| 문자열    | 시작일치  | `"필드명 LIKE '" & 컨트롤 & "*'"`                 | 앞이 같은 값             |
| 문자열    | 끝일치   | `"필드명 LIKE '*" & 컨트롤 & "'"`                 | 뒤가 같은 값             |
| 숫자     | 이상    | `"필드명 >= " & 컨트롤`                           | 크거나 같음              |
| 숫자     | 이하    | `"필드명 <= " & 컨트롤`                           | 작거나 같음              |
| 날짜     | 기간    | `"필드명 BETWEEN #" & A & "# AND #" & B & "#"` | 날짜 범위               |

| 속성          | 타입      | 역할        | 설명                     |
| ----------- | ------- | --------- | ---------------------- |
| Me.Filter   | String  | 필터 공식 저장소 | 필터 조건 문장을 **문자열로 보관**  |
| Me.FilterOn | Boolean | 필터 스위치    | Filter를 **켜거나 끄는 스위치** |

- 위의 원리 때문에 me.filteron = true로 넣으면 필터가 켜지는 것이다.
- 매크로를 사용할때는 applyfilter를 사용한다.
- 여기서 where 조건문은 부서코드 = 경로 (경로는 !으로 구분) 형식으로 적어주면 된다.

> Private Sub cmd조회_Click()
Me.Filter = "부서코드 = '" & txt조회 & "'"
Me.FilterOn = True
End Sub

## 2-9. 쿼리디자인
- 쿼리디자인 탭에서 아래 도구들이 표현된 대로 설명에 따라 문제를 그냥 풀면 된다.

## 2-10. 크로스탭 쿼리
- 쿼리 마법사에 보면 크로스탭 쿼리 마법사가 나와있다.
- 여러 테이블을 엮어야할때는 쿼리디자인으로 할 줄 알아야한다. 빈공간에 쿼리 종류를 변경할 수 있다. 
- 이때 행 머리글, 열머리글 같은 것들은 다 지정할 수 있게 나와있다.

## 2-11. 불일치 검색 쿼리
- 이또한 쿼리의 한 종류이다.
- 이는 내부적으로 isnull과 outer join을 자동으로 적용해주는 것이다.

## 2-12. 복잡한 쿼리
- 필드: 란이 select라고 생각하면 편하다.
- iif는 iif(조건,참,거짓)이다. -> Immediate IF.
- 쿼리디자인-요약을 누르면 요약행 즉 groupby행이 만들어 진다.

## 2-13. 폼에서 버튼 프로시저 구현
- 이벤트 프로시저는 코드 작성기이다.
- 아래처럼 보고서를 여는 명령을 작성하면되는데 문제에 설명되어있는 인수까지만 입력하면 된다.
- 만약 메크로에서 명령은 openreport이다.
- 보통 acViewPreview 이거밖에 없다.

```vba
DoCmd.OpenReport "부서별평가현황", acViewPreview
```

| 구분     | 메서드                | 기본 구조                                     | 의미              |
| ------ | ------------------ | ----------------------------------------- | --------------- |
| 폼 열기   | `DoCmd.OpenForm`   | `DoCmd.OpenForm "폼이름", 보기방식, 필터이름, 조건`    | 폼을 조건을 걸어서 연다   |
| 보고서 열기 | `DoCmd.OpenReport` | `DoCmd.OpenReport "보고서명", 보기방식, 필터이름, 조건` | 보고서를 조건을 걸어서 연다 |
