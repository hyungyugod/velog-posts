
# 📌 1. 가우스 변환과 LU분해 정리

---

## 1-1. 기본행연산과 가우스 행렬

- **핵심 아이디어**  
  여러 번의 기본행연산을 따로따로 쓰지 않고, **한 행렬로 묶어서 표현할 수 있다**.  
  이렇게 묶은 행렬을 **가우스 행렬(Gaussian Matrix)**이라고 부른다.

- **구성 요소**  
  - e_k: 이번에 조작할 **열을 고르는 단위 벡터**  
  - t_k: k번째 행 **아래쪽 행들에 적용할 소거 비율**을 모아둔 벡터  

---

### 구체적 예시

행렬:

$$
A=
\begin{bmatrix}
2 & 1 & 1\\\\
4 & -6 & 0\\\\
-2 & 7 & 2
\end{bmatrix}
$$

**1단계. 피벗 선택**  
첫 번째 피벗은 a_{11}=2.  
아래쪽 항목 a_{21}=4, a_{31}=-2를 0으로 만들어야 한다.

**2단계. 소거 비율 계산**

$$
m_{21}=\frac{a_{21}}{a_{11}}=\frac{4}{2}=2, \quad
m_{31}=\frac{a_{31}}{a_{11}}=\frac{-2}{2}=-1
$$

즉,  
- $$R_2 \leftarrow R_2 - 2R_1$$  
- $$R_3 \leftarrow R_3 - (-1)R_1 = R_3+R_1$$

**3단계. 벡터 $$e_1, t_1$$**

$$
e_1=\begin{bmatrix}1\\\\0\\\\0\end{bmatrix}, \quad
t_1=\begin{bmatrix}0\\\\2\\\\-1\end{bmatrix}
$$

**4단계. 가우스 행렬 만들기**

$$
M_1=I - t_1 e_1^{\mathsf T}
=
\begin{bmatrix}
1&0&0\\\\
-2&1&0\\\\
1&0&1
\end{bmatrix}
$$

**5단계. 적용**

$$
M_1A=
\begin{bmatrix}
2&1&1\\\\
0&-8&-2\\\\
0&8&3
\end{bmatrix}
$$

→ 첫 번째 열 아래가 한 번에 0으로 됨.

---

### 일반 공식 요약

피벗: 
$$a_{kk}$$  
소거 비율: 
$$m_{ik}=\dfrac{a_{ik}}{a_{kk}} \quad (i>k)$$  
벡터:  

$$
e_k=\text{표준단위벡터},\quad
t_k=\begin{bmatrix}0&\cdots&0&m_{k+1,k}&\cdots&m_{nk}\end{bmatrix}^{\mathsf T}
$$

가우스 행렬:  

$$
M_k=I - t_k e_k^{\mathsf T}
$$

실제 적용: $$M_kA$$는 한 열의 소거 연산을 한 번에 실행한다.

---

## 1-2. LU 분해와 연립방정식 풀이

연립방정식
$$Ax=b$$
를 풀 때,  
가우스 소거법으로 
$$A=LU$$ 
(하삼각행렬 
$$L$$
, 상삼각행렬 
$$U$$
)로 분해하면 편하다.

---

### (1) 앞으로 풀기 (Forward Solving)

$$Ly=b$$
를 푼다.  
$$L$$
은 하삼각행렬 → **위에서부터 순서대로** 
$$y_1, y_2, \dots$$
를 구한다.

$$
y_i = \frac{1}{l_{ii}}\Big(b_i - \sum_{j=1}^{i-1} l_{ij}y_j\Big),\quad i=1,2,\dots,n
$$

즉, **윗줄부터 차례대로** 해를 찾는 과정.

---

### (2) 거꾸로 풀기 (Backward Solving)

이제 
$$Ux=y$$
를 푼다.  
$$U$$
는 상삼각행렬 → **아래에서부터 거꾸로** 
$$x_n, x_{n-1}, \dots$$
를 구한다.

$$
x_i = \frac{1}{u_{ii}}\Big(y_i - \sum_{j=i+1}^n u_{ij}x_j\Big),\quad i=n,n-1,\dots,1
$$

즉, **아랫줄부터 역순으로** 해를 찾는 과정.

---

## 1-3. 최종 정리

- 기본행연산은 여러 번 해도 하나의 행렬로 누적 가능.  
- e_k: 조작할 열, t_k: 아래 행들의 소거 비율 → 가우스 행렬은 한 열에 대한 연산을 한 번에 모은 것.  
- LU 분해로 연립방정식 풀 때는:
  1. 앞으로 풀기: Ly=b (윗줄부터 해 구하기)  
  2. 거꾸로 풀기: Ux=y (아랫줄부터 해 구하기)  
- 또한 중요한 것은 이 가우스 행렬을 한 열단위로 하여서 M2M1A = U 형태로 만들고 A = (M2M1)-1 U 형태를 풀어내는 식으로 방정식을 풀어나가야한다는 것이다. 
- 아래서도 언급하겠지만 한열단위로 하지 않으면 계산이 복잡해지고 원래 취지에서 벗어난다.

# 📌 2. 하부삼각 단위행렬의 역과 주의사항

---

## 2-1. 하삼각 단위행렬의 구조

- **정의**  
  \(n \times n\) 하삼각 단위행렬은 대각 원소가 모두 1이고,  
  대각선 아래쪽에만 값이 있는 행렬이다.

예시 (3×3):

$$
L =
\begin{bmatrix}
1 & 0 & 0 \\
\ell_{21} & 1 & 0 \\
\ell_{31} & \ell_{32} & 1
\end{bmatrix}
$$

---

## 2-2. 역행렬의 일반 공식

- **형태**  
  역행렬도 역시 하삼각 단위행렬이다. (대각선은 1 유지)

- **구하는 방법**  
  \(LX=I\)를 forward substitution으로 푼다.

즉, 순서대로 식을 풀면:

1. 첫 번째 행:
   $$
   x_{11}=1
   $$

2. 두 번째 행:
   $$
   \ell_{21}x_{11}+x_{22}=0 \;\;\Rightarrow\;\; x_{22}=1,\; x_{21}=-\ell_{21}
   $$

3. 세 번째 행:
   $$
   \ell_{31}x_{11} + \ell_{32}x_{21} + x_{33}=0
   $$
   계산을 순서대로 풀면, \(\ell_{31}, \ell_{32}\)에 따라  
   역행렬의 아래쪽 항들이 누적해서 결정된다.

---

## 2-3. 3×3 일반 공식

정리하면:

$$
L^{-1} =
\begin{bmatrix}
1 & 0 & 0 \\
-\ell_{21} & 1 & 0 \\
-\ell_{31}+\ell_{32}\ell_{21} & -\ell_{32} & 1
\end{bmatrix}
$$

즉,
- 단순히 부호만 바뀌는 게 아니라, **아래쪽으로 내려갈수록 위의 값들이 누적**된다.

---

## 2-4. 원래 한 방식이 안된 이유

- **잘못된 가정**  
  네가 계산에서 쓴 방법은
  $$
  (E_3E_2E_1)^{-1} = E_1^{-1}E_2^{-1}E_3^{-1}
  $$
  이 규칙을 그대로 썼어.  
  그런데 여기서 **큰 차이**는:
  - \(E_1, E_2, E_3\)는 각각은 “한 번의 기본행연산”에 해당하는 기본행렬이 맞음.
  - 하지만 \(E_3E_2E_1\)은 **이미 여러 연산을 합쳐놓은 행렬**이라서 더 이상 “기본행렬 하나”가 아님.

- **결과**  
  따라서 \(E_3E_2E_1\) 전체를 단일 기본행렬로 보고 "기본행렬의 역 구하는 공식"을 적용하면 안 됨.  
  대신:
  1. 전체 곱 \(P=E_3E_2E_1\)를 먼저 계산 →  
  2. 그다음 일반 공식(하삼각 단위행렬의 역)이나 substitution으로 \(P^{-1}\)을 구해야 한다.

---

## 2-5. 최종 정리

- **공식**  
  하삼각 단위행렬의 역도 하삼각 단위행렬이고, 대각선 아래 항들은  
  원래 계수들의 **부호 반전 + 누적 조합**으로 결정된다.

- **주의**  
  여러 기본행렬을 곱한 \(E_3E_2E_1\)은 더 이상 “기본행렬”이 아니다.  
  따라서 기본행렬 역행렬 규칙을 직접 적용하면 틀린다.  
  반드시 전체 곱을 만든 뒤, 일반 역행렬 구하기 절차를 적용해야 한다.
  
  다만 한 열에 변화가 집중되었을 경우 Mk−1​=I+tk​ekT에 의해 기본행렬의 역행렬처럼 구할 수 있으므로 M1, M2 등의 가우스 행렬도 계산이 편리하다. 다만 한 열의 변화만 있어야 단순히 부호만 바꾸면서 역행렬을 구할 수 있다.
  ​
