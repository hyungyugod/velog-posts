# ğŸ“Œ 1. ì‹¤ê¸° 3íšŒ ê¸°ì¶œ
## 1-1. 1ìœ í˜•
- df = df.dropna()ëŠ” ê²°ì¸¡ì¹˜ê°€ í•˜ë‚˜ë¼ë„ ìˆëŠ” í–‰ì„ ì „ë¶€ ì œê±°í•œë‹¤.
```py
df = df.dropna()
df70 = df.iloc[:int(len(df)*0.7), :]
print(df70['f1'].quantile(.25)) # 57.0
```
- ë§Œì•½ í–‰ì— ìˆëŠ” ì¡°ê±´ì„ ì—´ë¡œ ì˜®ê¸°ëŠ”ê²Œ í¸í•œ ìƒí™©ì´ë©´ ì „ì¹˜ë¥¼ í•œë‹¤. ì´ë•Œ dft.columsë¡œ í™•ì¸í•´ë³´ë©´ ë°ì´í„°íƒ€ì…ì´ intì¼ ìˆ˜ ìˆì–´ ì¹¼ëŸ¼ì„ ì„ íƒí• ë•Œ ì£¼ì˜í•´ì•¼í•œë‹¤.
- df[ìˆ«ì]ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì¹¼ëŸ¼ì´ë¦„ìœ¼ë¡œ í˜¸ì¶œí•œë‹¤.
- df = df.T ì´ëŸ¬ë©´ ì‹¤í–‰í• ë•Œë§ˆë‹¤ ì „ì¹˜ë˜ì–´ì„œ ê²°ê³¼ì— ì˜¤ë¥˜ê°€ ìƒê¸¸ ìˆ˜ ìˆë‹¤.
- ì „ì¹˜ë¥¼ í•˜ì§€ ì•Šê³  m = df.loc[2000].mean() ì´ë ‡ê²Œ í•˜ë©´ ë°”ë¡œ í–‰ì´ë¦„ì´ 2000ì¸ í–‰ì„ ì„ íƒí•  ìˆ˜ ìˆì–´ ì´ë ‡ê²Œ í’€ì–´ë‚˜ê°€ë„ ì¢‹ë‹¤.
```py
dft = df.T
print(sum(dft[2000] > dft[2000].mean())) # 100

m = df.loc[2000].mean()
```
- ê²°ì¸¡ì¹˜ê°€ ê°€ì¥ ë§ì€ í–‰ì€ ê·¸ëƒ¥ isna().sum()ì„ ì´ìš©í•œë‹¤.
```py
df.isna().sum() # f1
```

## 1-2. 2ìœ í˜•
- trainê³¼ testì— ë¬¸ìì—´ ê°’ë“¤ ì¤‘ ë‹¤ë¥¸ í’ˆëª©ì´ ì—†ëŠ”ì§€ëŠ” ì•„ë˜ì½”ë“œë¡œ í™œìš©í•œë‹¤.
- í™œìš© í›„ labelencodingì—ì„œ forë¬¸ì€ ì¬í™œìš©í•œë‹¤.
```py
# trainê³¼ test ë°ì´í„°ì˜ í’ˆëª©ì— ì°¨ì´ê°€ ìˆëŠ”ì§€ ê²€ì‚¬
for col in obj_columns:
  if(set(train[col]) != set(test[col])):
    print(col,"x")
```
- ì „ì²´ ì½”ë“œëŠ” ì¼ë°˜ì ì¸ í’€ì´ì™€ ê°™ë‹¤.
- test[col] = le.transform(test[col]) ì´ê³  ë³µë¶™í•´ì„œ fit_transformìœ¼ë¡œ ì ëŠ” ì‹¤ìˆ˜ë¥¼ í•´ë²„ë ¸ë‹¤ ì ˆëŒ€ ì´ë ‡ê²Œ í•˜ë©´ ì•ˆëœë‹¤.
```py
# ê²°ì¸¡ì¹˜ ì—†ìŒ, ì¸ì½”ë”©
# train.describe(include='O')
obj_columns = train.select_dtypes('object').columns

# trainê³¼ test ë°ì´í„°ì˜ í’ˆëª©ì— ì°¨ì´ê°€ ìˆëŠ”ì§€ ê²€ì‚¬
for col in obj_columns:
  if(set(train[col]) != set(test[col])):
    print(col,"x")

# one-hot
train = pd.get_dummies(columns=obj_columns, data=train)
test = pd.get_dummies(columns=obj_columns, data=test)

# label
# from sklearn.preprocessing import LabelEncoder

# for col in obj_columns:
#   le = LabelEncoder()
#   train[col] = le.fit_transform(train[col])
#   test[col] = le.transform(test[col])

# ê²€ì • ë°ì´í„° ë¶„ë¦¬
from sklearn.model_selection import train_test_split
x_tr, x_val, y_tr, y_val = train_test_split(train.drop('TravelInsurance', axis=1), train['TravelInsurance'], train_size=0.8, random_state=42)
# print(x_tr.shape, x_val.shape, y_tr.shape, y_val.shape)

# ëª¨ë¸ ì í•© ë° í‰ê°€
# lgbm
# from lightgbm import LGBMClassifier
# model = LGBMClassifier(verbose=-1, random_state=42, max_depth=3, n_estimators=100, learning_rate=0.1)

#rf
from sklearn.ensemble import RandomForestClassifier
model = RandomForestClassifier(random_state=42, max_depth=8, n_estimators=200)

# ì í•© ë° í‰ê°€
model.fit(x_tr, y_tr)
pred1 = model.predict_proba(x_val)

from sklearn.metrics import roc_auc_score
print(roc_auc_score(y_val, pred1[:,1]))

# rf max_depth=8, n_estimators=200 0.824644777265745


# ì˜ˆì¸¡ ë° ì œì¶œ
pred = model.predict_proba(test)
submit = pd.DataFrame({
    'index':test.index,
    'y_pred':pred[:,1]
})

submit.to_csv('submit.csv', index=False)
```